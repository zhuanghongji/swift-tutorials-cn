# AVPlayer

<ToBePolishedAfterTranslation />

<OriginalSource
  title="AVPlayer"
  url="https://developer.apple.com/documentation/avfoundation/avplayer"
  summary="提供控制玩家传输行为的接口的对象"
/>

## 概述

播放器是管理媒体资产的播放和计时的控制器对象。使用 AVPlayer 实例播放本地和远程基于文件的媒体，例如 QuickTime 电影和 MP3 音频文件，以及使用 HTTP Live Streaming 提供的视听媒体。

使用播放器一次播放一个媒体资产。你可以使用其 replaceCurrentItem(with:) 方法重用播放器实例来播放其他媒体资产，但它一次仅管理单个媒体资产的播放。该框架还提供了一个名为 AVQueuePlayer 的类的子类，你可以使用它来创建和管理按顺序播放的媒体资源的队列。

你使用 AVPlayer 来播放媒体资源，AVFoundation 使用 AVAsset 类对其进行建模。 AVAsset 仅对媒体的静态方面进行建模，例如其持续时间或创建日期，并且其本身不适合使用 AVPlayer 进行播放。要播放资产，你需要创建在 AVPlayerItem 中找到的动态对应项的实例。该对象对 AVPlayer 实例播放的资产的时序和呈现状态进行建模。有关更多详细信息，请参阅 AVPlayerItem 参考。

AVPlayer 是一个状态不断变化的动态对象。你可以使用两种方法来观察玩家的状态：

- 常规状态观察：你可以使用键值观察 (KVO) 来观察播放器的许多动态属性的状态更改，例如其 currentItem 或其播放 rate 。
- 定时状态观察：KVO 对于一般状态观察效果很好，但不适用于观察像玩家时间这样不断变化的状态。 AVPlayer 提供了两种观察时间变化的方法：
  - addPeriodicTimeObserver(forInterval:queue:using:)
  - addBoundaryTimeObserver(forTimes:queue:using:)

这些方法可让你分别定期或按边界观察时间变化。当发生变化时，调用你提供给这些方法的回调块或闭包，以便你有机会采取一些操作，例如更新玩家用户界面的状态。

AVPlayer 和 AVPlayerItem 是非视觉对象，这意味着它们本身无法在屏幕上呈现资产的视频。你可以使用两种主要方法在屏幕上呈现视频内容：

- AVKit：呈现视频内容的最佳方式是在 iOS 和 tvOS 中使用 AVKit 框架的 AVPlayerViewController 类，或在 macOS 中使用 AVPlayerView 类。这些类展示视频内容以及播放控件和其他媒体功能，为你提供全功能的播放体验。
- AVPlayerLayer：为播放器构建自定义界面时，请使用 AVPlayerLayer 。你可以将此层设置为视图的支持层或将其直接添加到层层次结构中。与 AVPlayerView 和 AVPlayerViewController 不同，播放器层不提供任何播放控件 - 它仅在屏幕上显示视觉内容。你可以构建播放传输控件来播放、暂停和搜索媒体。

除了使用 AVKit 或 AVPlayerLayer 呈现的视觉内容之外，你还可以使用 AVSynchronizedLayer 呈现与玩家计时同步的动画内容。使用同步层将玩家计时传递到其层子树。你可以使用 AVSynchronizedLayer 在 Core Animation 中构建自定义效果，例如动画下三分之一或视频过渡，并让它们与播放器当前 AVPlayerItem 的时间同步播放。
