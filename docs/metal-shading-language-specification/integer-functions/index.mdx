# 整数函数

<OrigninalPDF title="6.3 Integer Functions" />

表 6. 2 中的整数函数在头文件 中定义。T 是标量或向量整数类型之一。Tu 是相应的无符号标量或向量整数类型。T32 是标量或向量 32 位 int 或 uint 类型之一。

## 表 6.2。Metal 标准库中的整数函数

`内置整数函数说明`

``` T abs(T x) 返回 |x|。````

``` Tu absdiff(T x, T y) 返回 |x-y|无模溢出。````

``` T addsat(T x, T y) 返回 x + y 并使结果饱和。````

`T 钳位(T x, T minval, T maxval)`

``` 返回 min(max(x, minval), maxval)。````

``` 如果 minval > maxval，结果未定义。````

**内置整数函数说明**

T clz(T x) 返回 x 中前导 0 位的数量，从最高有效位位置开始。如果 x 为 0，则返回 x 类型或 x 组件类型的位大小（如果 x 是向量）

T ctz(T x) 返回 x 中尾随 0 位的计数。如果 x 为 0，则返回 x 类型的大小（以位为单位），或者如果 x 是向量，则返回 x 的分量类型。

T extract_bits(T x, uint offset, uint bits) 所有操作系统：自 Metal 1 .2 起。

``` 从 x 中提取位 [offset, offset+bits- 1]，并以结果的最低有效位返回它们。````

`对于无符号数据类型，结果的最高有效位设置为零。对于有符号数据类型，最高有效位设置为位偏移+位- 1 的值。`

`` 如果位为零，则结果为零。如果偏移量和位数之和大于用于存储操作数的位数，则结果未定义。````

T hadd(T x, T y) 返回 (x + y) >> 1。中间和不会模溢出。

T insert_bits(T base, T insert, uint offset, uint bits) 所有操作系统：自 Metal 1 .2 起。

``` 返回插入到基数中的最低有效位的插入。````

``` 结果的位 [offset, offset+bits- 1 ] 取自 insert 的位 [ 0 , bits- 1 ]，所有其它位直接取自 base 的相应位。如果位为零，则结果为基数。如果偏移量和位数之和大于用于存储操作数的位数，则结果未定义。````

T32 mad24(T32 x、T32 y、T32 z) 所有操作系统：自 Metal 2 .1 起。

``` 使用 mul24 将两个 24 位整数值 x 和 y 相乘，将 32 位整数结果与 32 位整数 z 相加，然后返回该和。````

T madhi(T a, T b, T c) 返回 mulhi(a, b) + c。

T madsat(T a, T b, T c) 返回 a \* b + c 并使结果饱和。

T max(T x, T y) 如果 x < y，则返回 y，否则返回 x。

T max3(T x, T y, T z) 所有操作系统：自 Metal 2.1 起。

``` 返回 max(x, max(y, z))。````

`内置整数函数说明`

``` T Median3(T x, T y, T z) 所有操作系统：自 Metal 2.1 起。````

``` 返回 x、y 和 z 的中间值。````

``` T min(T x, T y) 如果 y < x，则返回 y，否则返回 x。````

``` T min3(T x, T y, T z) 所有操作系统：自 Metal 2.1 起。````

``` 返回 min(x, min(y, z))。````

``` T32 mul24(T32 x, T32 y) 所有操作系统：自 Metal 2.1 起。````

``` 将两个 24 位整数值 x 和 y 相乘并返回 32 位整数结果。x 和 y 是 32 位整数，但只有低 24 位执行乘法。（请参阅此表后面的详细信息。）````

``` T mulhi(T x, T y) 计算 x \* y 并返回 x 和 y 乘积的高半部分。````

``` T popcount(T x) 返回 x 中非零位数。````

``` Tverse_bits(T x) 所有操作系统：自 Metal 2.1 起。````

`返回 x 的位的反转。结果中编号为 n 的位取自 bit (bits`

- 1. - x 的 n，其中位数是用于表示 x 的位数。

``` T rhadd(T x, T y) 返回 (x + y + 1) >> 1。中间和不会模溢出。````

``` Trotate(T v, T i) 对于 v 中的每个元素，这些位将左移 i 中相应元素给出的位数。从元素左侧移出的位将从右侧移回。````

``` T subsat(T x, T y) 返回 x - y 并使结果饱和。````

仅当 x 和 y 是有符号整数并且 x 和 y 在 [-2^23, 2^23 - 1] 范围内，或者如果 x 和 y 是无符号整数并且 x 和 y 在范围 [0, 2^24 - 1]。如果 x 和 y 不在该范围内，则乘法结果由实现定义。
