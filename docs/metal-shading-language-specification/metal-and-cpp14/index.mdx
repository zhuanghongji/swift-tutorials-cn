# Metal 和 C++14

<ToBePolishedAfterTranslation />

<OriginalPDF title="1.4 Metal and C++14" />

Metal 编程语言是基于 C++14 的规范，具有扩展和限制。有关语言语法的详细说明，请参阅 C++14 规范（也称为 ISO/IEC JTC1/SC22/WG N4431 语言规范）。

本节及其小节描述了 Metal 支持的 C++ 语言的修改和限制。

有关 Metal 预处理指令和编译器选项的更多信息，请参阅本文档的第 1.5 节。

## 重载

Metal 支持重载，如 C++14 规范第 13 节所定义。Metal 扩展了函数重载规则以包含参数的地址空间属性。你不能重载 Metal 图形和内核函数。（有关图形和内核函数的定义，请参阅本文档的第 5.1 节。）

## 模板

Metal 支持模板，如 C++14 规范第 14 节所定义。

## 预处理指令

Metal 支持预处理指令，如 C++ 规范第 16 节所定义。

## 限制

以下 C++14 功能在 Metal 中不可用（此列表中的部分编号指的是 C++14 规范）：

- lambda 表达式
- dynamic_cast 运算符
- 类型标识
- new 和 delete 运算符
- noexcept 运算符
- goto 语句
- register,、thread_local 存储属性
- 虚函数属性
- 派生类（derived classes ）
- 异常处理

不要在 Metal 代码中使用 C++ 标准库。相反，Metal 有自己的标准库。

Metal 限制了指针的使用：

- 你必须声明 Metal 图形和内核函数的参数，这些参数是具有 Metal `device`、`constant`、`threadgroup` 或 `threadgroup_imageblock` 地址空间属性的指针。
- Metal 2.3 支持函数指针。Metal 2.3 之前，不支持函数指针。

从 Metal 2.4 开始，Metal 支持计算（内核）上下文中的递归函数调用（C++ 第 5.2.2 节，第 9 项）。

Metal 函数不能被称为 `main`。
