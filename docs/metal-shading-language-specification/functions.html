<!doctype html>
<html lang="zh-hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-metal-shading-language-specification/functions/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">函数 | Swift 悍刀行</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zhuanghongji.github.io/swift-tutorials-cn/docs/metal-shading-language-specification/functions"><meta data-rh="true" name="docusaurus_locale" content="zh-hans"><meta data-rh="true" name="docsearch:language" content="zh-hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="函数 | Swift 悍刀行"><meta data-rh="true" name="description" content="Metal 1 或更高版本支持每个操作系统的内核、顶点和片段属性。Metal 2.3 或更高版本支持 C++ 属性："><meta data-rh="true" property="og:description" content="Metal 1 或更高版本支持每个操作系统的内核、顶点和片段属性。Metal 2.3 或更高版本支持 C++ 属性："><link data-rh="true" rel="icon" href="/swift-tutorials-cn/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://zhuanghongji.github.io/swift-tutorials-cn/docs/metal-shading-language-specification/functions"><link data-rh="true" rel="alternate" href="https://zhuanghongji.github.io/swift-tutorials-cn/docs/metal-shading-language-specification/functions" hreflang="zh-hans"><link data-rh="true" rel="alternate" href="https://zhuanghongji.github.io/swift-tutorials-cn/docs/metal-shading-language-specification/functions" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/swift-tutorials-cn/blog/rss.xml" title="Swift 悍刀行 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/swift-tutorials-cn/blog/atom.xml" title="Swift 悍刀行 Atom Feed"><link rel="stylesheet" href="/swift-tutorials-cn/assets/css/styles.a7cf13f8.css">
<link rel="preload" href="/swift-tutorials-cn/assets/js/runtime~main.b4417766.js" as="script">
<link rel="preload" href="/swift-tutorials-cn/assets/js/main.0cbf57d5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/swift-tutorials-cn/"><div class="navbar__logo"><img src="/swift-tutorials-cn/img/logo.svg" alt="Swift 悍刀行" class="themedImage_ToTc themedImage--light_HNdA"><img src="/swift-tutorials-cn/img/logo.svg" alt="Swift 悍刀行" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Swift 悍刀行</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/swift-tutorials-cn/docs/swift/welcome/about">Swift</a><a class="navbar__item navbar__link" href="/swift-tutorials-cn/docs/swiftui/essentials/about">SwiftUI</a><a class="navbar__item navbar__link" href="/swift-tutorials-cn/docs/swiftcharts/essentials/about">SwiftCharts</a><a class="navbar__item navbar__link" href="/swift-tutorials-cn/docs/swiftdata/essentials/about">SwiftData</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Frameworks</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/core-graphics/overview">Core Graphics</a></li><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/metal/overview">Metal</a></li><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/metalkit/overview">MetalKit</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Books</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/metal-programming-guide/introdution">Metal Programming Guide</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/swift-tutorials-cn/docs/metal-shading-language-specification/preface">Metal Shading Language Specification 3.1</a></li></ul></div><a href="https://github.com/zhuanghongji/swift-tutorials-cn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-github-link" aria-label="GitHub repository"></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Metal Shading Language 规范</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/preface">前言</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/preface">前言</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/purpose-of-this-document">介绍</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/purpose-of-this-document">本文档的目的</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/organization-of-this-specification">本规范的组织</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/references">参考文献</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/metal-and-cpp14">Metal 和 C++14</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/compiler-and-preprocessor">编译器和预处理器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/metal-coordinate-systems">Metal 坐标系</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/scalar-data-types">数据类型</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/scalar-data-types">标量数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/vector-data-types">向量数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/matrix-data-types">矩阵数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/simd-group-matrix-data-types">SIMD 组矩阵数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/alignment-of-data-types">数据类型的对齐</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/atomic-data-types">原子数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/pixel-data-types">像素数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/buffers">缓冲区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/textures">纹理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/samplers">采样器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/imageblocks">图像块</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/aggregate-types">聚合类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/argument-buffers">参数缓冲区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/uniform-type">统一类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/visible-function-table">可见函数表</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/function-group-attribute">功能组属性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/ray-tracing-types">光线追踪类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/interpolant-type">插值类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/mesh-shader-types">网格着色器类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/type-conversions-and-re-interpreting-data">类型转换和重新解释数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/implicit-type-conversions">隐式类型转换</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/scalar-and-vector-operators">运算符</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/scalar-and-vector-operators">标量和向量运算符</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/matrix-operators">矩阵运算符</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/device-address-space">地址空间</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/device-address-space">设备地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/constant-address-space">常量地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/thread-address-space">线程地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/threadgroup-address-space">线程组地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/threadgroup-imageblock-address-space">threadgroup_imageblock 地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/ray-data-address-space">ray_data 地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/object-data-address-space">object_data 地址空间</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/functions">函数与变量声明</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/functions">函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/function-arguments-and-variables">函数参数和变量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/storage-class-specifiers">存储类说明符</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/sampling-and-interpolation-attributes">采样和插值属性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/per-fragment-function-versus-per-sample-function">每片段函数与每样本函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/imageblock-attributes">图像块属性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/graphics-function-signature-matching">图形功能 - 签名匹配</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/program-scope-function-constants">程序作用域函数常量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/program-scope-global-built-ins">程序范围全局内置函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/per-primitive-viewport-and-scissor-rectangle-index-selection">每个图元视口和剪刀矩形索引选择</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/additional-restrictions">附加限制</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/namespace-and-header-files">Metal 标准库</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/namespace-and-header-files">命名空间和头文件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/common-functions">常用函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/integer-functions">整数函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/relational-functions">关系函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/math-functions">数学函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/matrix-functions">矩阵函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/simd-group-matrix-functions">SIMD 组矩阵函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/geometric-functions">几何函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/synchronization-and-simd-group-functions">同步和 SIMD 组功能</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/graphics-functions">图形函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/pull-model-interpolation">拉模型插值</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/texture-functions">纹理函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/imageblock-functions">图像块函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/pack-and-unpack-functions">打包和解包函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/atomic-functions">原子函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/encoding-commands-for-indirect-command-buffers">间接命令缓冲区的编码命令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/variable-rasterization-rate">可变光栅化率</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/ray-tracing-functions">光线追踪函数</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/inf-nan-and-denormalized-numbers">数值符合性</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/inf-nan-and-denormalized-numbers">INF、NaN 和非规范化数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/rounding-mode">舍入模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/floating-point-exceptions">浮点异常</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/relative-error-as-ulps">作为 ULP 的相对误差</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/edge-case-behavior-in-flush-to-zero-mode">清零模式下的边缘情况行为</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/conversion-rules-for-floating-point-and-integer-types">浮点型和整数型的转换规则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/texture-addressing-and-conversion-rules">纹理寻址和转换规则</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/swift-tutorials-cn/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Metal Shading Language 规范</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">函数与变量声明</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">函数</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>函数</h1><div style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;border-radius:0.5rem;background-color:#333333">原文：5.1 Functions</div><br><p>Metal 1 或更高版本支持每个操作系统的内核、顶点和片段属性。Metal 2.3 或更高版本支持 C++ 属性：</p><ul><li>[<!-- -->[vertex]<!-- -->] 或顶点（参见第 5.1.1 节） - [<!-- -->[fragment]<!-- -->] 或片段（参见第 5.1.2 节） - [<!-- -->[kernel]<!-- -->] 或内核（参见第 5.1.3 节） - [<!-- -->[visible]<!-- --> ] （参见第 5.1.4 节） - [<!-- -->[可缝合]<!-- -->] （参见第 5.1.5 节） - [<!-- -->[交集（...）]<!-- -->] （参见第 5.1.6 节） - [<!-- -->[对象]<!-- -->] （参见第 5.1 节。7) - [<!-- -->[网格]<!-- -->]（参见第 5.1.8 节）</li></ul><p>通过在函数的开头添加这些函数属性之一，使函数可以被 Metal API 访问，这使其成为<em>限定</em>函数。内核函数、顶点函数和片段函数不能在不触发编译错误的情况下相互调用，但它们可以调用其他使用 [<!-- -->[visible]<!-- -->] 属性的函数。他们还可以通过调用 intersect() 来调用具有 [<!-- -->[intersection(...)]<!-- -->] 属性的函数（请参阅第 6.18.2 节）。</p><p>在 Metal 2.2 之前，Metal 编译器忽略内核、顶点和片段函数的命名空间标识符。在 Metal 2.2 及更高版本中，如果你在命名空间中声明限定函数，则每次将其引用到 Metal Framework API 时，都必须包含命名空间标识符和函数名称。此示例在不同的命名空间中声明两个内核函数。</p><p>命名空间外部{</p><p>[<!-- -->[内核]<!-- -->] void functionA() {...}</p><p>命名空间内部{</p><p>[<!-- -->[内核]<!-- -->] void functionB() {...}</p><p>}</p><p>}</p><p>通过在函数名称前面加上命名空间的标识符，后跟两个冒号来引用命名空间中的函数。</p><p>外部::函数 A</p><p>类似地，通过按顺序在函数名称前加上所有命名空间并用两个冒号分隔每个命名空间来引用嵌套命名空间中的函数。</p><p>外部::内部::functionB</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="511-顶点函数">5.1.1 顶点函数<a href="#511-顶点函数" class="hash-link" aria-label="5.1.1 顶点函数的直接链接" title="5.1.1 顶点函数的直接链接">​</a></h2><p>你可以声明顶点，或者自 Metal 2.3 起 [<!-- -->[vertex]<!-- -->] 属性仅适用于图形函数。Metal 为顶点流中的每个顶点执行顶点函数并生成每个顶点的输出。以下示例显示了声明顶点的语法。</p><p>顶点无效</p><p>my_vertex_func(...)</p><p>{...}</p><p>[<!-- -->[顶点]<!-- -->] 无效</p><p>顶点函数 2(...)</p><p>{...}</p><p>对于顶点函数，返回类型标识函数生成的输出。如果顶点函数不生成输出，它将返回 void 并且只能在禁用光栅化的渲染管道中使用。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5111-曲面细分后顶点函数">5.1.1.1 曲面细分后顶点函数<a href="#5111-曲面细分后顶点函数" class="hash-link" aria-label="5.1.1.1 曲面细分后顶点函数的直接链接" title="5.1.1.1 曲面细分后顶点函数的直接链接">​</a></h2><p>所有操作系统：自 Metal 1.2 起支持曲面细分后顶点函数（补丁属性）。</p><p>曲面细分后顶点函数计算固定函数曲面细分器生成的面片上每个表面样本的顶点数据。曲面细分后顶点函数的输入为：</p><ul><li>每个补丁数据。- 修补控制点数据。- 细分器阶段输出（补丁上的标准化顶点位置）。</li></ul><p>细分后顶点函数生成细分三角形的最终顶点数据。例如，为了向渲染的几何体添加额外的细节（例如位移映射值），曲面细分后顶点函数可以对纹理进行采样，以通过位移值修改顶点位置。</p><p>执行后曲面细分顶点函数后，曲面细分的图元将被光栅化。</p><p>曲面细分后顶点函数是使用普通顶点函数属性标识的顶点函数。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5112-补丁类型和每个补丁的控制点数量">5.1.1.2 补丁类型和每个补丁的控制点数量<a href="#5112-补丁类型和每个补丁的控制点数量" class="hash-link" aria-label="5.1.1.2 补丁类型和每个补丁的控制点数量的直接链接" title="5.1.1.2 补丁类型和每个补丁的控制点数量的直接链接">​</a></h2><p>曲面细分后顶点函数需要 [<!-- -->[patch]<!-- -->] 属性。</p><p>对于 macOS，[<!-- -->[patch(patch-type, N)]<!-- -->] 属性必须指定面片类型（面片类型为四边形或三角形）和面片中控制点的数量（N 需要是以下值） 0 到 32）。对于 iOS，需要指定补丁类型，但控制点的数量是可选的。</p><p>如果在曲面细分后顶点函数中指定了控制点的数量，则该数量必须与提供给 drawPatches 或 drawIndexedPatches API 的控制点的数量匹配。</p><p>例子：</p><p>[<!-- -->[补丁（四）]<!-- -->]</p><p>[<!-- -->[顶点]<!-- -->] 顶点输出</p><p>my_post_tessellation_vertex(...)</p><p>{...}</p><p>[<!-- -->[补丁（四边形，16）]<!-- -->]</p><p>[<!-- -->[顶点]<!-- -->] 顶点输出</p><p>my_bezier_vertex(...)</p><p>{...}</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-12-片段函数">5 .1.2 片段函数<a href="#5-12-片段函数" class="hash-link" aria-label="5 .1.2 片段函数的直接链接" title="5 .1.2 片段函数的直接链接">​</a></h2><p>你可以声明片段或自 Metal 2.3 起 [<!-- -->[fragment]<!-- -->] 属性仅用于图形函数。Metal 为片段流中的每个片段及其关联数据执行片段函数，并生成每个片段的输出。以下示例显示了使用 fragment 属性声明片段函数的语法。</p><p>[<!-- -->[片段]<!-- -->]无效</p><p>my_fragment_func(...)</p><p>{...}</p><p>[<!-- -->[片段]<!-- -->]无效</p><p>fragment_func 2 (...){...}</p><p>对于图形函数，返回类型标识函数生成的输出是按顶点还是按片段。如果片段函数不生成输出，则返回 void。</p><p>要请求在片段函数执行之前执行片段测试，请将 [<!-- -->[early_fragment_tests]<!-- -->] 函数属性与片段函数结合使用，如下例所示。</p><p>[<!-- -->[early_fragment_tests]<!-- -->] 片段 float4</p><p>my_fragment( ... ) {...}</p><p>如果使用 [<!-- -->[early_fragment_tests]<!-- -->] 属性声明的片段函数的返回类型包含深度或模板值，则这是一个错误；也就是说，如果此片段函数的返回类型包含使用 [<!-- -->[深度(深度属性)]<!-- -->] 或 [<!-- -->[stencil]<!-- -->] 属性声明的元素。</p><p>将 [<!-- -->[early_fragment_tests]<!-- -->] 属性与任何非片段函数的函数一起使用是错误的；也就是说，没有用 fragment 属性声明。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="513-计算函数内核">5.1.3 计算函数（内核）<a href="#513-计算函数内核" class="hash-link" aria-label="5.1.3 计算函数（内核）的直接链接" title="5.1.3 计算函数（内核）的直接链接">​</a></h2><p>计算函数（也称为“内核”）是在 1、2 或 3 维网格上执行的数据并行函数。以下示例显示了使用内核或自 Metal 2.3 [<!-- -->[kernel]<!-- -->] 属性声明计算函数的语法。</p><p>内核无效 my_kernel(...) {...}</p><p>[<!-- -->[kernel]<!-- -->] void my_kernel2(...) {...}</p><p>使用内核或 [<!-- -->[kernel]<!-- -->] 属性声明的函数必须返回 void。</p><p>你可以将 [<!-- -->[max_total_threads_per_threadgroup]<!-- -->] 函数属性与内核函数结合使用来指定每个线程组的最大线程数。</p><p>下面是使用此属性的内核函数的示例：</p><p>[<!-- -->[max_total_threads_per_threadgroup(x)]<!-- -->] 内核 void my_kernel(...) {...}</p><p>如果 [<!-- -->[max_total_threads_per_threadgroup]<!-- -->] 值大于 <!-- -->[MTLDevice maxThreadsPerThreadgroup]<!-- --> 属性，则计算管道状态创建将失败。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="514-可见函数">5.1.4 可见函数<a href="#514-可见函数" class="hash-link" aria-label="5.1.4 可见函数的直接链接" title="5.1.4 可见函数的直接链接">​</a></h2><p>所有操作系统：自 Metal 2.3 起支持 [<!-- -->[visible]<!-- -->] 功能。</p><p>具有 [<!-- -->[visible]<!-- -->] 属性的函数是从 Metal Framework API 中可见的函数，即可以获取该函数的 MTLFunction 对象。获取可见函数的地址并获得可见函数指针是合法的。可见函数指针可以与 visible<em>function_table 类型一起使用（第 2.15 节）。其他函数直接调用可见函数是合法的。请注意，可见函数与其他 <!-- -->_<!-- -->qualified</em> 函数一样，被分成自己的翻译单元。当函数直接调用可见函数时，开发人员需要将其传递到管道描述符中。</p><p>以下示例使用 [<!-- -->[visible]<!-- -->] 属性。</p><p>[<!-- -->[visible]<!-- -->] float my_visible(device int <!-- -->*<!-- -->data, int data_offset) {...}</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="515-可缝合函数">5.1.5 可缝合函数<a href="#515-可缝合函数" class="hash-link" aria-label="5.1.5 可缝合函数的直接链接" title="5.1.5 可缝合函数的直接链接">​</a></h2><p>所有操作系统：自 Metal 2.4 起支持 [<!-- -->[可缝合]<!-- -->] 功能。</p><p>具有 [<!-- -->[stitchable]<!-- -->] 属性的函数是可以在 Metal Framework Function Stitching API 中使用的函数。[<!-- -->[stitchable]<!-- -->] 属性意味着 [<!-- -->[visible]<!-- -->]，这意味着可缝合函数可以在所有可以使用可见函数的上下文中使用，如第 5.1.4 节中所述。编译器将为可缝合函数生成额外的元数据，以使这些函数能够与 Metal Function Stitching API 一起使用。仅当开发人员需要此功能时才应使用此属性，因为元数据会增加函数的代码大小。</p><p>[<!-- -->[可缝合]<!-- -->] float my_func(device float <!-- -->*<!-- -->data,texture2d tex) {...}</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="516-交集函数">5.1.6 交集函数<a href="#516-交集函数" class="hash-link" aria-label="5.1.6 交集函数的直接链接" title="5.1.6 交集函数的直接链接">​</a></h2><p>所有操作系统：自 Metal 2.3 起支持 [<!-- -->[intersection(primitive_type, junction_tags...]<!-- -->] 函数</p><p>可以使用 [<!-- -->[intersection(primitive_type, junction_tags...)]<!-- -->] 属性声明一个与光线跟踪一起使用的自定义交集函数。当着色器调用 intersect()（参见第 6.18 节）时，会调用交集函数来确定潜在的光线交集是否有效或是否应继续遍历。Metal 支持以下类型的交集函数：</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="表-51交集函数基本类型">表 5.1。交集函数基本类型<a href="#表-51交集函数基本类型" class="hash-link" aria-label="表 5.1。交集函数基本类型的直接链接" title="表 5.1。交集函数基本类型的直接链接">​</a></h2><p><code>原始类型描述</code></p><p>```三角形 表示这是一个交集函数，扩展了默认的三角形交集测试。````</p><p><code>边界框</code></p><p>``` 表示这是一个相交函数，当光线与边界框相交时运行。````</p><p><code>Metal 3.1 以来的曲线</code></p><p>``` 表示这是一个交集函数，扩展了默认曲线交集测试。````</p><p>你可以传递零个或多个交叉标记，如第 2.17 节中的表 2. 9 中所述。一些例子是：</p><p>[<!-- -->[交集（三角形，三角形数据，实例化，世界空间数据）]<!-- -->]</p><p>布尔三角形 IntersectionFunction(...) {...}</p><p>[<!-- -->[交集（边界框、三角形数据、实例化、世界空间数据）]<!-- -->]</p><p>UserResultboundingBoxIntersectionFunction(...) {...}</p><p>交集函数 primitive_type 和 intersection_tags 控制允许的输入和输出属性（参见第 5.2.3.7 节）。</p><p>交集函数支持从设备和常量地址空间传递缓冲区参数。</p><p>交集函数不支持将纹理参数传递给交集函数。但是，你可以使用参数缓冲区传递纹理。</p><p>交集函数不支持线程组内存。</p><p>交集函数不支持 threadgroup_barrier 或 simdgroup_barrier。如果使用它们，结果是不确定的。</p><p>交集函数可能会或可能不会在与启动交集操作的线程相同的 SIMD 组中运行：允许实现在启动 SIMD 组进行交集测试之前重新组合或重新打包候选交集，以提高效率。</p><p>如果加速结构遍历找到程序框基元，并且交集函数是三角形测试器（反之亦然），则这是应用程序错误并且行为未定义。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="517-对象函数">5.1.7 对象函数<a href="#517-对象函数" class="hash-link" aria-label="5.1.7 对象函数的直接链接" title="5.1.7 对象函数的直接链接">​</a></h2><p>所有操作系统：从 Metal 3 开始支持 [<!-- -->[object]<!-- -->] 函数。</p><p>具有 [<!-- -->[object]<!-- -->] 属性的函数是网格管道中的对象函数。对象函数是在 1、2 或 3D 计算网格上执行的数据并行函数，可以将计算网格启动到第二个网格阶段并带有数据负载。对象函数必须返回 void。</p><p>对象函数的输入内置变量在第 5.2.3.9 节中描述。[<!-- -->[payload]<!-- -->] 属性将对象函数导出到网格着色器的缓冲区标记为只读缓冲区。每个函数可以指定一次。</p><p>你可以将 [<!-- -->[max_total_threads_per_threadgroup]<!-- -->] 函数属性与对象函数结合使用来指定每个线程组的最大线程数。</p><p>你可以在对象函数上使用 [<!-- -->[max_total_threadgroups_per_mesh_grid(size)]<!-- -->] 来指定每个网格的最大线程组数。以下是使用 [<!-- -->[object]<!-- -->] 属性的示例。</p><p>#define kMeshThreadgroups 32 struct ObjectOutput { // 用户定义的负载；每个网格线程组一个条目。// 这是一个数组，因为数据将由网格共享。浮点值<!-- -->[kMeshThreadgroups]<!-- -->； };</p><p>[<!-- -->[object, max_total_threadgroups_per_mesh_grid(kMeshThreadgroups)]<!-- -->] void objectShader(uint threadgroup_size [<!-- -->[threads_per_threadgroup]<!-- -->], uint Lane [<!-- -->[thread_index_in_threadgroup]<!-- -->], object_data ObjectOutput&amp; 输出 [<!-- -->[payload]<!-- -->], mesh_grid_properties mgp) {...}</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="518-网格函数">5.1.8 网格函数<a href="#518-网格函数" class="hash-link" aria-label="5.1.8 网格函数的直接链接" title="5.1.8 网格函数的直接链接">​</a></h2><p>所有操作系统：自 Metal 3 起支持 [<!-- -->[mesh]<!-- -->] 功能。</p><p>具有 [<!-- -->[mesh]<!-- -->] 属性的函数是网格管道中的网格函数。网格函数是一种数据并行函数，可以选择将表示几何块的网格对象导出到光栅化管道。网格对象是网格函数的参数。如果没有导出网格对象，则禁用光栅化。网格函数的输入内置变量在第 5.2.3.10 节中描述。网格函数必须返回 void。</p><p>你可以将 [<!-- -->[max_total_threads_per_threadgroup]<!-- -->] 函数属性与网格函数结合使用来指定每个线程组的最大线程数。以下是使用 [<!-- -->[mesh]<!-- -->] 属性的示例。</p><p>struct vertex_t { float4 Clip_pos [<!-- -->[位置]<!-- -->]; float3 世界位置；浮动 3 颜色； // 其他用户定义的属性 }; struct Primitive_t { float3 正常； };</p><p>// 可以导出一个立方体的网格声明。使用 cube_mesh_t = metal::mesh;结构 view_info_t { float4x4 view_proj; };</p><p>structcube_info_t { float4x3 世界;浮动 3 颜色； };</p><p>[<!-- -->[mesh, max_total_threads_per_threadgroup(12)]<!-- -->] voidcube_stage(cube_mesh_t 输出, const object_datacube_info_t &amp;cube [<!-- -->[payload]<!-- -->], 常量 view_info_t &amp;view [<!-- -->[buffer(0)]<!-- -->], uint gid [<!-- -->[threadgroup_position_in_grid]<!-- -->], uint Lane [<!-- -->[thread_index_in_threadgroup]<!-- -->]) {...}</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="519-平铺功能">5.1.9 平铺功能<a href="#519-平铺功能" class="hash-link" aria-label="5.1.9 平铺功能的直接链接" title="5.1.9 平铺功能的直接链接">​</a></h2><p>iOS：从 Metal 2 开始支持 Tile 功能。</p><p>macOS：从 Metal 2.3 开始支持 Tile 功能。</p><p><em>图块着色函数</em>是一种特殊类型的计算内核或片段函数，可以与图形操作内联执行并利用基于图块的延迟渲染 (TBDR) 架构。使用 TBDR，命令会被缓冲，直到累积大量命令为止。硬件将帧缓冲区划分为图块，然后仅渲染每个图块内可见的图元。平铺着色函数支持在渲染过程中执行计算操作，这可以通过减少内存往返和利用高带宽本地内存来更有效地访问内存。</p><p>平铺函数启动一组称为 <em>dispatch</em> 的线程，这些线程被组织成线程组和网格。你可以根据需要在渲染通道中的任何点启动线程。平铺函数会阻碍之前和后续的绘制，因此平铺函数在所有早期绘制完成之前不会执行。同样，在 tile 函数完成之前不会执行后面的绘制。</p><p>GPU 始终处理每个图块和每个调度直至完成。在处理下一个图块之前，所有绘制和分派都会在提交时启动图块。</p><p>平铺函数可以访问 32 KB 的线程组内存，该内存可以在图像块存储和线程组存储之间划分。（有关线程组内存大小的更多信息，请参阅第 4.4 节。）图像块大小取决于图块宽度、图块高度和每个样本的位深度。渲染通道附件（使用隐式图像块布局；请参阅第 5.6.3.1 节）或函数声明的结构（使用显式图像块布局；请参阅第 5.6.3.2 节）确定样本的位深度。有关内核函数如何利用 threadgroup_imageblock 地址空间的更多信息，请参阅第 4.5 节。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5110-主机名属性">5.1.10 主机名属性<a href="#5110-主机名属性" class="hash-link" aria-label="5.1.10 主机名属性的直接链接" title="5.1.10 主机名属性的直接链接">​</a></h2><p>从 Metal 2.2 开始，你可以覆盖 Metal Framework API 用于引用限定函数的默认名称。将 [<!-- -->[host_name(name)]<!-- -->] 属性添加到函数声明中，其中 name 是 Metal Framework API 将用来引用函数名称的字符串文字。如果给不同的函数赋予相同的名称，编译器会引发编译时错误。例如，</p><p>[<!-- -->[host_name(&quot;abc&quot;)]<!-- -->] [<!-- -->[kernel]<!-- -->] void funcA() {} // Metal API 名称为 abc</p><p>[<!-- -->[host_name(&quot;xyz&quot;)]<!-- -->] [<!-- -->[kernel]<!-- -->] void funcX() {} // Metal API 名称为 xyz</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5111-模板化限定函数">5.1.11 模板化限定函数<a href="#5111-模板化限定函数" class="hash-link" aria-label="5.1.11 模板化限定函数的直接链接" title="5.1.11 模板化限定函数的直接链接">​</a></h2><p>从 Metal 2.2 开始，你可以使用模板进行限定函数（例如顶点、片段、可见和内核函数）声明。你必须显式实例化模板以强制编译器为给定的专业化发出代码。例如，</p><p>template kernel void bar(device T <em>x) { ... } // 使用 <!-- -->[T = int]<!-- --> 显式特化 <code>bar</code> template kernel void bar(device int </em>);</p><p>编译器为所有专业化提供相同的名称，除非使用 [<!-- -->[host_name(name)]<!-- -->] 属性为每个专业化提供不同的名称。</p><p>// 使用 <!-- -->[T = int]<!-- --> 和 host_name 显式特化 <code>bar</code> // &quot;bar_int&quot; 模板 [<!-- -->[host_name(&quot;bar_int&quot;)]<!-- -->] kernel void bar(device int <!-- -->*<!-- -->);</p><p>// 使用 <!-- -->[T = float]<!-- --> 和 host_name 显式特化 <code>bar</code> // &quot;bar_float&quot; 模板 [<!-- -->[host_name(&quot;bar_float&quot;)]<!-- -->] kernel void bar(device float <!-- -->*<!-- -->);</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/zhuanghongji/swift-tutorials-cn/docs/metal-shading-language-specification/functions/index.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->于 <b><time datetime="2023-08-29T05:01:04.000Z">2023年8月29日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/swift-tutorials-cn/docs/metal-shading-language-specification/object-data-address-space"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">object_data 地址空间</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/swift-tutorials-cn/docs/metal-shading-language-specification/function-arguments-and-variables"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">函数参数和变量</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#511-顶点函数" class="table-of-contents__link toc-highlight">5.1.1 顶点函数</a></li><li><a href="#5111-曲面细分后顶点函数" class="table-of-contents__link toc-highlight">5.1.1.1 曲面细分后顶点函数</a></li><li><a href="#5112-补丁类型和每个补丁的控制点数量" class="table-of-contents__link toc-highlight">5.1.1.2 补丁类型和每个补丁的控制点数量</a></li><li><a href="#5-12-片段函数" class="table-of-contents__link toc-highlight">5 .1.2 片段函数</a></li><li><a href="#513-计算函数内核" class="table-of-contents__link toc-highlight">5.1.3 计算函数（内核）</a></li><li><a href="#514-可见函数" class="table-of-contents__link toc-highlight">5.1.4 可见函数</a></li><li><a href="#515-可缝合函数" class="table-of-contents__link toc-highlight">5.1.5 可缝合函数</a></li><li><a href="#516-交集函数" class="table-of-contents__link toc-highlight">5.1.6 交集函数</a></li><li><a href="#表-51交集函数基本类型" class="table-of-contents__link toc-highlight">表 5.1。交集函数基本类型</a></li><li><a href="#517-对象函数" class="table-of-contents__link toc-highlight">5.1.7 对象函数</a></li><li><a href="#518-网格函数" class="table-of-contents__link toc-highlight">5.1.8 网格函数</a></li><li><a href="#519-平铺功能" class="table-of-contents__link toc-highlight">5.1.9 平铺功能</a></li><li><a href="#5110-主机名属性" class="table-of-contents__link toc-highlight">5.1.10 主机名属性</a></li><li><a href="#5111-模板化限定函数" class="table-of-contents__link toc-highlight">5.1.11 模板化限定函数</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://developer.apple.com/xcode/swiftui/" target="_blank" rel="noopener noreferrer" class="footer__link-item">SwiftUI Overview</a></li><li class="footer__item"><a href="https://developer.apple.com/documentation/swiftui/" target="_blank" rel="noopener noreferrer" class="footer__link-item">SwiftUI Documentation</a></li><li class="footer__item"><a href="https://developer.apple.com/videos/swiftui-ui-frameworks" target="_blank" rel="noopener noreferrer" class="footer__link-item">SwiftUI &amp; UI Frameworks Videos</a></li><li class="footer__item"><a href="https://docs.swift.org/swift-book/documentation/the-swift-programming-language/" target="_blank" rel="noopener noreferrer" class="footer__link-item">The Swift Programming Language</a></li></ul></div><div class="col footer__col"><div class="footer__title">参考</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.fatbobman.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Fatbob Man</a></li><li class="footer__item"><a href="https://designcode.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Design Code</a></li><li class="footer__item"><a href="https://www.swiftanytime.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Swift Anytime</a></li><li class="footer__item"><a href="https://www.hackingwithswift.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Hacking With Swift</a></li></ul></div><div class="col footer__col"><div class="footer__title">探索</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.youtube.com/@Kavsoft" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kavsoft</a></li><li class="footer__item"><a href="https://www.youtube.com/@ChaoCode" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chao Code</a></li><li class="footer__item"><a href="https://www.youtube.com/@iOSAcademy" target="_blank" rel="noopener noreferrer" class="footer__link-item">iOS Academy</a></li><li class="footer__item"><a href="https://www.youtube.com/@XCA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Xcoding with Alfian</a></li></ul></div><div class="col footer__col"><div class="footer__title">发现</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/swift-tutorials-cn/sponsor-me">Sponsor Me</a></li><li class="footer__item"><a class="footer__link-item" href="/swift-tutorials-cn/sponsor-list">Sponsor List</a></li><li class="footer__item"><a href="https://twitter.com/ajizhhans" target="_blank" rel="noopener noreferrer" class="footer__link-item">Follow Twitter</a></li><li class="footer__item"><a href="https://github.com/zhuanghongji" target="_blank" rel="noopener noreferrer" class="footer__link-item">Follow GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 ZHUANGHONGJI<br><a style="font-size: 12px;color: white;" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0) License</a></div></div></div></footer></div>
<script src="/swift-tutorials-cn/assets/js/runtime~main.b4417766.js"></script>
<script src="/swift-tutorials-cn/assets/js/main.0cbf57d5.js"></script>
</body>
</html>