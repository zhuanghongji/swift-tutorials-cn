<!doctype html>
<html lang="zh-hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-metal-shading-language-specification/texture-addressing-and-conversion-rules/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">纹理寻址和转换规则 | Swift 悍刀行</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zhuanghongji.github.io/swift-tutorials-cn/docs/metal-shading-language-specification/texture-addressing-and-conversion-rules"><meta data-rh="true" name="docusaurus_locale" content="zh-hans"><meta data-rh="true" name="docsearch:language" content="zh-hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="纹理寻址和转换规则 | Swift 悍刀行"><meta data-rh="true" name="description" content="指定给 sample、samplecompare、gather、gathercompare、read 和 write 函数的纹理坐标不能是 INF 或 NaN。另外，对于纹理读取和写入函数，纹理坐标必须引用纹理内部的区域。如果纹理坐标超出纹理边界，则 read 和 write 函数行为未定义。"><meta data-rh="true" property="og:description" content="指定给 sample、samplecompare、gather、gathercompare、read 和 write 函数的纹理坐标不能是 INF 或 NaN。另外，对于纹理读取和写入函数，纹理坐标必须引用纹理内部的区域。如果纹理坐标超出纹理边界，则 read 和 write 函数行为未定义。"><link data-rh="true" rel="icon" href="/swift-tutorials-cn/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://zhuanghongji.github.io/swift-tutorials-cn/docs/metal-shading-language-specification/texture-addressing-and-conversion-rules"><link data-rh="true" rel="alternate" href="https://zhuanghongji.github.io/swift-tutorials-cn/docs/metal-shading-language-specification/texture-addressing-and-conversion-rules" hreflang="zh-hans"><link data-rh="true" rel="alternate" href="https://zhuanghongji.github.io/swift-tutorials-cn/docs/metal-shading-language-specification/texture-addressing-and-conversion-rules" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/swift-tutorials-cn/blog/rss.xml" title="Swift 悍刀行 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/swift-tutorials-cn/blog/atom.xml" title="Swift 悍刀行 Atom Feed"><link rel="stylesheet" href="/swift-tutorials-cn/assets/css/styles.2fe221d4.css">
<link rel="preload" href="/swift-tutorials-cn/assets/js/runtime~main.e8a3ce7b.js" as="script">
<link rel="preload" href="/swift-tutorials-cn/assets/js/main.521b0f3d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/swift-tutorials-cn/"><div class="navbar__logo"><img src="/swift-tutorials-cn/img/logo.svg" alt="Swift 悍刀行" class="themedImage_ToTc themedImage--light_HNdA"><img src="/swift-tutorials-cn/img/logo.svg" alt="Swift 悍刀行" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Swift 悍刀行</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/swift-tutorials-cn/docs/swift/welcome/about">Swift</a><a class="navbar__item navbar__link" href="/swift-tutorials-cn/docs/swiftui/essentials/about">SwiftUI</a><a class="navbar__item navbar__link" href="/swift-tutorials-cn/docs/swift-data/essentials/about">SwiftData</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Media</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/audio-toolbox/esseentials/about">Audio Toolbox</a></li><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/avf-audio/esseentials/about">AVFAudio</a></li><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/av-foundation/esseentials/about">AVFoundation</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Frameworks</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/core-graphics/overview">Core Graphics</a></li><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/charts/essentials/about">Charts</a></li><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/metal/overview">Metal</a></li><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/metalkit/overview">MetalKit</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Books</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/swift-tutorials-cn/docs/metal-programming-guide/introdution">Metal Programming Guide</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/swift-tutorials-cn/docs/metal-shading-language-specification/preface">Metal Shading Language Specification 3.1</a></li></ul></div><a href="https://github.com/zhuanghongji/swift-tutorials-cn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-github-link" aria-label="GitHub repository"></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Metal Shading Language 规范</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/preface">前言</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/preface">前言</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/purpose-of-this-document">介绍</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/purpose-of-this-document">本文档的目的</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/organization-of-this-specification">本规范的组织</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/references">参考文献</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/metal-and-cpp14">Metal 和 C++14</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/compiler-and-preprocessor">编译器和预处理器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/metal-coordinate-systems">Metal 坐标系</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/scalar-data-types">数据类型</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/scalar-data-types">标量数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/vector-data-types">向量数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/matrix-data-types">矩阵数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/simd-group-matrix-data-types">SIMD 组矩阵数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/alignment-of-data-types">数据类型的对齐</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/atomic-data-types">原子数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/pixel-data-types">像素数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/buffers">缓冲区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/textures">纹理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/samplers">采样器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/imageblocks">图像块</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/aggregate-types">聚合类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/argument-buffers">参数缓冲区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/uniform-type">统一类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/visible-function-table">可见函数表</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/function-group-attribute">功能组属性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/ray-tracing-types">光线追踪类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/interpolant-type">插值类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/mesh-shader-types">网格着色器类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/type-conversions-and-re-interpreting-data">类型转换和重新解释数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/implicit-type-conversions">隐式类型转换</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/scalar-and-vector-operators">运算符</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/scalar-and-vector-operators">标量和向量运算符</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/matrix-operators">矩阵运算符</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/device-address-space">地址空间</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/device-address-space">设备地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/constant-address-space">常量地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/thread-address-space">线程地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/threadgroup-address-space">线程组地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/threadgroup-imageblock-address-space">threadgroup_imageblock 地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/ray-data-address-space">ray_data 地址空间</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/object-data-address-space">object_data 地址空间</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/functions">函数与变量声明</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/functions">函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/function-arguments-and-variables">函数参数和变量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/storage-class-specifiers">存储类说明符</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/sampling-and-interpolation-attributes">采样和插值属性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/per-fragment-function-versus-per-sample-function">每片段函数与每样本函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/imageblock-attributes">图像块属性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/graphics-function-signature-matching">图形功能 - 签名匹配</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/program-scope-function-constants">程序作用域函数常量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/program-scope-global-built-ins">程序范围全局内置函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/per-primitive-viewport-and-scissor-rectangle-index-selection">每个图元视口和剪刀矩形索引选择</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/additional-restrictions">附加限制</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/namespace-and-header-files">Metal 标准库</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/namespace-and-header-files">命名空间和头文件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/common-functions">常用函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/integer-functions">整数函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/relational-functions">关系函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/math-functions">数学函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/matrix-functions">矩阵函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/simd-group-matrix-functions">SIMD-group 矩阵函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/geometric-functions">几何函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/synchronization-and-simd-group-functions">同步和 SIMD-group 功能</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/graphics-functions">图形函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/pull-model-interpolation">拉模型插值</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/texture-functions">纹理函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/imageblock-functions">图像块函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/pack-and-unpack-functions">打包和解包函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/atomic-functions">原子函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/encoding-commands-for-indirect-command-buffers">间接命令缓冲区的编码命令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/variable-rasterization-rate">可变光栅化率</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/ray-tracing-functions">光线追踪函数</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/inf-nan-and-denormalized-numbers">数值符合性</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/inf-nan-and-denormalized-numbers">INF、NaN 和非规范化数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/rounding-mode">舍入模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/floating-point-exceptions">浮点异常</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/relative-error-as-ulps">作为 ULP 的相对误差</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/edge-case-behavior-in-flush-to-zero-mode">清零模式下的边缘情况行为</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/conversion-rules-for-floating-point-and-integer-types">浮点型和整数型的转换规则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/swift-tutorials-cn/docs/metal-shading-language-specification/texture-addressing-and-conversion-rules">纹理寻址和转换规则</a></li></ul></li></ul></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/swift-tutorials-cn/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Metal Shading Language 规范</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">数值符合性</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">纹理寻址和转换规则</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>纹理寻址和转换规则</h1><div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>警告</div><div class="admonitionContent_S0QG"><p>该文档目前仅完成 Google 翻译，需进一步校对和润色。</p></div></div></div><div style="padding-left:1rem;padding-right:1rem;padding-top:1.5rem;padding-bottom:0.5rem;border-radius:0.5rem;background-color:#333333"><p>原文：<a href="https://developer.apple.com/metal/Metal-Shading-Language-Specification.pdf">Metal Shading Language Specification - Version 3.1</a></p><blockquote>7.7 Texture Addressing and Conversion Rules</blockquote></div><br><p>指定给 <code>sample</code>、<code>sample_compare</code>、<code>gather</code>、<code>gather_compare</code>、<code>read</code> 和 <code>write</code> 函数的纹理坐标不能是 INF 或 NaN。另外，对于纹理读取和写入函数，纹理坐标必须引用纹理内部的区域。如果纹理坐标超出纹理边界，则 <code>read</code> 和 <code>write</code> 函数行为未定义。</p><p>以下各节讨论在图形或内核函数中读取和写入纹理时转换规则的应用。执行多重采样解析操作时，这些转换规则不适用。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="归一化整数像素数据类型的转换规则">归一化整数像素数据类型的转换规则<a href="#归一化整数像素数据类型的转换规则" class="hash-link" aria-label="归一化整数像素数据类型的转换规则的直接链接" title="归一化整数像素数据类型的转换规则的直接链接">​</a></h2><p>本节讨论将标准化整数像素数据类型转换为浮点值，反之亦然。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="将标准化整数像素数据类型转换为浮点值">将标准化整数像素数据类型转换为浮点值<a href="#将标准化整数像素数据类型转换为浮点值" class="hash-link" aria-label="将标准化整数像素数据类型转换为浮点值的直接链接" title="将标准化整数像素数据类型转换为浮点值的直接链接">​</a></h3><p>对于具有 8、10 或 16 位归一化无符号整数像素值的纹理，纹理采样和读取函数将像素值从 8 或 16 位无符号整数转换为归一化单精度或半精度浮点数- <code>[0.0...1.0]</code> 范围内的点值。</p><p>对于具有 8 位或 16 位标准化有符号整数像素值的纹理，纹理采样和读取函数将像素值从 8 位或 16 位有符号整数转换为标准化单精度或半精度浮点值范围 <code>[-1.0...1.0]</code>。</p><p>这些转换按照表 7 第二列中列出的方式执行。6. 转换规则的精度保证 <code>&lt;= 1.5</code> ulp，&quot;极端情况&quot; 列中描述的情况除外。</p><div style="display:flex;flex-direction:column;width:100%;justify-content:center;align-items:center"><div><strong>Table 7.6 - Conversion to a normalized float value</strong></div><br><center style="max-width:90%"><table><thead><th>Convert from</th><th>Conversion Rule to Normalized Float</th><th>Corner Cases</th></thead><tbody><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">1-bit normalized unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">float(c)</td><td style="white-space:pre-line;min-width:10rem;color:white">0 must convert to 0.0 1 
must convert to 1.0</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">2-bit normalized</td><td style="white-space:pre-line;min-width:10rem;color:white">unsigned integer float(c) / 3.0</td><td style="white-space:pre-line;min-width:10rem;color:white">0 must convert to 0.0 
3 must convert to 1.0</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">4-bit normalized unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">float(c) / 15.0</td><td style="white-space:pre-line;min-width:10rem;color:white">0 must convert to 0.0 15 
must convert to 1.0</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">5-bit normalized</td><td style="white-space:pre-line;min-width:10rem;color:white">unsigned integer float(c) / 31.0</td><td style="white-space:pre-line;min-width:10rem;color:white">0 must convert to 0.0 31 
must convert to 1.0</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">6-bit normalized unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">float(c) / 63.0</td><td style="white-space:pre-line;min-width:10rem;color:white">0 must convert to 0.0 63 
must convert to 1.0</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">8-bit normalized</td><td style="white-space:pre-line;min-width:10rem;color:white">unsigned integer float(c) / 255.0</td><td style="white-space:pre-line;min-width:10rem;color:white">0 must convert to 0.0 
255 must convert to 1.0</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">10-bit normalized unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">float(c) / 1023.0</td><td style="white-space:pre-line;min-width:10rem;color:white">0 must convert to 0.0 1023 
must convert to 1.0</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">16-bit normalized</td><td style="white-space:pre-line;min-width:10rem;color:white">unsigned integer float(c) / 65535.0</td><td style="white-space:pre-line;min-width:10rem;color:white">0 must convert to 0.0 
65535 must convert to 1.0</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">8-bit normalized signed integer</td><td style="white-space:pre-line;min-width:10rem;color:white">max(-1.0, float(c)/127.0)</td><td style="white-space:pre-line;min-width:10rem;color:white">-128 and -127 must convert to -1.0 
0 must convert to 0.0 
127 must convert to 1.0</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">16-bit normalized</td><td style="white-space:pre-line;min-width:10rem;color:white">signed integer max(-1.0, float(c)/32767.0)</td><td style="white-space:pre-line;min-width:10rem;color:white">-32768 and -32767 must convert to -1.0 
0 must convert to 0.0 
32767 must convert to 1.0</td></tr></tbody></table></center><br></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="将浮点值转换为标准化整数像素数据类型">将浮点值转换为标准化整数像素数据类型<a href="#将浮点值转换为标准化整数像素数据类型" class="hash-link" aria-label="将浮点值转换为标准化整数像素数据类型的直接链接" title="将浮点值转换为标准化整数像素数据类型的直接链接">​</a></h3><p>对于具有 8、10 或 16 位归一化无符号整数像素值的纹理，纹理写入函数会将单精度或半精度浮点像素值转换为 8 或 16 位无符号整数。</p><p>对于具有 8 或 16 位标准化有符号整数像素值的纹理，纹理写入函数会将单精度或半精度浮点像素值转换为 8 或 16 位有符号整数。</p><p>NaN 值转换为零。</p><p>从浮点值到标准化整数值的转换按照表 7.7 中列出的方式执行。</p><div style="display:flex;flex-direction:column;width:100%;justify-content:center;align-items:center"><div><strong>Table 7.7 - Conversion from floating-point to a normalized integer value</strong></div><br><center style="max-width:90%"><table><thead><th>Convert to</th><th>Conversion Rule to Normalized Integer</th></thead><tbody><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">1-bit normalized 
unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">x = min(max(f, 0.0), 1.0) 
i0:0 = intRTNE(x)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">2-bit normalized 
unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">x = min(max(f * 3.0, 0.0), 3.0) 
i1:0 = intRTNE(x)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">4-bit normalized 
unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">x = min(max(f * 15.0, 0.0), 15.0) 
i3:0 = intRTNE(x)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">5-bit normalized 
unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">x = min(max(f * 31.0, 0.0), 31.0) 
i4:0 = intRTNE(x)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">6-bit normalized 
unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">x = min(max(f * 63.0, 0.0), 63.0) 
i5:0 = intRTNE(x)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">8-bit normalized 
unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">x = min(max(f * 255.0, 0.0), 255.0) 
i7:0 = intRTNE(x)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">10-bit normalized 
unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">x = min(max(f * 1023.0, 0.0), 1023.0) 
i9:0 = intRTNE(x)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">16-bit normalized 
unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">result = min(max(f * 65535.0, 0.0), 65535.0) 
i15:0 = intRTNE(x)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">8-bit normalized 
signed integer</td><td style="white-space:pre-line;min-width:10rem;color:white">result = min(max(f * 127.0, -127.0), 127.0) 
i7:0 = intRTNE(x)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">16-bit normalized 
signed integer</td><td style="white-space:pre-line;min-width:10rem;color:white">result = min(max(f * 32767.0, -32767.0),32767.0) 
i15:0 = intRTNE(x)</td></tr></tbody></table></center><br></div><p>在 Metal 2 中，所有与非规范数据类型之间的转换都应正确舍入。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="半精度浮点像素数据类型的转换规则">半精度浮点像素数据类型的转换规则<a href="#半精度浮点像素数据类型的转换规则" class="hash-link" aria-label="半精度浮点像素数据类型的转换规则的直接链接" title="半精度浮点像素数据类型的转换规则的直接链接">​</a></h2><p>对于具有半精度（half-precision ）浮点像素颜色值的纹理，从 <code>half</code> 到 <code>float</code> 的转换是无损的。使用舍入方式将尾数从 <code>float</code> 转换为 <code>half</code> 到偶数舍入模式。将 <code>float</code> 转换为 <code>half</code> 时可能生成的 <code>half</code> 数据类型的非规范化数字可能不会刷新为零。<code>float</code> NaN 可以转换为适当的 NaN 或在 <code>half</code> 类型中刷新为零。必须将浮点 INF 转换为 <code>half</code> 类型中的适当 INF。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="单精度浮点像素数据类型的转换规则">单精度浮点像素数据类型的转换规则<a href="#单精度浮点像素数据类型的转换规则" class="hash-link" aria-label="单精度浮点像素数据类型的转换规则的直接链接" title="单精度浮点像素数据类型的转换规则的直接链接">​</a></h2><p>以下规则适用于读取和写入具有单精度浮点像素颜色值的纹理：</p><ul><li>NaN 可以转换为 NaN 值或刷新为零。</li><li>必须保留 INF。</li><li>非规范化的数字可能会被刷新为零。- 必须保留所有其它值。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="10-位和-11-位浮点像素数据类型的转换规则">10 位和 11 位浮点像素数据类型的转换规则<a href="#10-位和-11-位浮点像素数据类型的转换规则" class="hash-link" aria-label="10 位和 11 位浮点像素数据类型的转换规则的直接链接" title="10 位和 11 位浮点像素数据类型的转换规则的直接链接">​</a></h2><p>浮点格式使用 5 位指数，对于 10 位浮点类型使用 5 位尾数，对于 11 位浮点类型使用 6 位尾数，并为这两种类型提供附加隐藏位。没有符号位。10 位和 11 位浮点类型保留非正规数。</p><p>这些浮点格式使用以下规则：</p><ul><li>如果指数和尾数均为 0，则浮点值为 0.0。</li><li>如果指数为 31 并且尾数为&quot;= 0，则生成的浮点值为 NaN。</li><li>如果指数为 31 并且尾数为 0，则生成的浮点值为正无穷大。</li><li>如果 0 <code>&lt;=</code> 指数 <code>&lt;=</code> 31，浮点值为 <code>2^(exponent - 15) * (1 + mantissa / N)</code>。</li><li>如果 exponent 为 0，mantissa 不等于 0，则浮点值为 a 非规格化数为 <code>2^(exponent - 14) * (mantissa / N)</code>。如果 mantissa 为 5 位，则 N 为 32；如果 mantissa 为 6 位，则 N 为 64。</li></ul><p>将 10 位或 11 位浮点像素数据类型转换为半精度或单精度浮点值是无损的。半精度或单精度浮点值到 10 位或 11 位浮点值的转换必须 <code>&lt;=</code> 0.5 ULP。对于这些浮点类型，任何导致值小于零的操作都会被钳位为零。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="具有-5-位指数的-9-位浮点像素数据类型的转换规则">具有 5 位指数的 9 位浮点像素数据类型的转换规则<a href="#具有-5-位指数的-9-位浮点像素数据类型的转换规则" class="hash-link" aria-label="具有 5 位指数的 9 位浮点像素数据类型的转换规则的直接链接" title="具有 5 位指数的 9 位浮点像素数据类型的转换规则的直接链接">​</a></h2><p><code>RGB9E5_SharedExponent</code> 共享指数浮点格式使用 5 位作为指数，9 位作为尾数。没有符号位。</p><p>从这种格式到半精度或单精度浮点值的转换是无损的，并且对于每个颜色通道计算为 <code>2^(shared exponent - 15) * (mantissa / 512)</code>。</p><p>从半精度或单精度浮点 RGB 颜色值到此格式的转换按如下方式执行，其中 <code>N</code> 是每个分量的尾数位数 (9)，<code>B</code> 是指数偏差 (15)，<code>Emax</code> 是允许的最大偏差指数值 (31)。</p><ul><li>限制 <code>r</code>、<code>g</code> 和 <code>b</code> 分量（在此过程中，将 NaN 映射为零），如下所示：</li></ul><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rc </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">min</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sharedexpmax</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gc </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">min</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sharedexpmax</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> g</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bc </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">min</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sharedexpmax</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其中 <code>sharedexpmax = ((2N - 1) / 2N) * 2(Emax - B)</code>。</p><ul><li>确定最大 clamped 分量 <code>maxc</code>：</li></ul><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">maxc </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> gc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>计算初步共享指数 <code>expp</code></li></ul><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">expp </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">-</span><span class="token plain">B </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">floor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">log2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">maxc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> B</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>计算精确的共享指数 <code>exps</code></li></ul><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">maxs </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">floor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">maxc </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> expp </span><span class="token operator">-</span><span class="token plain"> B </span><span class="token operator">-</span><span class="token plain"> N</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>exps = expp</code>, 如果 <code>0 &lt;= maxs &lt; 2N</code>。<code>exps = expp + 1</code>, 如果 <code>maxs = 2N</code>。</p><ul><li>最后，计算 <code>0</code> 到 <code>2N - 1</code> 范围内的三个整数值：</li></ul><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rs </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">floor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rc </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> expp </span><span class="token operator">-</span><span class="token plain"> B </span><span class="token operator">-</span><span class="token plain"> N</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">0.5f</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gs </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">floor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gc </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> expp </span><span class="token operator">-</span><span class="token plain"> B </span><span class="token operator">-</span><span class="token plain"> N</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">0.5f</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bs </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">floor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">bc </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> expp </span><span class="token operator">-</span><span class="token plain"> B </span><span class="token operator">-</span><span class="token plain"> N</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">0.5f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>将半精度或单精度浮点颜色值转换为 <code>MTLPixelFormatRGB9E5Float</code> 共享指数浮点值 <code>&lt;=</code> 0.5 ULP。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="有符号和无符号整数像素数据类型的转换规则">有符号和无符号整数像素数据类型的转换规则<a href="#有符号和无符号整数像素数据类型的转换规则" class="hash-link" aria-label="有符号和无符号整数像素数据类型的转换规则的直接链接" title="有符号和无符号整数像素数据类型的转换规则的直接链接">​</a></h2><p>对于具有 8 或 16 位有符号或无符号整数像素值的纹理，纹理采样和读取函数返回有符号或无符号 32 位整数像素值。本节中描述的转换必须正确饱和。</p><p>对这些整数纹理的写入执行表 7.8 中列出的转换之一。</p><div style="display:flex;flex-direction:column;width:100%;justify-content:center;align-items:center"><div><strong>Table 7.8 - Conversion between integer pixel data types</strong></div><br><center style="max-width:90%"><table><thead><th>Convert From</th><th>To</th><th>Conversion Rule</th></thead><tbody><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">32-bit signed integer</td><td style="white-space:pre-line;min-width:10rem;color:white">8-bit signed integer</td><td style="white-space:pre-line;min-width:10rem;color:white">result = convert_char_saturate(val)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">32-bit signed integer</td><td style="white-space:pre-line;min-width:10rem;color:white">16-bit signed integer</td><td style="white-space:pre-line;min-width:10rem;color:white">result = convert_short_saturate(val)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">32-bit unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">8-bit unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">result = convert_uchar_saturate(val)</td></tr><tr><td style="white-space:pre-line;min-width:10rem;color:#BDBDBD">32-bit unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">16-bit unsigned integer</td><td style="white-space:pre-line;min-width:10rem;color:white">result = convert_ushort_saturate(val)</td></tr></tbody></table></center><br></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="srgba-和-sbgra-纹理的转换规则">sRGBA 和 sBGRA 纹理的转换规则<a href="#srgba-和-sbgra-纹理的转换规则" class="hash-link" aria-label="sRGBA 和 sBGRA 纹理的转换规则的直接链接" title="sRGBA 和 sBGRA 纹理的转换规则的直接链接">​</a></h2><p>Conversion from sRGB space to linear space is automatically done when sampling from an sRGB texture. The conversion from sRGB to linear RGB is performed before the filter specified in the sampler specified when sampling the texture is applied. If the texture has an alpha channel, the alpha data is stored in linear color space.</p><p>写入 sRGB 纹理时，会自动完成从线性空间到 sRGB 空间的转换。如果纹理具有 Alpha 通道，则 Alpha 数据存储在线性颜色空间中。</p><p>以下是将标准化的 8 位无符号整数从 sRGB 颜色值转换为浮点线性 RGB 颜色值（称为 c）的转换规则：</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">c </span><span class="token operator">&lt;=</span><span class="token plain"> </span><span class="token number">0.04045</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    result </span><span class="token operator">=</span><span class="token plain"> c </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">12.92</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    result </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">powr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">c </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">0.055</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">1.055</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2.4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上述转换的精度必须确保将结果转换回非标准化 sRGB 值但不舍入为 8 位无符号整数值（称为 r）时所得无限精确浮点值与原始 sRGB 8 之间的差值位无符号整数颜色值（称为 <code>rorig</code>）<code>&lt;=</code> 0.5；例如：</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">fabs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">r </span><span class="token operator">-</span><span class="token plain"> rorig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&lt;=</span><span class="token plain"> </span><span class="token number">0.5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用以下规则将线性 RGB 浮点颜色值（称为 c）转换为标准化 8 位无符号整数 sRGB 值：</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">isnan</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> c </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">c </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">1.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    c </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">c </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    c </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">c </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token number">0.0031308</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    c </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">12.92</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    c </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1.055</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">powr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0</span><span class="token operator">/</span><span class="token number">2.4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">0.055</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//  Convert to integer scale: c = c * 255.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//  Convert to integer: c = c + 0.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//  Drop the decimal fraction. The remaining floating-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">point</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">integral</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> value</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//  is converted directly to an integer.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上述转换的精度为：</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">fabs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">reference result </span><span class="token operator">-</span><span class="token plain"> integer result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token number">1.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p> Apple Inc. 版权所有 © 2018 - 2023 Apple Inc. 保留所有权利。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/zhuanghongji/swift-tutorials-cn/docs/metal-shading-language-specification/texture-addressing-and-conversion-rules/index.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->于 <b><time datetime="2023-10-31T08:31:31.000Z">2023年10月31日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/swift-tutorials-cn/docs/metal-shading-language-specification/conversion-rules-for-floating-point-and-integer-types"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">浮点型和整数型的转换规则</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#归一化整数像素数据类型的转换规则" class="table-of-contents__link toc-highlight">归一化整数像素数据类型的转换规则</a><ul><li><a href="#将标准化整数像素数据类型转换为浮点值" class="table-of-contents__link toc-highlight">将标准化整数像素数据类型转换为浮点值</a></li><li><a href="#将浮点值转换为标准化整数像素数据类型" class="table-of-contents__link toc-highlight">将浮点值转换为标准化整数像素数据类型</a></li></ul></li><li><a href="#半精度浮点像素数据类型的转换规则" class="table-of-contents__link toc-highlight">半精度浮点像素数据类型的转换规则</a></li><li><a href="#单精度浮点像素数据类型的转换规则" class="table-of-contents__link toc-highlight">单精度浮点像素数据类型的转换规则</a></li><li><a href="#10-位和-11-位浮点像素数据类型的转换规则" class="table-of-contents__link toc-highlight">10 位和 11 位浮点像素数据类型的转换规则</a></li><li><a href="#具有-5-位指数的-9-位浮点像素数据类型的转换规则" class="table-of-contents__link toc-highlight">具有 5 位指数的 9 位浮点像素数据类型的转换规则</a></li><li><a href="#有符号和无符号整数像素数据类型的转换规则" class="table-of-contents__link toc-highlight">有符号和无符号整数像素数据类型的转换规则</a></li><li><a href="#srgba-和-sbgra-纹理的转换规则" class="table-of-contents__link toc-highlight">sRGBA 和 sBGRA 纹理的转换规则</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://developer.apple.com/xcode/swiftui/" target="_blank" rel="noopener noreferrer" class="footer__link-item">SwiftUI Overview</a></li><li class="footer__item"><a href="https://developer.apple.com/documentation/swiftui/" target="_blank" rel="noopener noreferrer" class="footer__link-item">SwiftUI Documentation</a></li><li class="footer__item"><a href="https://developer.apple.com/videos/swiftui-ui-frameworks" target="_blank" rel="noopener noreferrer" class="footer__link-item">SwiftUI &amp; UI Frameworks Videos</a></li><li class="footer__item"><a href="https://docs.swift.org/swift-book/documentation/the-swift-programming-language/" target="_blank" rel="noopener noreferrer" class="footer__link-item">The Swift Programming Language</a></li></ul></div><div class="col footer__col"><div class="footer__title">参考</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.fatbobman.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Fatbob Man</a></li><li class="footer__item"><a href="https://designcode.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Design Code</a></li><li class="footer__item"><a href="https://www.swiftanytime.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Swift Anytime</a></li><li class="footer__item"><a href="https://www.hackingwithswift.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Hacking With Swift</a></li></ul></div><div class="col footer__col"><div class="footer__title">探索</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.youtube.com/@Kavsoft" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kavsoft</a></li><li class="footer__item"><a href="https://www.youtube.com/@ChaoCode" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chao Code</a></li><li class="footer__item"><a href="https://www.youtube.com/@iOSAcademy" target="_blank" rel="noopener noreferrer" class="footer__link-item">iOS Academy</a></li><li class="footer__item"><a href="https://www.youtube.com/@XCA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Xcoding with Alfian</a></li></ul></div><div class="col footer__col"><div class="footer__title">发现</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/swift-tutorials-cn/sponsor-me">Sponsor Me</a></li><li class="footer__item"><a class="footer__link-item" href="/swift-tutorials-cn/sponsor-list">Sponsor List</a></li><li class="footer__item"><a href="https://twitter.com/ajizhhans" target="_blank" rel="noopener noreferrer" class="footer__link-item">Follow Twitter</a></li><li class="footer__item"><a href="https://github.com/zhuanghongji" target="_blank" rel="noopener noreferrer" class="footer__link-item">Follow GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 ZHUANGHONGJI<br><a style="font-size: 12px;color: white;" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0) License</a></div></div></div></footer></div>
<script src="/swift-tutorials-cn/assets/js/runtime~main.e8a3ce7b.js"></script>
<script src="/swift-tutorials-cn/assets/js/main.521b0f3d.js"></script>
</body>
</html>