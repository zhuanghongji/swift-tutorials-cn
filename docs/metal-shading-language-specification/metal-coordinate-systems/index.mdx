# Metal 坐标系

<ToBePolishedAfterTranslation />

<OriginalPDF title="1.6 Metal Coordinate Systems" />

Metal 定义了几个标准坐标系来表示渲染管道中不同阶段的转换后的图形数据。

四维齐次向量 `(x, y, z, w)` 指定 _clip-space coordinates_ 中的一个三维点。顶点着色器生成剪辑空间坐标中的位置。Metal 将 `x`、`y` 和 `z` 值除以 `w`，将剪辑空间坐标转换为 _标准化设备坐标_。

标准化设备坐标使用 _左手坐标系_（参见图 1）并映射到视口中的位置。这些坐标与视口大小无关。视口的左下角位于 `(x, y)` 坐标 `(-1.0 , -1.0)`，右上角位于 `(1.0, 1.0)`。正 `z` 值指向远离相机的方向（“进入屏幕”）。`z` 坐标的可见部分介于 `0.0` 和 `1.0` 之间。Metal 渲染管道将图元剪辑到此框。

<Figure
  src={require("./figure_1.png")}
  num="1"
  desc="标准化设备坐标系"
  size={320}
  edge="white"
/>

光栅化阶段将标准化设备坐标 (NDC) 转换为 _视口坐标_（参见图 2）。该空间中的 `(x, y)` 坐标以像素为单位进行测量，原点位于视口的左上角，正值向右和向下。你在此坐标空间中指定视口，Metal 将 NDC 坐标映射到视口的范围。

如果你使用可变光栅化率（请参阅第 6.15 节），则视口坐标系是独立于渲染目标的物理布局的逻辑坐标系。速率图确定该逻辑坐标系（有时称为屏幕空间）中的坐标与渲染目标中的像素（物理坐标）之间的关系。

<Figure
  src={require("./figure_2.png")}
  num="2"
  desc="视口坐标系"
  size={320}
  edge="white"
/>

*纹理坐标*使用与视口坐标类似的坐标系。纹理坐标也可以使用 _标准化纹理坐标_ 来指定。对于 2D 纹理，归一化纹理坐标在 `x` 和 `y` 方向上都是从 `0.0` 到 `1.0` 的值，如图 3 所示。值 `(0.0, 0.0)` 指定图像数据第一个字节（左上角）的像素。图像的一角）。值 `(1.0, 1.0)` 指定图像数据最后一个字节的像素（图像的右下角）。

<Figure
  src={require("./figure_3.png")}
  num="3"
  desc="标准化 2D 纹理坐标系"
  size={320}
  edge="white"
/>
