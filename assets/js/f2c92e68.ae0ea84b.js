(self.webpackChunkswift_tutorials_cn=self.webpackChunkswift_tutorials_cn||[]).push([[8426],{76434:(e,n,i)=>{e.exports={src:{srcSet:i.p+"assets/ideal-img/hero.42571b5.1470.png 1470w",images:[{path:i.p+"assets/ideal-img/hero.42571b5.1470.png",width:1470,height:480}],src:i.p+"assets/ideal-img/hero.42571b5.1470.png",toString:function(){return i.p+"assets/ideal-img/hero.42571b5.1470.png"},placeholder:void 0,width:1470,height:480},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAADCAYAAACqPZ51AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhklEQVR4nAF7AIT/AFsgRvxpIUv/dyRR/4IkVP+UM2P/xHOh/4InV/98J1b/aCNN/1ggRvoAXSFI/2ogS/+HKVz/jihb/4wjU/+xNnP/iSZZ/4cqXP90J1T/WSBF/wBcIUb8ZiBJ/40vY/+TLmL/iyZY/6Y1b/+XL2b/gSdZ/3MoVv9XH0X6Ph87tiUPECAAAAAASUVORK5CYII="}},98019:(e,n,i)=>{e.exports={src:{srcSet:i.p+"assets/ideal-img/image_1.72d4ac2.1179.png 1179w",images:[{path:i.p+"assets/ideal-img/image_1.72d4ac2.1179.png",width:1179,height:2556}],src:i.p+"assets/ideal-img/image_1.72d4ac2.1179.png",toString:function(){return i.p+"assets/ideal-img/image_1.72d4ac2.1179.png"},placeholder:void 0,width:1179,height:2556},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAWCAYAAAD5Jg1dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAArklEQVR4nN2TsQrCMBRF85l+hLh3EvwDP8CvcCvoH7hJtw6FJjqWoBRrco+kEHQQ6uAgXniBdzkvecONAVaAALz326qqZkVRbJxzO55aGuCau77vD977dVmW+67rjtmXZI2kwIQkBZOfzQZwCyHcY4zxlU3gRzJ/DQ7DMNYk2DQNbdtOg5K+vOOPgvqA0xjcifDGHNxLnnp303ikrwAsgFMynHOq65pU1to8eAbmD/8mYUdWIgJlAAAAAElFTkSuQmCC"}},17498:(e,n,i)=>{e.exports={src:{srcSet:i.p+"assets/ideal-img/image_2.0244125.1179.png 1179w",images:[{path:i.p+"assets/ideal-img/image_2.0244125.1179.png",width:1179,height:2556}],src:i.p+"assets/ideal-img/image_2.0244125.1179.png",toString:function(){return i.p+"assets/ideal-img/image_2.0244125.1179.png"},placeholder:void 0,width:1179,height:2556},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAWCAYAAAD5Jg1dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAnUlEQVR4nN2TzQkCMRBG3yU/pIOQxixCbEGwAwuwij1rB95sQWxAD+KakQm7MAd1PYl4+Ai8vEwIfAFYARUQoANmwAbYDkyzBLgYsAfWwA44GH5UsTfgVXrMtSO4Ajfgbrg6k9NkyB+Lzjnx3k+LpRTJOf/0Y/iqWD+QWs20g+/Kq71sxT2bU88m6dq+wgI4KQgh1JSSaGKMo6R78wf8u9blW3KUHAAAAABJRU5ErkJggg=="}},67244:(e,n,i)=>{e.exports={src:{srcSet:i.p+"assets/ideal-img/image_3.83e4f0a.1179.png 1179w",images:[{path:i.p+"assets/ideal-img/image_3.83e4f0a.1179.png",width:1179,height:2556}],src:i.p+"assets/ideal-img/image_3.83e4f0a.1179.png",toString:function(){return i.p+"assets/ideal-img/image_3.83e4f0a.1179.png"},placeholder:void 0,width:1179,height:2556},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAWCAYAAAD5Jg1dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABwElEQVR4nH1TSY7bMBDkM+cRwdx9CpAf5AHzipx8mJwN76vk3YZh0btFeRFgmWINqm06OQQR0CDZXV3VbLYUgB8AHACcTqdfQRC8FQqFD631J/583xWAqz+laVozxvwsFou/jTFd73fORQRa/OdzziHPc6uSJHHGGMrCGGONMbc4ju/GmDyOY9xuN8GrbreLdruNRqOB4XAoK32tVktssVjger1ChWEIDw6CAPV6Hb1eT6z9JJjP51Dc9Pt9YSPDaDQSAAm4MkGADBJI63Q6LyABPGuteRkon00gg0xkCfQReDgc5PYvRjJRniAmDwYD8bEbaZpCMcDLsNbJZCKgSqUi7P2nyn6/h/K1EEBgs9kUWSZ6td1u9wAySGYvy/N4PMblcsHxeESSJI8+sndknc1mUhsTSHA+n1/PKIwe6PtZq9VePQ3DkE8LxcIJYkK1WhUApafTKZbLpYA3mw0U35IbNpYBf7b2MVSUFentdosoirBer8H9arWSPRNZs6+TDXessVwuyyVKpZLU7KeHNWqtneJQPk3e9H6/y5plmchnWZZbay0n/OKH+V8D/vev8A5gRQcl+Dq0KIp8ImPfvgDxrCGbLg1CUQAAAABJRU5ErkJggg=="}},54259:(e,n,i)=>{e.exports={src:{srcSet:i.p+"assets/ideal-img/image_4.abf099d.1179.png 1179w",images:[{path:i.p+"assets/ideal-img/image_4.abf099d.1179.png",width:1179,height:2556}],src:i.p+"assets/ideal-img/image_4.abf099d.1179.png",toString:function(){return i.p+"assets/ideal-img/image_4.abf099d.1179.png"},placeholder:void 0,width:1179,height:2556},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAWCAYAAAD5Jg1dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuElEQVR4nN2TQQrCMBBFc0wPIe67EryBB/AU7gp6A3dScFF3jQtBSlCqNPlPUgi6kJqlOJDA/LyZCeHHAAtAAM65dVVVk6IoVtbaDa+YG+CWsq7rds65ZVmW27Zt90mX1BhJni8hyZs0NgnAw3vfhxDCOxvBrDB/C0pw99D1EDQC9gEOZzhe4mMyPjp2Ve4dlQvye6AyOA3G/WLekIx7TVWfOg1b/ArADDhFwVqruq6Jq2maVBjPpk9T6WF4KJAnrAAAAABJRU5ErkJggg=="}},87586:(e,n,i)=>{e.exports={src:{srcSet:i.p+"assets/ideal-img/image_5.da52e46.1179.png 1179w",images:[{path:i.p+"assets/ideal-img/image_5.da52e46.1179.png",width:1179,height:2556}],src:i.p+"assets/ideal-img/image_5.da52e46.1179.png",toString:function(){return i.p+"assets/ideal-img/image_5.da52e46.1179.png"},placeholder:void 0,width:1179,height:2556},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAWCAYAAAD5Jg1dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABnUlEQVR4nLVSS47TQBCtbLJJllGPv3ESO3bHwyiTOI7ib0xikIZ1FhwCcQUkbsABOAVr5gbsuMKIC8ACkfFDXZNkBomRZgGLJ3W9elWvq7qJiN53Op2m3W6DiD4R0Wsi+khEn1utFnq9Hrrd7juyLOtHURSI4xhpmn7Z7XYfqqq6TpLk62w2R13XcF33hqQM91EUYz5fYLFY/oEoiqHEvi/3pGlGI4SGszMdQmh7IbSfQmi/hNBuj7yumw1ZVh9PAf17oWnaMAzrUVhHoeuOEYbnkDLEZHLOCIIJx2H4DP3+AKoZzWYRqmqDNM0ZSZIhy4oTxuOAxSzcbGrkeYH1+jmKYo08L5lbLle4uJhCuZJa6tXVK2y3L1DXLw+osd3WLFaFnje+t1ZElpV8Lkt1LthBdWXr6fTyZFeWFd9TCdM0w2qVMq8GJM/zeUoVqEl9X0LKCYJAnnjHGYIMw1ZvyTju7mGs6+bdev7LWzdPEPI32x/wmOhW5cm2ne+27XDV3zrd5ZwbMs3+W9O0v6nEYDBqRiMPCsOhy4WH3JvfS4E08UlbhSEAAAAASUVORK5CYII="}},34365:(e,n,i)=>{e.exports={src:{srcSet:i.p+"assets/ideal-img/image_6.37b306f.1179.png 1179w",images:[{path:i.p+"assets/ideal-img/image_6.37b306f.1179.png",width:1179,height:2556}],src:i.p+"assets/ideal-img/image_6.37b306f.1179.png",toString:function(){return i.p+"assets/ideal-img/image_6.37b306f.1179.png"},placeholder:void 0,width:1179,height:2556},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAWCAYAAAD5Jg1dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA30lEQVR4nM2Tz2oCMRCH85g+RPG+J6Fv0AfoU/S2oG8g9SBbLaweJPFSYYkbt7LJfBIlqK1/2ps/mJBMvpmByUQBz4AAWGvfiqLoZFn2aozpc1RPAS6dmqYZWmtf8jwfVFU1Tn4R0UpEPHckIl6lsskBbL33bQghnLIR/JPUg4ByYrdBOaKH/RVwtYGvDawaqL6vZIxtm8wWvH/MGU0XfM41vm1/g7GUq9e4tcW5GufcWflH6eMt/Qu89BA/JfvBvTO8IQ1unaIuZdov8SsAXWAZHcYYKcuSaFrrFBjvnnbK019ccSvrrwAAAABJRU5ErkJggg=="}},28218:(e,n,i)=>{e.exports={src:{srcSet:i.p+"assets/ideal-img/image_7.425575e.1179.png 1179w",images:[{path:i.p+"assets/ideal-img/image_7.425575e.1179.png",width:1179,height:2556}],src:i.p+"assets/ideal-img/image_7.425575e.1179.png",toString:function(){return i.p+"assets/ideal-img/image_7.425575e.1179.png"},placeholder:void 0,width:1179,height:2556},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAWCAYAAAD5Jg1dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVR4nNWTwWoCMRCG85h9iOJ9T0LfoA/gU3hbqG8g7aEseojQLhsVKl2iaxCT+SQuYT246rH94Q+T4ZsZCBMFvAACYK0dF0XxlGXZyBjzRqehApp0c85NrbWveZ5P6rr+THkRqZSIeO5IRLxKY1MCOHjvjyGEcMlG8CGpPwLKhW+D0qFt3AP+7FtvHPy6no7x2eaLko/ZF++zb3S5vg7GUc1u27rZ4ty+f/QtqX8CygOcnBf3zvKGtLi7VHWt0/mIXwEYAMuYMMaI1proqqpS4Qp4PgH6n197bPi1twAAAABJRU5ErkJggg=="}},53531:(e,n,i)=>{"use strict";i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>m,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var t=i(85893),a=i(11151);const s={},r="\u73af\u5883\u503c",l={id:"swiftui/data-and-storage/environment-values/index",title:"\u73af\u5883\u503c",description:"<OriginalSource",source:"@site/docs/swiftui/data-and-storage/environment-values/index.mdx",sourceDirName:"swiftui/data-and-storage/environment-values",slug:"/swiftui/data-and-storage/environment-values/",permalink:"/swift-tutorials-cn/docs/swiftui/data-and-storage/environment-values/",draft:!1,unlisted:!1,editUrl:"https://github.com/zhuanghongji/swift-tutorials-cn/docs/swiftui/data-and-storage/environment-values/index.mdx",tags:[],version:"current",lastUpdatedAt:1698830538,formattedLastUpdatedAt:"2023\u5e7411\u67081\u65e5",frontMatter:{},sidebar:"swiftuiSidebar",previous:{title:"\u54cd\u5e94\u6570\u636e\u53d8\u5316",permalink:"/swift-tutorials-cn/docs/swiftui/data-and-storage/responding-to-data-changes/"},next:{title:"Text",permalink:"/swift-tutorials-cn/docs/swiftui/views/text/"}},o={},c=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u83b7\u53d6\u73af\u5883\u503c",id:"\u83b7\u53d6\u73af\u5883\u503c",level:2},{value:"Environment",id:"environment",level:3},{value:"EnvironmentValues",id:"environmentvalues",level:3},{value:"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u73af\u5883\u503c",id:"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u73af\u5883\u503c",level:2},{value:"EnvironmentKey",id:"environmentkey",level:3},{value:"\u4fee\u6539\u73af\u5883",id:"\u4fee\u6539\u73af\u5883",level:2},{value:"environment(<em>:</em>:)",id:"environment-1",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,a.a)(),...e.components},{OriginalSource:s,Screenshot:r,ScreenshotBlock:l}=n;return s||A("OriginalSource",!0),r||A("Screenshot",!0),l||A("ScreenshotBlock",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"\u73af\u5883\u503c",children:"\u73af\u5883\u503c"}),"\n",(0,t.jsx)(s,{title:"Environment values",url:"https://developer.apple.com/documentation/swiftui/environment-values",summary:"\u4f7f\u7528\u73af\u5883\u5728\u6574\u4e2a\u89c6\u56fe\u5c42\u6b21\u7ed3\u6784\u4e2d\u5171\u4eab\u6570\u636e"}),"\n",(0,t.jsx)(n.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,t.jsxs)(n.p,{children:["SwiftUI \u4e2d\u7684\u89c6\u56fe\u53ef\u4ee5\u4f7f\u7528 ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftui/environment",children:"Environment"}),' \u5c5e\u6027\u5305\u88c5\u5668\u5bf9 "\u4ece\u73af\u5883\u4e2d\u8bfb\u53d6\u7684\u914d\u7f6e\u4fe1\u606f" \u505a\u51fa\u53cd\u5e94\u3002']}),"\n",(0,t.jsx)(r,{src:i(76434),size:720}),"\n",(0,t.jsxs)(n.p,{children:["\u89c6\u56fe\u4ece\u5176\u5bb9\u5668\u89c6\u56fe\u7ee7\u627f\u5176\u73af\u5883\uff0c\u53d7\u5230 ",(0,t.jsxs)(n.a,{href:"https://developer.apple.com/documentation/swiftui/view/environment(_:_:)",children:["environment(",(0,t.jsx)(n.em,{children:":"}),":)"]}),' \u89c6\u56fe\u4fee\u9970\u5668\u7684\u663e\u5f0f\u66f4\u6539\uff08\u6216\u6765\u81ea "\u5176\u5b83\u5bf9\u73af\u5883\u503c\u8fdb\u884c\u64cd\u4f5c\u7684\u4fee\u9970\u5668\u4e4b\u4e00" \u7684\u9690\u5f0f\u66f4\u6539\uff09\u7684\u5f71\u54cd\u3002\u56e0\u6b64\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 "\u7ec4\u7684\u5bb9\u5668\uff08group\'s container\uff09" \u7684\u73af\u5883\u6765\u914d\u7f6e\u6574\u4e2a\u89c6\u56fe\u5c42\u6b21\u7ed3\u6784\u3002']}),"\n",(0,t.jsxs)(n.p,{children:["\u4f60\u53ef\u4ee5\u5728 ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftui/environmentvalues",children:"EnvironmentValues"})," \u7ed3\u6784\u4f53\u4e2d\u627e\u5230\u8bb8\u591a\u5185\u7f6e\u73af\u5883\u503c\u3002\u4f60\u8fd8\u53ef\u4ee5\u4f7f\u7528 ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftui/environmentkey",children:"EnvironmentKey"})," \u534f\u8bae\u521b\u5efa\u81ea\u5b9a\u4e49\u503c\u3002"]}),"\n",(0,t.jsx)(n.h2,{id:"\u83b7\u53d6\u73af\u5883\u503c",children:"\u83b7\u53d6\u73af\u5883\u503c"}),"\n",(0,t.jsx)(n.h3,{id:"environment",children:"Environment"}),"\n",(0,t.jsx)(n.p,{children:"\u4ece\u89c6\u56fe\u73af\u5883\u8bfb\u53d6\u503c\u7684\u5c5e\u6027\u5305\u88c5\u5668\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"@available(iOS 13.0, macOS 10.15, tvOS 13.0, watchOS 6.0, *)\n@frozen @propertyWrapper public struct Environment<Value> : DynamicProperty {\n    // 1\ufe0f\u20e3 \u521b\u5efa\u73af\u5883\u5c5e\u6027\u4ee5\u8bfb\u53d6\u6307\u5b9a\u7684 key path \u7684\u503c\n    @inlinable public init(_ keyPath: KeyPath<EnvironmentValues, Value>)\n\n    // \u73af\u5883\u5c5e\u6027\u5f53\u524d\u7684\u503c\n    @inlinable public var wrappedValue: Value { get }\n}\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"extension Environment {\n    // 2\ufe0f\u20e3 \u521b\u5efa\u4e00\u4e2a\u73af\u5883\u5c5e\u6027\u4ee5\u4ece\u73af\u5883\u4e2d\u8bfb\u53d6\u53ef\u89c2\u5bdf\u5bf9\u8c61\n    @available(iOS 17.0, macOS 14.0, tvOS 17.0, watchOS 10.0, *)\n    public init(_ objectType: Value.Type)\n            where Value : AnyObject, Value : Observable\n\n    // 3\ufe0f\u20e3 \u521b\u5efa\u4e00\u4e2a\u73af\u5883\u5c5e\u6027\u4ee5\u4ece\u73af\u5883\u4e2d\u8bfb\u53d6\u53ef\u89c2\u5bdf\u5bf9\u8c61\uff0c\u5982\u679c\u5f53\u524d\u89c6\u56fe\u7684\u73af\u5883\u4e2d\u6ca1\u6709\u8bbe\u7f6e\u76f8\u5e94\u7684\u5bf9\u8c61\uff0c\u5219\u8fd4\u56de nil\n    @available(iOS 17.0, macOS 14.0, tvOS 17.0, watchOS 10.0, *)\n    public init<T>(_ objectType: T.Type)\n            where Value == T?, T : AnyObject, T : Observable\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"Environment"}),' \u5c5e\u6027\u5305\u88c5\u5668\u6765\u8bfb\u53d6 "\u5b58\u50a8\u5728\u89c6\u56fe\u73af\u5883" \u4e2d\u7684\u503c\u3002\u4f7f\u7528\u5c5e\u6027\u58f0\u660e\u4e2d\u7684 ',(0,t.jsx)(n.code,{children:"EnvironmentValues"}),' key path \u6307\u793a\u8981\u8bfb\u53d6\u7684\u503c\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a "\u4f7f\u7528 ',(0,t.jsx)(n.code,{children:"colorScheme"}),' \u5c5e\u6027\u7684 key path \u8bfb\u53d6\u5f53\u524d\u89c6\u56fe\u7684\u914d\u8272\u65b9\u6848\uff08color scheme\uff09" \u7684\u5c5e\u6027\uff1a']}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"@Environment(\\.colorScheme) var colorScheme: ColorScheme\n"})}),"\n",(0,t.jsxs)(n.p,{children:['\u7136\u540e\uff0c\u6839\u636e "\u4ece\u58f0\u660e\u7684\u5c5e\u6027\u7684 ',(0,t.jsx)(n.code,{children:"wrappedValue"}),' \u4e2d\u8bfb\u53d6\u7684\u5173\u8054\u503c" \u6765\u8c03\u6574\u89c6\u56fe\u7684\u5185\u5bb9\u3002\u4e0e\u4efb\u4f55\u5c5e\u6027\u5305\u88c5\u5668\u4e00\u6837\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u5f15\u7528\u5c5e\u6027\u6765\u8bbf\u95ee\u5305\u88c5\u7684\u503c\uff1a']}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:'if colorScheme == .light { // Checks the wrapped value.\n    Text("light")\n} else {\n    Text("dark")\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u5b8c\u6574\u793a\u4f8b\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(l,{src:i(98019),srcRight:i(17498),children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:'struct ContentView: View {\n    @Environment(\\.colorScheme) var colorScheme: ColorScheme\n\n    var body: some View {\n        VStack {\n            if colorScheme == .light {\n                Text("light")\n            } else {\n                Text("dark")\n            }\n        }\n        .font(.title)\n    }\n}\n'})})}),"\n",(0,t.jsxs)(n.p,{children:["\u5982\u679c\u503c\u53d1\u751f\u53d8\u5316\uff0cSwiftUI \u4f1a\u66f4\u65b0\u89c6\u56fe\u4e2d\u4f9d\u8d56\u4e8e\u8be5\u503c\u7684\u4efb\u4f55\u90e8\u5206\u3002\u4f8b\u5982\uff0c\u5982\u679c\u7528\u6237\u66f4\u6539\u5916\u89c2\u8bbe\u7f6e\uff08Appearance settings\uff09\u4e3a ",(0,t.jsx)(n.code,{children:".light"})," \u65f6\uff0c\u89c6\u56fe\u663e\u793a\u5982\u4e0a\u5de6\u56fe\uff0c\u4e3a ",(0,t.jsx)(n.code,{children:".dark"})," \u65f6\u5219\u5982\u4e0a\u53f3\u56fe\u3002"]}),"\n",(0,t.jsxs)(n.p,{children:["\u4f60\u53ef\u4ee5\u4f7f\u7528\u6b64\u5c5e\u6027\u5305\u88c5\u5668\u6765\u8bfb\u53d6\uff08\u4f46\u4e0d\u80fd\u8bbe\u7f6e\uff09\u73af\u5883\u503c\u3002SwiftUI \u6839\u636e\u7cfb\u7edf\u8bbe\u7f6e\u81ea\u52a8\u66f4\u65b0\u4e00\u4e9b\u73af\u5883\u503c\uff0c\u5e76\u4e3a\u5176\u5b83\u73af\u5883\u503c\u63d0\u4f9b\u5408\u7406\u7684\u9ed8\u8ba4\u503c\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"environment(_:_:)"}),' \u89c6\u56fe\u4fee\u9970\u5668\u8986\u76d6\u5176\u4e2d\u4e00\u4e9b\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4f60\u5b9a\u4e49\u7684 "\u81ea\u5b9a\u4e49\u73af\u5883\u503c"\u3002']}),"\n",(0,t.jsxs)(n.p,{children:["\u6709\u5173 SwiftUI \u63d0\u4f9b\u7684\u73af\u5883\u503c\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 ",(0,t.jsx)(n.code,{children:"EnvironmentValues"}),' \u7ed3\u6784\u4f53\u7684\u5c5e\u6027\u3002\u6709\u5173\u521b\u5efa "\u81ea\u5b9a\u4e49\u73af\u5883\u503c" \u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 ',(0,t.jsx)(n.code,{children:"EnvironmentKey"})," \u534f\u8bae\u3002"]}),"\n",(0,t.jsx)(n.h3,{id:"environmentvalues",children:"EnvironmentValues"}),"\n",(0,t.jsx)(n.p,{children:"\u901a\u8fc7\u89c6\u56fe\u5c42\u6b21\u7ed3\u6784\u4f20\u64ad\u7684\u73af\u5883\u503c\u7684\u96c6\u5408\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"@available(iOS 13.0, macOS 10.15, tvOS 13.0, watchOS 6.0, *)\npublic struct EnvironmentValues : CustomStringConvertible {\n    // ...\n\n    public init()\n\n    public subscript<K>(key: K.Type) -> K.Value where K : EnvironmentKey\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5176\u90e8\u5206\u73af\u5883\u503c\u5c5e\u6027\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:'@available(iOS 15.0, macOS 12.0, tvOS 15.0, watchOS 8.0, *)\nextension EnvironmentValues {\n    // \u53d6\u6d88\u5f53\u524d presentation \u7684\u64cd\u4f5c\uff08action\uff09\n    public var dismiss: DismissAction { get }\n\n    // \u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u6307\u793a\u4e0e\u6b64\u73af\u5883\u5173\u8054\u7684\u89c6\u56fe\u5f53\u524d\u662f\u5426 presented\n    public var isPresented: Bool { get }\n}\n\n@available(iOS 13.0, macOS 10.15, tvOS 13.0, watchOS 6.0, *)\nextension EnvironmentValues {\n    // \u4e00\u4e2a\u73af\u5883\u503c\uff0c\u6307\u793a\u5f53 "\u5185\u5bb9\u6362\u884c" \u6216 "\u5305\u542b\u6362\u884c\u7b26" \u65f6\u6587\u672c\u89c6\u56fe\u5982\u4f55\u5bf9\u9f50\u5176\u884c\n    public var multilineTextAlignment: TextAlignment\n\n    // \u6307\u793a\u5e03\u5c40\u5982\u4f55\u622a\u65ad\u6700\u540e\u4e00\u884c\u6587\u672c\u4ee5\u9002\u5e94\u53ef\u7528\u7a7a\u95f4\u7684\u503c\n    public var truncationMode: Text.TruncationMode\n\n    // \u4e00\u4e2a\u7ebf\u6bb5\uff08line fragment\uff09\u5e95\u90e8\u4e0e\u4e0b\u4e00\u4e2a\u7ebf\u6bb5\u9876\u90e8\u4e4b\u95f4\u7684\u8ddd\u79bb\uff08\u5355\u4f4d point\uff09\n    public var lineSpacing: CGFloat\n\n    // \u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u6307\u793a\u662f\u5426\u5e94\u6536\u7d27\u5b57\u7b26\u95f4\u8ddd\u4ee5\u4f7f\u6587\u672c\u9002\u5e94\u53ef\u7528\u7a7a\u95f4\n    public var allowsTightening: Bool\n\n    // \u7f29\u5c0f\u5b57\u4f53\u5927\u5c0f\u4ee5\u4f7f\u6587\u672c\u9002\u5e94\u53ef\u7528\u7a7a\u95f4\u7684\u6700\u5c0f\u5141\u8bb8\u6bd4\u4f8b\n    public var minimumScaleFactor: CGFloat\n\n    // \u4f7f\u7528\u73af\u5883\u7684\u533a\u57df\u8bbe\u7f6e\uff08environment\u2019s locale\uff09\u5728\u663e\u793a\u65f6\u8f6c\u6362 Text \u5927\u5c0f\u5199\u7684\u6837\u5f0f\u8986\u76d6\n    @available(iOS 14.0, macOS 11.0, tvOS 14.0, watchOS 7.0, *)\n    public var textCase: Text.Case?\n}\n\n// ...\n'})}),"\n",(0,t.jsxs)(n.p,{children:["SwiftUI \u4ee5 ",(0,t.jsx)(n.code,{children:"EnvironmentValues"})," \u7ed3\u6784\u4f53\u5411\u5e94\u7528\u7a0b\u5e8f\u7684\u89c6\u56fe\u66b4\u9732\u4e00\u7ec4\u503c\u3002\u8981\u4ece\u8be5\u7ed3\u6784\u4f53\u4e2d\u8bfb\u53d6\u503c\uff0c\u53ef\u4f7f\u7528 ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftui/environment",children:"Environment"})," \u5c5e\u6027\u5305\u88c5\u5668\u58f0\u660e\u5c5e\u6027\u5e76\u6307\u5b9a\u8be5\u503c\u7684\u952e\u8def\u5f84\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u8bfb\u53d6\u5f53\u524d\u533a\u57df\u8bbe\u7f6e\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"@Environment(\\.locale) var locale: Locale\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528\u4f60\u58f0\u660e\u7684\u5c5e\u6027\u6765\u52a8\u6001\u63a7\u5236\u89c6\u56fe\u7684\u5e03\u5c40\u3002SwiftUI \u6839\u636e\u8bbe\u5907\u7279\u5f81\u3001\u7cfb\u7edf\u72b6\u6001\u6216\u7528\u6237\u8bbe\u7f6e\u81ea\u52a8\u8bbe\u7f6e\u6216\u66f4\u65b0\u8bb8\u591a\u73af\u5883\u503c\uff0c\u4f8b\u5982 ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftui/environmentvalues/pixellength",children:"pixelLength"}),"\u3001",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftui/environmentvalues/scenephase",children:"scenePhase"})," \u6216 ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftui/environmentvalues/locale",children:"locale"}),"\u3002\u5bf9\u4e8e\u5176\u5b83\u7684\uff0c\u6bd4\u5982 ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftui/environmentvalues/linelimit",children:"lineLimit"}),"\uff0cSwiftUI \u63d0\u4f9b\u4e86\u4e00\u4e2a\u5408\u7406\u7684\u9ed8\u8ba4\u503c\u3002"]}),"\n",(0,t.jsxs)(n.p,{children:["\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,t.jsxs)(n.a,{href:"https://developer.apple.com/documentation/swiftui/view/environment(_:_:)",children:["environment(",(0,t.jsx)(n.em,{children:":"}),":)"]})," \u89c6\u56fe\u4fee\u9970\u5668\u8bbe\u7f6e\u6216\u8986\u76d6\u67d0\u4e9b\u503c\uff1a"]}),"\n",(0,t.jsx)(l,{src:i(67244),children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:'struct ContentView: View {\n\n    let text = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."\n\n    var body: some View {\n        VStack {\n            Text(text)\n\n            Divider()\n\n            Text(text)\n                // highlight-next-line\n                .environment(\\.lineLimit, 2)\n        }\n        .font(.title)\n    }\n}\n'})})}),"\n",(0,t.jsx)(n.p,{children:"\u4f60\u8bbe\u7f6e\u7684\u503c\u4f1a\u5f71\u54cd\u4f60\u4fee\u6539\u7684\u89c6\u56fe\u7684\u73af\u5883\uff08\u5305\u62ec\u89c6\u56fe\u5c42\u6b21\u7ed3\u6784\u4e2d\u7684\u5b50\u89c6\u56fe\uff09\uff0c\u4f46\u4ec5\u9650\u4e8e\u4f60\u5e94\u7528\u4e0d\u540c\u7684\u73af\u5883\u4fee\u9970\u5668\u3002"}),"\n",(0,t.jsxs)(n.p,{children:["SwiftUI \u63d0\u4f9b\u4e86\u4e13\u7528\u7684\u89c6\u56fe\u4fee\u9970\u5668\u6765\u8bbe\u7f6e\u67d0\u4e9b\u503c\uff0c\u8fd9\u901a\u5e38\u4f1a\u4f7f\u4f60\u7684\u4ee3\u7801\u66f4\u6613\u4e8e\u9605\u8bfb\u3002\u4f8b\u5982\uff0c\u4f60\u4e0d\u5e94\u50cf\u524d\u9762\u7684\u793a\u4f8b\u90a3\u6837\u76f4\u63a5\u8bbe\u7f6e ",(0,t.jsx)(n.code,{children:"lineLimit"})," \u503c\uff0c\u800c\u5e94\u4f7f\u7528 ",(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftui/view/linelimit(_:)-513mb",children:"lineLimit(_:)"})," \u4fee\u9970\u5668\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"Text(text)\n    // highlight-next-line\n    .lineLimit(2)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u4e13\u7528\u7684\uff08dedicated\uff09\u89c6\u56fe\u4fee\u9970\u5668\u6765\u63d0\u4f9b\u9644\u52a0\u529f\u80fd\u3002\u4f8b\u5982\uff0c\u4f60\u5fc5\u987b\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"preferredColorScheme(\\_:)"})," \u4fee\u9970\u5668\u800c\u4e0d\u662f\u76f4\u63a5\u8bbe\u7f6e ",(0,t.jsx)(n.code,{children:"colorScheme"}),"\uff0c\u4ee5\u786e\u4fdd\u5728 presenting popover \u7b49\u89c6\u56fe\u65f6\uff0c\u65b0\u503c\u80fd\u591f\u4f20\u64ad\u5230 presenting \u5bb9\u5668\uff1a"]}),"\n",(0,t.jsx)(l,{src:i(54259),srcRight:i(87586),children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:'struct ContentView: View {\n    @State private var isPresented = false\n\n    let text = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."\n\n    var body: some View {\n        Button("Tap Me") {\n            isPresented = true\n        }\n        .font(.title)\n        .popover(\n            isPresented: $isPresented,\n            arrowEdge: .top,\n            content: {\n                Text(text)\n                    .padding()\n                    // highlight-next-line\n                    .preferredColorScheme(.dark)\n            }\n        )\n    }\n}\n'})})}),"\n",(0,t.jsx)(n.h2,{id:"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u73af\u5883\u503c",children:"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u73af\u5883\u503c"}),"\n",(0,t.jsx)(n.h3,{id:"environmentkey",children:"EnvironmentKey"}),"\n",(0,t.jsx)(n.p,{children:"\u8bbf\u95ee\u73af\u5883\u4e2d\u7684\u503c\u7684 key \u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"@available(iOS 13.0, macOS 10.15, tvOS 13.0, watchOS 6.0, *)\npublic protocol EnvironmentKey {\n\n    // \u8868\u793a\u73af\u5883 key \u503c\u7c7b\u578b\u7684\u5173\u8054\u7c7b\u578b\n    associatedtype Value\n\n    // \u73af\u5883\u952e\u7684\u9ed8\u8ba4\u503c\n    static var defaultValue: Self.Value { get }\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u8981\u60f3\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u73af\u5883\u503c\uff0c\u9996\u5148\u58f0\u660e\u4e00\u4e2a\u65b0\u7684\u73af\u5883 key \u7c7b\u578b\u5e76\u4e3a\u6240\u9700\u7684 ",(0,t.jsx)(n.code,{children:"defaultValue"})," \u5c5e\u6027\u6307\u5b9a\u4e00\u4e2a\u503c\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"private struct MyCountKey: EnvironmentKey {\n    static let defaultValue: Int = 0\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:['Swift \u7f16\u8bd1\u5668\u4f1a\u81ea\u52a8\u5c06 "\u5173\u8054\u7684 ',(0,t.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftui/environmentkey/value",children:"Value"})," \u7c7b\u578b\uff08",(0,t.jsx)(n.code,{children:"associatedtype Value"}),'\uff09" \u63a8\u65ad\u4e3a\u4f60\u4e3a "\u9ed8\u8ba4\u503c\uff08',(0,t.jsx)(n.code,{children:"defaultValue"}),'\uff09" \u6307\u5b9a\u7684\u7c7b\u578b\u3002']}),"\n",(0,t.jsxs)(n.p,{children:["\u7136\u540e\uff0c\u6269\u5c55 ",(0,t.jsx)(n.code,{children:"EnvironmentValues"}),' \u7ed3\u6784\u4f53\uff0c\u4f7f\u7528 key \u5b9a\u4e49\u4e00\u4e2a "\u65b0\u7684\u73af\u5883\u503c\u5c5e\u6027"\uff1a']}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"extension EnvironmentValues {\n    var myCount: Int {\n        get { self[MyCountKey.self] }\n        set { self[MyCountKey.self] = newValue }\n    }\n}\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:'// 3. \u4f7f\u7528\u4f60\u7684 key \u6765\u83b7\u53d6\u548c\u8bbe\u7f6e\u503c\uff0c\u5e76\u63d0\u4f9b\u4e13\u7528\u4fee\u9970\u5668\u6765\u4f9b "\u4f7f\u7528\u7aef" \u5728\u8bbe\u7f6e\u503c\u65f6\u4f7f\u7528\nextension View {\n    func myCount(_ value: Int) -> some View {\n        environment(\\.myCount, value)\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:['\u7136\u540e\uff0c\u4f7f\u7528\u8be5\u8be5\u73af\u5883\u503c\u7684 "\u4f7f\u7528\u7aef" \u5c31\u53ef\u4ee5\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u6765\u8bbf\u95ee\u8be5\u503c\uff0c\u5373 "\u4f7f\u7528 ',(0,t.jsx)(n.code,{children:"Environment"})," \u5c5e\u6027\u5305\u88c5\u5668\u8bfb\u53d6\u5b83\uff0c\u5e76\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"myCount"}),' \u89c6\u56fe\u4fee\u9970\u5668\u8bbe\u7f6e\u5b83"\uff1a']}),"\n",(0,t.jsx)(l,{src:i(34365),srcRight:i(28218),children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:'struct MyCountView: View {\n    @Environment(\\.myCount) var myCount: Int\n\n    var body: some View {\n        Text("myCount is \\(myCount)")\n    }\n}\n\nstruct ContentView: View {\n    @State private var count = 0\n\n    var body: some View {\n        VStack {\n            Button("Plus Count") {\n                count += 1\n            }\n            MyCountView()\n        }\n        .font(.title)\n        .environment(\\.myCount, count)\n    }\n}\n'})})}),"\n",(0,t.jsx)(n.h2,{id:"\u4fee\u6539\u73af\u5883",children:"\u4fee\u6539\u73af\u5883"}),"\n",(0,t.jsxs)(n.h3,{id:"environment-1",children:["environment(",(0,t.jsx)(n.em,{children:":"}),":)"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"@available(iOS 13.0, macOS 10.15, tvOS 13.0, watchOS 6.0, *)\nextension View {\n    // - Parameters:\n    //   - keyPath: \u6307\u660e\u8981\u66f4\u65b0\u7684 EnvironmentValues \u7ed3\u6784\u4f53\u7684\u5c5e\u6027\u7684 key path\n    //   - value: \u8981\u7ed9 `keyPath` \u6307\u5b9a\u9879\u8bbe\u7f6e\u7684\u65b0\u503c\n    @inlinable public func environment<V>(\n            _ keyPath: WritableKeyPath<EnvironmentValues, V>,\n            _ value: V\n    ) -> some View\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528\u59ff\u52bf\u6b63\u5982\u4e0a\u8ff0\u793a\u4f8b\u4e2d\u7684 ",(0,t.jsx)(n.code,{children:".environment(\\.myCount, count)"})," \u6240\u793a\u3002"]}),"\n",(0,t.jsxs)(n.p,{children:["TODO \uff1a\u8865\u5145 ",(0,t.jsx)(n.code,{children:"environment<T>(T?)"})," \u548c ",(0,t.jsx)(n.code,{children:"transformenvironment(_:transform:)"})," \u7684\u4f7f\u7528\u3002"]})]})}function m(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}function A(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},11151:(e,n,i)=>{"use strict";i.d(n,{Z:()=>l,a:()=>r});var t=i(67294);const a={},s=t.createContext(a);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);