(self.webpackChunkswift_tutorials_cn=self.webpackChunkswift_tutorials_cn||[]).push([[3491],{53849:(e,n,t)=>{e.exports={src:{srcSet:t.p+"assets/ideal-img/image_1.382bcf5.2732.png 2732w",images:[{path:t.p+"assets/ideal-img/image_1.382bcf5.2732.png",width:2732,height:2048}],src:t.p+"assets/ideal-img/image_1.382bcf5.2732.png",toString:function(){return t.p+"assets/ideal-img/image_1.382bcf5.2732.png"},placeholder:void 0,width:2732,height:2048},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAHCAIAAAC+zks0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1ElEQVR4nAXB3U7CMBgA0E9N1OEYMoOGKsON8fXHDggYCNmd3rCua7s1GBPvjNc+h2/lq3EOCJxxzkfkZZiUwzdDlCmMoqpitcqUAWRyudn1Yt4nO+Lsg7XLTidGL1qf1h6eur/J7/9VXp31cH6oE9/NrJua5tE0xFhAJthqf32XQ4BRUooPQ4964V3m2lRbyNOJoPObOIUQIeTjV7X/dpsvx1z73FigeSZlEdxmEDLo42W8na4O1Y9ef3ZoW+CMSllE9wwicTHg5wMRxFssK/rumXMnxkUoMGLxQkQAAAAASUVORK5CYII="}},35806:(e,n,t)=>{e.exports={src:{srcSet:t.p+"assets/ideal-img/screenshot_1.a7242fa.1179.png 1179w",images:[{path:t.p+"assets/ideal-img/screenshot_1.a7242fa.1179.png",width:1179,height:2556}],src:t.p+"assets/ideal-img/screenshot_1.a7242fa.1179.png",toString:function(){return t.p+"assets/ideal-img/screenshot_1.a7242fa.1179.png"},placeholder:void 0,width:1179,height:2556},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAWCAYAAAD5Jg1dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQklEQVR4nL1TQWrDMBDUM/uI0ntOhf6gD+grmktC2kPuPaUkBJKAbVk52bEdO7ak1U5ZU4cUUiiUdkEsmh1mtSNJAXjI85wBoGma5+VyeTMajZ6MMS+CaZ2gKvJ7JfXT6SQYnHNvbds+TqfT17Is3lsCsqJC3blUlWVJVVWJGrz3ICIMUXVA54HGMqn1es2TyQTz+Ryz2YzG47GN48gDCCEQAhFCIFZd1+FwKFDXNay10r5Xly7H47HPwlHM3Le7XCEECH65ZJgfhfp7In+e6feKg4rWKbQ2X7AzUXwabiaOE0RR1PvZtm2fz8QkSbBarbDZbLDb7fos+8ViAWPM98NcC3UV/Tci/4DHiojIe0/Di7kSgZlJWWvrLMugtWbx8VwNAfKXxF/nXCqt75xzeykYY1g83G63SNO0lyeiPRHdfgBsw1Sj2+cPtgAAAABJRU5ErkJggg=="}},78724:(e,n,t)=>{e.exports={src:{srcSet:t.p+"assets/ideal-img/screenshot_2.c3ed59e.1179.png 1179w",images:[{path:t.p+"assets/ideal-img/screenshot_2.c3ed59e.1179.png",width:1179,height:2556}],src:t.p+"assets/ideal-img/screenshot_2.c3ed59e.1179.png",toString:function(){return t.p+"assets/ideal-img/screenshot_2.c3ed59e.1179.png"},placeholder:void 0,width:1179,height:2556},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAWCAYAAAD5Jg1dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAChklEQVR4nE1STWsUQRSc3+PVgwcvIh7Egwf1EA8iHgXxEhHxIoggEUGCgkJIIh4EEVw0BJFgDG4wJLhEWTfrfmXX2Zmd/ZhMT3fPR/d8lXTHLDa8S1Ovql69Z3Au75vmoGAsxnDorlQqP2ZmZ28vtlrdz1JkaPxuw7IG9wwps9B1KcIwgefxymhE5kullXXbHv0akwS9vosDGtvGYDDOLGsEx3FBaagb8hxIkhT2RICwFGNPZMbubrVYW/uCjY1NrK5+ykqlD7LR2E/DMM05i8BoBEqjwoiiBFvfNtFqNhGGMTgPwBgHIT6kTJFlGaJIwvAIx8yl01haeAKfMpjmHwyHQ/i+j1x5ACBEAiOOJXZ2trC/30GapgiCAGEYQgiJKIpQFAWESGEQP8Dliyex+OIRiM/Q6bTR6/UwmUzgOI6WVhaMOE5Qb9ThDB0kSaJZpJSQidQKU0ZKOY6fPYEH8w/hjl3U63WYpgnbtjEej3WzlBkMheaRQCQkUv0pIYTQJaX8N4xmDHD9yjksPJ3Dz2oN5fJXdLtd9Pt97VHJa48qo/L6RzT2qnpSzvmU6ehpxiAQePtmGTvbX+H7FI4z0P4YY3qQKZCyCHduXcX7d6/0h4qFEKIlj54GSpHAIwSeR/Q21KQK6LouHGeIIFBWVOCE48ypY3g8dxdm30al8l0PoaRVQxzHh0C1R+RAnuXTaP6XPZROYDAaFOevXcCzl89BDjwdjWVZ+jCy7PAo4jgpDMp4tvR6OStvb+qDUHLqzGSiDjhXu86FSDPD9/3A7HVRq1ULZ+RASIFYxPCpj2arVViWDcYD2/A872azWXf6/R7anXZR26tBVbvdLsIoBKV0yDm/8RdG7yMo9S1vMQAAAABJRU5ErkJggg=="}},19794:(e,n,t)=>{e.exports={src:{srcSet:t.p+"assets/ideal-img/screenshot_3.7a11b57.1179.png 1179w",images:[{path:t.p+"assets/ideal-img/screenshot_3.7a11b57.1179.png",width:1179,height:2556}],src:t.p+"assets/ideal-img/screenshot_3.7a11b57.1179.png",toString:function(){return t.p+"assets/ideal-img/screenshot_3.7a11b57.1179.png"},placeholder:void 0,width:1179,height:2556},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAWCAYAAAD5Jg1dAAAACXBIWXMAAAsTAAALEwEAmpwYAAACu0lEQVR4nCWPX2/bVABH78fkQ6DCY9utA6YJHtCQitAQbKCJMYoEEkwVGoIC4oEhmqRlXRva1I1jJ7EdO/5777WvHccHBZ5/R0fnJ6C6G0Vet2orpM4OLdt6bW9v5zMvmP0Ca+zJNWHovSVMu9ZRltG0Bs9zB5eXw/2Dg69+dWeT8/W6Ictj6trMxTRJ2rSUNE1GkvlIlSDVkiiek+mQ1bqgqtNWOOFVF+djtJ5SaKcNi5t6kY1WYT5aB/mIKL8mLsadmKXXBJnNsrCpyjm5ckjkmFiOCXOLDbzULmKurvHyCcvCQSqHqpyRKptCOYT5NX46wvdeICJ1g5uMWOYuhXIpyxlX8SnG+BjlkRYT4unPiLSyWWoLrxhjx+fkymYeXxKnY2qzJJUOUTFF5NqhKCdE2mV084BseURTJ2jlUpmANJsQLEaINLfIpUOc/InOX9HVPutVRF371CZAVlNSbSN6foiVRMyi3/GvHjFZ9HHkDW0TUpsQU/uoaor42q55anc8t4b40ZCjfz7mwvmGbq1ojE9TL/6zi89HhoPJiidWzTNLEbi/Ia2HSBNT6TnGBNRmgXjvVPJkXPPFTcXjYc7fi4hKj1FqSqM92ICVh9g+Lrh/pnls1Xw6WvGta4gLh7L0caVmqXNWJkDs9CR3+pKPhiWPrio+uWq4yFIaM+VFZPjOg6DMEHv9/8F3TiT7rxQPziXfTxQ0HhdpwVOnYxCXiFs9ydsDyb0Tyb1Tyf655uGo5iKV6DLgj1BzOF8hdo6LbrcnuX+S8O4g5fZA8uGw5MvJmtNYUVYLfvRNJ7b7qt3pFe3GvMm43ZPsHhc8m9YchS2ZWqznKm3FrZNK3Xm52ozdbl+yN1BsDr5/pjlLVAeSLJ/NxfZf+db2ceHv9DVv/DTutg6HvPnDkK3nVvfBRcUg1v4im7/+L+9OFFH4dvG6AAAAAElFTkSuQmCC"}},81183:(e,n,t)=>{"use strict";t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var a=t(85893),i=t(11151);const r={},o="\u7ef4\u62a4\u670d\u52a1\u5668\u6570\u636e\u7684\u672c\u5730\u526f\u672c",s={id:"swift-data/model-definition/maintaining-a-local-copy-of-server-data/index",title:"\u7ef4\u62a4\u670d\u52a1\u5668\u6570\u636e\u7684\u672c\u5730\u526f\u672c",description:"<OriginalSource",source:"@site/docs/swift-data/model-definition/maintaining-a-local-copy-of-server-data/index.mdx",sourceDirName:"swift-data/model-definition/maintaining-a-local-copy-of-server-data",slug:"/swift-data/model-definition/maintaining-a-local-copy-of-server-data/",permalink:"/swift-tutorials-cn/docs/swift-data/model-definition/maintaining-a-local-copy-of-server-data/",draft:!1,unlisted:!1,editUrl:"https://github.com/zhuanghongji/swift-tutorials-cn/docs/swift-data/model-definition/maintaining-a-local-copy-of-server-data/index.mdx",tags:[],version:"current",lastUpdatedAt:1698830538,formattedLastUpdatedAt:"2023\u5e7411\u67081\u65e5",frontMatter:{},sidebar:"swiftdataSidebar",previous:{title:"\u4ece\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5220\u9664\u6301\u4e45\u6570\u636e",permalink:"/swift-tutorials-cn/docs/swift-data/model-definition/deleting-persistent-data-from-your-app/"},next:{title:"PersistentModel",permalink:"/swift-tutorials-cn/docs/swift-data/model-definition/persistent-model/"}},l={},d=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u6a21\u578b",id:"\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u6a21\u578b",level:2},{value:"\u5bf9\u670d\u52a1\u5668\u6570\u636e\u5efa\u6a21",id:"\u5bf9\u670d\u52a1\u5668\u6570\u636e\u5efa\u6a21",level:2},{value:"\u4ece\u670d\u52a1\u5668\u4e0b\u8f7d\u6570\u636e",id:"\u4ece\u670d\u52a1\u5668\u4e0b\u8f7d\u6570\u636e",level:2},{value:"\u5c06\u670d\u52a1\u5668\u6570\u636e\u8f6c\u6362\u4e3a\u6a21\u578b\u6570\u636e",id:"\u5c06\u670d\u52a1\u5668\u6570\u636e\u8f6c\u6362\u4e3a\u6a21\u578b\u6570\u636e",level:2},{value:"\u63d2\u5165\u6216\u66f4\u65b0\u65b0\u7684\u5730\u9707\u6570\u636e",id:"\u63d2\u5165\u6216\u66f4\u65b0\u65b0\u7684\u5730\u9707\u6570\u636e",level:2},{value:"\u5b8c\u6574\u793a\u4f8b\u4ee3\u7801",id:"\u5b8c\u6574\u793a\u4f8b\u4ee3\u7801",level:2},{value:"DataCacheApp.swift",id:"datacacheappswift",level:3},{value:"Navigation",id:"navigation",level:3},{value:"ContentView.swift",id:"contentviewswift",level:4},{value:"SortButton.swift",id:"sortbuttonswift",level:4},{value:"RefreshButton.swift",id:"refreshbuttonswift",level:4},{value:"DeleteButton.swift",id:"deletebuttonswift",level:4},{value:"Sidebar",id:"sidebar",level:3},{value:"QuakeList.swift",id:"quakelistswift",level:4},{value:"QuakeListInfo.swift",id:"quakelistinfoswift",level:4},{value:"QuakeRow.swift",id:"quakerowswift",level:4},{value:"Detail",id:"detail",level:3},{value:"MapView.swift",id:"mapviewswift",level:4},{value:"QuakeMarker.swift",id:"quakemarkerswift",level:4},{value:"Model",id:"model",level:3},{value:"Quake.swift",id:"quakeswift",level:4},{value:"Location.swift",id:"locationswift",level:4},{value:"GeoFeatureCollection.swift",id:"geofeaturecollectionswift",level:4},{value:"Quake+GeoFeatureCollection.swift",id:"quakegeofeaturecollectionswift",level:4},{value:"ViewModel.swift",id:"viewmodelswift",level:4},{value:"Preview Content",id:"preview-content",level:3},{value:"PreviewSampleData.swift",id:"previewsampledataswift",level:4},{value:"ModelContainerPreviews.swift",id:"modelcontainerpreviewsswift",level:4},{value:"\u90e8\u5206\u793a\u4f8b\u622a\u56fe",id:"\u90e8\u5206\u793a\u4f8b\u622a\u56fe",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components},{Figure:r,OriginalSource:o,Screenshots:s}=n;return r||h("Figure",!0),o||h("OriginalSource",!0),s||h("Screenshots",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"\u7ef4\u62a4\u670d\u52a1\u5668\u6570\u636e\u7684\u672c\u5730\u526f\u672c",children:"\u7ef4\u62a4\u670d\u52a1\u5668\u6570\u636e\u7684\u672c\u5730\u526f\u672c"}),"\n",(0,a.jsx)(o,{title:"Maintaining a local copy of server data",url:"https://developer.apple.com/documentation/swiftdata/maintaining-a-local-copy-of-server-data",summary:"\u521b\u5efa\u548c\u66f4\u65b0\u6301\u4e45\u5b58\u50a8\u4ee5\u7f13\u5b58\u53ea\u8bfb\u7f51\u7edc\u6570\u636e"}),"\n",(0,a.jsx)(n.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,a.jsx)(n.p,{children:"\u8be5\u793a\u4f8b\u5e94\u7528\u7a0b\u5e8f\u663e\u793a\u4e00\u4e2a\u5217\u8868\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u5929\u53d1\u751f\u7684\u5730\u9707\uff08earthquakes\uff09\uff0c\u5e76\u663e\u793a\u5730\u9707\u7684\u65f6\u95f4\u3001\u4f4d\u7f6e\u548c\u5927\u5c0f\u3002\u4e3a\u4e86\u5e2e\u52a9\u4eba\u4eec\u53ef\u89c6\u5316\u5217\u8868\uff0c\u8be5\u5e94\u7528\u7a0b\u5e8f\u8fd8\u5728\u5730\u56fe\u4e0a\u7cbe\u786e\u5b9a\u4f4d\u4e86\uff08pinpoints\uff09\u6bcf\u6b21\u5730\u9707\u3002\u4f60\u53ef\u4ee5\u5728\u5217\u8868\u4e2d\u9009\u62e9\u5730\u9707\u4ee5\u5728\u5730\u56fe\u4e0a\u7a81\u51fa\u663e\u793a\u5b83\u3002"}),"\n",(0,a.jsx)(r,{src:t(53849),size:720}),"\n",(0,a.jsx)(n.p,{children:"\u8be5\u5e94\u7528\u7a0b\u5e8f\u5728\u4ee5\u4e0b\u5047\u8bbe\u4e0b\u4ece\u7f51\u7edc\u4e0b\u8f7d\u5730\u9707\u6570\u636e\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u5730\u9707\u6570\u636e\u662f\u53ea\u8bfb\u7684\uff1a\u5e94\u7528\u7a0b\u5e8f\u4e0d\u9700\u8981\u540c\u6b65\u672c\u5730\u548c\u8fdc\u7a0b\u66f4\u6539\u3002\u670d\u52a1\u5668\u59cb\u7ec8\u662f\u4e8b\u5b9e\u7684\u6765\u6e90\u3002"}),"\n",(0,a.jsx)(n.li,{children:"\u65b0\u7684\u5730\u9707\u5b9a\u671f\u53d1\u751f\uff1a\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u63d0\u4f9b\u4e00\u79cd\u65b9\u6cd5\u6765\u83b7\u53d6\u5730\u9707\u7684\u521d\u59cb\u5217\u8868\u5e76\u5b9a\u671f\u5237\u65b0\u8be5\u5217\u8868\u3002"}),"\n",(0,a.jsx)(n.li,{children:"\u73b0\u6709\u7684\u5730\u9707\u8bb0\u5f55\u53ef\u80fd\u4f1a\u53d1\u751f\u53d8\u5316\uff1a\u4f8b\u5982\uff0c\u62a5\u544a\u7684\u5730\u9707\u9707\u7ea7\u53ef\u80fd\u4f1a\u968f\u7740\u989d\u5916\u6d4b\u91cf\u7684\u53ef\u7528\u800c\u53d1\u751f\u53d8\u5316\u3002\u8be5\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u533a\u5206\u65b0\u7684\u5730\u9707\u548c\u5148\u524d\u4e0b\u8f7d\u7684\u5730\u9707\u7684\u66f4\u65b0\u3002"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"\u8be5\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528 SwiftData \u6301\u4e45\u5b58\u50a8\u5176\u4e0b\u8f7d\u7684\u6570\u636e\u3002\u901a\u8fc7\u5728\u672c\u5730\u7f13\u5b58\u6570\u636e\uff0c\u5e94\u7528\u7a0b\u5e8f\u51cf\u5c11\u4e86\u8bbf\u95ee\u670d\u52a1\u5668\u7684\u9700\u8981\u3002SwiftData \u8fd8\u4f7f\u5e94\u7528\u7a0b\u5e8f\u5728\u4e0b\u8f7d\u65b0\u6570\u636e\u65f6\u53ef\u4ee5\u8f7b\u677e\u7ba1\u7406\u66f4\u65b0\u3002"}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["\u8981\u4e86\u89e3\u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u901a\u8fc7\u67e5\u8be2\u548c\u65ad\u8a00\uff08predicate\uff09\u7ba1\u7406\u6570\u636e\u5448\u73b0\uff0c\u8bf7\u53c2\u9605 ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftdata/filtering-and-sorting-persistent-data",children:"\u8fc7\u6ee4\u548c\u6392\u5e8f\u6301\u4e45\u6570\u636e"}),"\u3002"]})}),"\n",(0,a.jsx)(n.h2,{id:"\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u6a21\u578b",children:"\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u7684\u6570\u636e\u6a21\u578b"}),"\n",(0,a.jsxs)(n.p,{children:["\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u5b9a\u4e49 ",(0,a.jsx)(n.code,{children:"Quake"})," \u7c7b\u6765\u8868\u793a\u5176\u754c\u9762\u6240\u9700\u7684\u4fe1\u606f\u3002\u7c7b\u5b9a\u4e49\u5305\u542b ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftdata/model()",children:"Model()"})," \u5b8f\uff0c\u544a\u8bc9\u7cfb\u7edf\u4f7f\u7528 SwiftData \u6301\u4e45\u5b58\u50a8\u6570\u636e\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:"import SwiftData\n\n@Model\nclass Quake {\n    @Attribute(.unique) var code: String\n    var magnitude: Double\n    var time: Date\n    var location: Location\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u8be5\u6a21\u578b\u5305\u62ec\u4ee5\u4e0b\u5b57\u6bb5\uff1a"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u552f\u4e00\u7f16\u7801 ",(0,a.jsx)(n.code,{children:"code"}),"\uff1a\u901a\u8fc7\u5305\u542b\uff08including\uff09\u5177\u6709 ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftdata/schema/attribute/option/unique",children:"unique"})," \u5c5e\u6027\u9009\u9879\u7684 ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftdata/attribute(_:originalname:hashmodifier:)",children:"Attribute(_:originalName:hashModifier:)"})," \u5b8f\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u786e\u4fdd SwiftData \u4ec5\u5b58\u50a8\u4e00\u6b21\u5177\u6709\u8be5\u5b57\u6bb5\u7279\u5b9a\u503c\u7684\u5730\u9707\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:["\u9707\u7ea7 ",(0,a.jsx)(n.code,{children:"magnitude"}),"\uff1a\u5730\u9707\u7684\u5927\u5c0f\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:["\u65f6\u95f4\u6233 ",(0,a.jsx)(n.code,{children:"timestamp"}),"\uff1a\u5730\u9707\u53d1\u751f\u7684\u65f6\u523b\uff0c\u5b58\u50a8\u4e3a ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/foundation/date",children:"Date"})," \u5b9e\u4f8b\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:["\u4f4d\u7f6e ",(0,a.jsx)(n.code,{children:"location"}),"\uff1a\u5305\u542b\u4f4d\u7f6e\u540d\u79f0\u548c\u5730\u56fe\u5750\u6807\u7684\u81ea\u5b9a\u4e49 ",(0,a.jsx)(n.code,{children:"Location"})," \u5b9e\u4f8b\uff1a"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:"struct Location: Codable {\n    var name: String\n    var longitude: Double\n    var latitude: Double\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"Quake"})," \u6a21\u578b\u53ef\u4ee5\u5d4c\u5165 ",(0,a.jsx)(n.code,{children:"location"})," \u5b9e\u4f8b\uff0c\u56e0\u4e3a ",(0,a.jsx)(n.code,{children:"Location"})," \u7ed3\u6784\u4f53\u7b26\u5408 ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/Swift/Codable",children:"Codable"})," \u534f\u8bae\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"\u5bf9\u670d\u52a1\u5668\u6570\u636e\u5efa\u6a21",children:"\u5bf9\u670d\u52a1\u5668\u6570\u636e\u5efa\u6a21"}),"\n",(0,a.jsxs)(n.p,{children:["\u8be5\u5e94\u7528\u7a0b\u5e8f\u4ece\u7f8e\u56fd\u5730\u8d28\u8c03\u67e5\u5c40\uff08USGS\uff09\u670d\u52a1\u5668\u52a0\u8f7d\u6570\u636e\uff0c\u8be5\u670d\u52a1\u5668\u63d0\u4f9b ",(0,a.jsx)(n.a,{href:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/geojson.php",children:"GeoJSON"})," \u683c\u5f0f\u7684\u5730\u9707\u6570\u636e\u3002\u4e3a\u4e86\u89e3\u91ca\u6b64\u6570\u636e\uff0c\u5e94\u7528\u7a0b\u5e8f\u5b9a\u4e49\u4e86\u4e00\u4e2a ",(0,a.jsx)(n.code,{children:"GeoFeatureCollection"})," \u7ed3\u6784\u4f53\uff0c\u5176\u5c5e\u6027\u540d\u79f0\u4e0e\u76f8\u5173 JSON \u5c5e\u6027\u7684\u540d\u79f0\u76f8\u5339\u914d\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:"struct GeoFeatureCollection: Decodable {\n    let features: [Feature]\n\n    struct Feature: Decodable {\n        let properties: Properties\n        let geometry: Geometry\n\n        struct Properties: Decodable {\n            let mag: Double\n            let place: String\n            let time: Date\n            let code: String\n        }\n\n        struct Geometry: Decodable {\n            let coordinates: [Double]\n        }\n    }\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u8be5\u7ed3\u6784\u4f53\u53ca\u5176\u5b50\u7ed3\u6784\u4f53\u5305\u542b\u4e0e\u8be5\u5e94\u7528\u7a0b\u5e8f\u76f8\u5173\u7684\u5143\u7d20\uff0c\u5373\u9707\u7ea7\uff08magnitude\uff09\u3001\u65f6\u95f4\u548c\u4f4d\u7f6e\u4fe1\u606f\u3002\u5b83\u4eec\u7701\u7565\u4e86\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u8bb8\u591a\u5176\u5b83\u5b57\u6bb5\uff0c\u56e0\u4e3a\u5e94\u7528\u7a0b\u5e8f\u4e0d\u9700\u8981\u5b83\u4eec\u3002\u8be5\u7ed3\u6784\u4f53\u4e5f\u7b26\u5408 ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/Swift/Decodable",children:"Decodable"})," \u534f\u8bae\uff0c\u56e0\u6b64\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u8be5\u7ed3\u6784\u4f53\u6765\u89e3\u7801\u4e0b\u8f7d\u7684\u6570\u636e\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"\u4ece\u670d\u52a1\u5668\u4e0b\u8f7d\u6570\u636e",children:"\u4ece\u670d\u52a1\u5668\u4e0b\u8f7d\u6570\u636e"}),"\n",(0,a.jsxs)(n.p,{children:["\u4e3a\u4e86\u68c0\u7d22\u6570\u636e\uff0c\u5e94\u7528\u7a0b\u5e8f\u5b9a\u4e49\u4e86\u4e00\u4e2a ",(0,a.jsx)(n.code,{children:"fetchFeatures()"})," \u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f7f\u7528 ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/foundation/urlsession",children:"URLSession"})," \u5c06\u5730\u9707 JSON \u5b58\u50a8\u5728 ",(0,a.jsx)(n.code,{children:"data"})," \u5c5e\u6027\u4e2d\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:"let session = URLSession.shared\nguard let (data, response) = try? await session.data(from: url),\n      let httpResponse = response as? HTTPURLResponse,\n      httpResponse.statusCode == 200\nelse {\n    throw DownloadError.missingData\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u7136\u540e\uff0c\u8be5\u65b9\u6cd5\u6839\u636e\u53ef\u89e3\u7801\u7684 ",(0,a.jsx)(n.code,{children:"GeoFeatureCollection"})," \u7ed3\u6784\u4f53\u63d0\u4f9b\u7684\u5b9a\u4e49\uff0c\u4f7f\u7528 ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/foundation/jsondecoder",children:"JSONDecoder"})," \u5b9e\u4f8b\u89e3\u6790\u6570\u636e\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:"do {\n    let jsonDecoder = JSONDecoder()\n    jsonDecoder.dateDecodingStrategy = .millisecondsSince1970\n    return try jsonDecoder.decode(GeoFeatureCollection.self, from: data)\n} catch {\n    throw DownloadError.wrongDataFormat(error: error)\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u6709\u5173\u89e3\u7801 JSON \u6570\u636e\u7684\u5176\u5b83\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605 ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/foundation/archives_and_serialization/using_json_with_custom_types",children:"\u5c06 JSON \u4e0e\u81ea\u5b9a\u4e49\u7c7b\u578b\u7ed3\u5408\u4f7f\u7528"}),"\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"\u5c06\u670d\u52a1\u5668\u6570\u636e\u8f6c\u6362\u4e3a\u6a21\u578b\u6570\u636e",children:"\u5c06\u670d\u52a1\u5668\u6570\u636e\u8f6c\u6362\u4e3a\u6a21\u578b\u6570\u636e"}),"\n",(0,a.jsxs)(n.p,{children:["\u68c0\u7d22\u7279\u5f81\u96c6\u5408\u540e\uff0c\u5e94\u7528\u7a0b\u5e8f\u5c06\u6bcf\u4e2a\u7279\u5f81\u89e3\u91ca\uff08interprets\uff09\u4e3a\u5730\u9707\u3002",(0,a.jsx)(n.code,{children:"Quake"})," \u7c7b\u5b9a\u4e49\u4e86\u4e00\u4e2a\u4fbf\u6377\u521d\u59cb\u5316\u5668\uff0c\u7528\u4e8e\u4ece\u8981\u7d20\u5b9e\u4f8b\u521b\u5efa\u65b0\u7684\u5730\u9707\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:"convenience init(from feature: GeoFeatureCollection.Feature) {\n    self.init(\n        code: feature.properties.code,\n        magnitude: feature.properties.mag,\n        time: feature.properties.time,\n        name: feature.properties.place,\n        longitude: feature.geometry.coordinates[0],\n        latitude: feature.geometry.coordinates[1]\n    )\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u8fd9\u4f7f\u5f97\u5e94\u7528\u7a0b\u5e8f\u80fd\u591f\u5c06\u6570\u636e\u4ece\u300c\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u683c\u5f0f\u300d\u8f6c\u6362\u4e3a\u300c\u5e94\u7528\u7a0b\u5e8f\u65b9\u4fbf\u7684\u683c\u5f0f\u300d\u3002\u4f8b\u5982\uff0c\u521d\u59cb\u5316\u5668\u5c06\u8981\u7d20 ",(0,a.jsx)(n.code,{children:"geometry.coordinates"})," \u6570\u7ec4\u4e2d\u663e\u793a\u4e3a\u533f\u540d\u5143\u7d20\u7684\u7ecf\u5ea6\u548c\u7eac\u5ea6\u5750\u6807\u8f6c\u6362\u4e3a\u547d\u540d\u53c2\u6570\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"\u63d2\u5165\u6216\u66f4\u65b0\u65b0\u7684\u5730\u9707\u6570\u636e",children:"\u63d2\u5165\u6216\u66f4\u65b0\u65b0\u7684\u5730\u9707\u6570\u636e"}),"\n",(0,a.jsxs)(n.p,{children:["\u5f53\u5e94\u7528\u7a0b\u5e8f\u521b\u5efa\u65b0\u7684\u5730\u9707\u5b9e\u4f8b\u65f6\uff0c\u5b83\u4f1a\u901a\u8fc7\u4e3a\u6bcf\u4e2a\u5b9e\u4f8b\u8c03\u7528\u6a21\u578b\u4e0a\u4e0b\u6587\u7684 ",(0,a.jsx)(n.a,{href:"https://developer.apple.com/documentation/swiftdata/modelcontext/insert(_:)",children:"insert(_:)"})," \u65b9\u6cd5\u6765\u6301\u4e45\u5b58\u50a8\u9707\u7ea7\u5927\u4e8e\u96f6\u7684\u4efb\u4f55\u5730\u9707\u5b9e\u4f8b\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:"for feature in featureCollection.features {\n    let quake = Quake(from: feature)\n\n    if quake.magnitude > 0 {\n        modelContext.insert(quake)\n    }\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:['\u5e94\u7528\u7a0b\u5e8f\u9488\u5bf9 "\u521d\u59cb\u4e0b\u8f7d" \u548c "\u7a0d\u540e\u7684\u5237\u65b0\u64cd\u4f5c" \u8fd0\u884c\u6b64\u5faa\u73af\u3002\u5f53\u5e94\u7528\u7a0b\u5e8f\u4fdd\u5b58\u66f4\u6539\u65f6\uff08\u5728\u672c\u4f8b\u4e2d\u4f1a\u81ea\u52a8\u53d1\u751f\uff0c\u56e0\u4e3a\u4e0a\u4e0b\u6587\u7684 ',(0,a.jsx)(n.code,{children:"autosaveEnabled"}),' \u5c5e\u6027\u5177\u6709\u9ed8\u8ba4\u503c true \uff09- SwiftData \u68c0\u67e5 "\u6307\u5b9a\u7684\u5730\u9707 code \u53c2\u6570" \u662f\u5426\u4e0e "\u5b58\u50a8\u4e2d\u5df2\u6709\u7684\u5730\u9707\u7f16\u7801" \u76f8\u5339\u914d\u3002\u5982\u679c\u662f\uff0c\u6846\u67b6\u5c06\u4f7f\u7528\u6307\u5b9a\u53c2\u6570\u4e2d\u7684\u503c\u66f4\u65b0\u5b58\u50a8\u7684\u5730\u9707\u7684\u5176\u5b83\u53c2\u6570\u3002\u5426\u5219\uff0c\u6846\u67b6\u4f1a\u5411\u5b58\u50a8\u6dfb\u52a0\u65b0\u7684\u5730\u9707\u3002']}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"insert"})," \u65b9\u6cd5\u9002\u7528\u4e8e\u521b\u5efa\u548c\u66f4\u65b0\u5730\u9707\u6a21\u578b\u5b9e\u4f8b\uff0c\u56e0\u4e3a\u6a21\u578b\u6307\u793a code \u53c2\u6570\u662f\u552f\u4e00\u7684\u3002\u8fd9\u4f9d\u8d56\u4e8e\u670d\u52a1\u5668\u786e\u4fdd\u6bcf\u4e2a\u5730\u9707\u4e8b\u4ef6\u90fd\u6709\u552f\u4e00\u3001\u7a33\u5b9a\u7684\u4ee3\u7801\u8fd9\u4e00\u4e8b\u5b9e\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"\u5b8c\u6574\u793a\u4f8b\u4ee3\u7801",children:"\u5b8c\u6574\u793a\u4f8b\u4ee3\u7801"}),"\n",(0,a.jsx)(n.h3,{id:"datacacheappswift",children:"DataCacheApp.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:"// Abstract:\n// The main entry point of the DataCache app.\n\nimport SwiftUI\nimport SwiftData\n\n/// The main entry point of the DataCache app.\n@main\nstruct DataCacheApp: App {\n    @State private var viewModel = ViewModel()\n\n    var body: some Scene {\n        WindowGroup {\n            ContentView()\n                .environment(viewModel)\n        }\n        .modelContainer(for: Quake.self)\n    }\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"navigation",children:"Navigation"}),"\n",(0,a.jsx)(n.h4,{id:"contentviewswift",children:"ContentView.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// The app\'s top level navigation split view.\n\nimport SwiftUI\nimport SwiftData\n\n/// The app\'s top level navigation split view.\nstruct ContentView: View {\n    @Environment(ViewModel.self) private var viewModel\n    @Environment(\\.modelContext) private var modelContext\n    @Environment(\\.scenePhase) private var scenePhase\n\n    @Query private var quakes: [Quake]\n\n    /// The identifier of the selected earthquake.\n    ///\n    /// The list controls this value through a binding, and most of the app\'s\n    /// interface relies on this value, with one exception: the map view binds\n    /// to a separate selection value. The app synchronizes these selections,\n    /// but using separate values enables the app to detect when someone taps\n    /// on the map so that it can scroll the list to match.\n    @State private var selectedId: Quake.ID? = nil\n\n    /// The identifier of the earthquake that the map highlights.\n    ///\n    /// This distinct map selection state enables the app to use\n    /// changes in map selection to drive scroll changes in the list.\n    @State private var selectedIdMap: Quake.ID? = nil\n\n    var body: some View {\n        @Bindable var viewModel = viewModel\n\n        NavigationSplitView {\n            QuakeList(\n                selectedId: $selectedId,\n                selectedIdMap: $selectedIdMap,\n                searchText: viewModel.searchText,\n                searchDate: viewModel.searchDate,\n                sortParameter: viewModel.sortParameter,\n                sortOrder: viewModel.sortOrder\n            )\n            .searchable(text: $viewModel.searchText)\n            .toolbar {\n                // In iOS, the refreshable modifier provides pull-to-refresh.\n                // In macOS, add a refresh button to the toolbar instead.\n                #if os(macOS)\n                RefreshButton()\n                #endif\n\n                DeleteButton(selectedId: $selectedId)\n                SortButton()\n            }\n\n            // This modifier creates a pull-to-refresh in iOS, but also sets\n            // the refresh action in the environment, which the custom macOS\n            // RefreshButton uses.\n            .refreshable {\n                await GeoFeatureCollection.refresh(modelContext: modelContext)\n                viewModel.update(modelContext: modelContext)\n            }\n            .navigationTitle("Earthquakes")\n        } detail: {\n            MapView(\n                selectedId: $selectedId,\n                selectedIdMap: $selectedIdMap,\n                searchDate: viewModel.searchDate,\n                searchText: viewModel.searchText\n            )\n            #if os(macOS)\n            .navigationTitle(quakes[selectedId]?.location.name ?? "Earthquakes")\n            .navigationSubtitle(quakes[selectedId]?.fullDate ?? "")\n            #else\n            .navigationTitle(quakes[selectedId]?.location.name ?? "")\n            .navigationBarTitleDisplayMode(.inline)\n            #endif\n        }\n        .onChange(of: scenePhase) { _, scenePhase in\n            if scenePhase == .active {\n                viewModel.update(modelContext: modelContext)\n            }\n        }\n    }\n}\n\n#Preview {\n    ContentView()\n        .environment(ViewModel())\n        .modelContainer(for: Quake.self, inMemory: true)\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"sortbuttonswift",children:"SortButton.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// A button that people can use to set the sort criteria.\n\nimport SwiftUI\n\n/// A button that people can use to set the sort criteria.\nstruct SortButton: View {\n    @Environment(ViewModel.self) private var viewModel\n\n    var body: some View {\n        @Bindable var viewModel = viewModel\n\n        Menu {\n            Picker("Sort Order", selection: $viewModel.sortOrder) {\n                ForEach([SortOrder.forward, .reverse], id: \\.self) { order in\n                    Text(order.name)\n                }\n            }\n            Picker("Sort By", selection: $viewModel.sortParameter) {\n                ForEach(SortParameter.allCases) { parameter in\n                    Text(parameter.name)\n                }\n            }\n        } label: {\n            Label("Sort", systemImage: "arrow.up.arrow.down")\n        }\n        .pickerStyle(.inline)\n    }\n}\n\nextension SortOrder {\n    /// A name for the sort order in the user interface.\n    var name: String {\n        switch self {\n        case .forward: "Forward"\n        case .reverse: "Reverse"\n        }\n    }\n}\n\n/// The characteristics by which the app can sort earthquake data.\nenum SortParameter: String, CaseIterable, Identifiable {\n    case time, magnitude\n    var id: Self { self }\n    var name: String { rawValue.capitalized }\n}\n\n#Preview {\n    SortButton()\n        .environment(ViewModel())\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"refreshbuttonswift",children:"RefreshButton.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// A button that initiates the refresh action in the environment.\n\nimport SwiftUI\n\n/// A button that initiates the refresh action in the environment.\n///\n/// This button relies on the refresh action, which you can put into the\n/// environment by adding a refreshable modifier to the view hieararchy.\nstruct RefreshButton: View {\n    @Environment (\\.refresh) private var refresh\n\n    var body: some View {\n        Button {\n            Task {\n                await refresh?()\n            }\n        } label: {\n            Label("Refresh", systemImage: "arrow.clockwise")\n        }\n    }\n}\n\n#Preview {\n    RefreshButton()\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"deletebuttonswift",children:"DeleteButton.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// A button that presents a menu with options to delete one or all quakes.\n\nimport SwiftUI\nimport SwiftData\n\n/// A button that presents a menu with options to delete one or all quakes.\nstruct DeleteButton: View {\n    @Environment(ViewModel.self) private var viewModel\n    @Environment(\\.modelContext) private var modelContext\n\n    @Query private var quakes: [Quake]\n    @Binding var selectedId: Quake.ID?\n\n    var body: some View {\n        Menu("Delete", systemImage: "trash") {\n            Button {\n                guard let selectedQuake = quakes[selectedId] else { return }\n                selectedId = nil\n                modelContext.delete(selectedQuake)\n                viewModel.update(modelContext: modelContext)\n            } label: {\n                Text("Delete Selected")\n            }\n            .disabled(selectedId == nil)\n\n            Button {\n                selectedId = nil\n                try? modelContext.delete(model: Quake.self)\n                viewModel.update(modelContext: modelContext)\n            } label: {\n                Text("Delete All")\n            }\n        }\n        .disabled(quakes.isEmpty)\n    }\n}\n\n#Preview {\n    DeleteButton(selectedId: .constant(nil))\n        .environment(ViewModel())\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"sidebar",children:"Sidebar"}),"\n",(0,a.jsx)(n.h4,{id:"quakelistswift",children:"QuakeList.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// The sorted and filtered list of earthquakes that the app stores.\n\nimport SwiftUI\nimport SwiftData\n\n/// The sorted and filtered list of earthquakes that the app stores.\nstruct QuakeList: View {\n    @Environment(ViewModel.self) private var viewModel\n    @Environment(\\.modelContext) private var modelContext\n    @Query private var quakes: [Quake]\n\n    @Binding var selectedId: Quake.ID?\n    @Binding var selectedIdMap: Quake.ID?\n\n    init(\n        selectedId: Binding<Quake.ID?>,\n        selectedIdMap: Binding<Quake.ID?>,\n\n        searchText: String = "",\n        searchDate: Date = .now,\n        sortParameter: SortParameter = .time,\n        sortOrder: SortOrder = .reverse\n    ) {\n        _selectedId = selectedId\n        _selectedIdMap = selectedIdMap\n\n        let predicate = Quake.predicate(searchText: searchText, searchDate: searchDate)\n        switch sortParameter {\n        case .time: _quakes = Query(filter: predicate, sort: \\.time, order: sortOrder)\n        case .magnitude: _quakes = Query(filter: predicate, sort: \\.magnitude, order: sortOrder)\n        }\n    }\n\n    var body: some View {\n        ScrollViewReader { proxy in\n            List(quakes, selection: $selectedId) { quake in\n                QuakeRow(quake: quake)\n            }\n\n#if os(macOS)\n            .safeAreaInset(edge: .bottom) {\n                QuakeListInfo(count: quakes.count)\n                    .padding(.horizontal)\n                    .padding(.bottom, 4)\n            }\n\n#elseif os(iOS)\n            .toolbar {\n                ToolbarItem(placement: .bottomBar) {\n                    QuakeListInfo(count: quakes.count)\n                        .padding(.top)\n                }\n            }\n#endif\n\n            // Synchronize changes from the map back to the main selector.\n            .onChange(of: selectedIdMap) { _, selectedIdMap in\n                guard selectedId != selectedIdMap else { return }\n                selectedId = selectedIdMap\n\n                // When the map selection changes, scroll the list to match.\n                if let id = selectedId {\n                    withAnimation {\n                        proxy.scrollTo(id, anchor: .center)\n                    }\n                }\n            }\n        }\n        .overlay {\n            if viewModel.totalQuakes == 0 {\n                ContentUnavailableView("Refresh to load earthquakes", systemImage: "globe")\n            } else if quakes.isEmpty {\n                ContentUnavailableView.search\n            }\n        }\n   }\n}\n\n#Preview {\n    QuakeList(selectedId: .constant(nil), selectedIdMap: .constant(nil))\n        .environment(ViewModel.preview)\n        .modelContainer(PreviewSampleData.container)\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"quakelistinfoswift",children:"QuakeListInfo.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// Information and controls to display at the bottom of the sidebar.\n\nimport SwiftUI\n\n/// Information and controls to display at the bottom of the sidebar.\nstruct QuakeListInfo: View {\n    @Environment(ViewModel.self) private var viewModel\n\n    var count: Int = 0\n\n    var body: some View {\n        @Bindable var viewModel = viewModel\n\n        HStack {\n            VStack {\n                Text("\\(count) earthquakes")\n                Text("\\(viewModel.totalQuakes) total")\n                    .foregroundStyle(.secondary)\n            }\n            .fixedSize()\n            Spacer()\n            DatePicker(\n                "Search Date",\n                selection: $viewModel.searchDate,\n                in: viewModel.searchDateRange,\n                displayedComponents: .date\n            )\n            .labelsHidden()\n            .disabled(viewModel.totalQuakes == 0)\n        }\n    }\n}\n\n#Preview {\n    QuakeListInfo(count: 8)\n        .environment(ViewModel.preview)\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"quakerowswift",children:"QuakeRow.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// A single row in the list of earthquakes.\n\nimport SwiftUI\n\n/// A single row in the list of earthquakes.\nstruct QuakeRow: View {\n    var quake: Quake\n\n    var body: some View {\n        HStack {\n            RoundedRectangle(cornerRadius: 8)\n                .fill(.black)\n                .frame(width: 60, height: 40)\n                .overlay {\n                    Text(quake.magnitudeString)\n                        .font(.title)\n                        .bold()\n                        .foregroundStyle(quake.color)\n                }\n\n            VStack(alignment: .leading) {\n                Text(quake.location.name)\n                    .font(.headline)\n                Text("\\(quake.time.formatted(.relative(presentation: .named)))")\n                    .foregroundStyle(.secondary)\n            }\n        }\n        .padding(.vertical, 8)\n    }\n}\n\n#Preview {\n    ModelContainerPreview(PreviewSampleData.inMemoryContainer) {\n        VStack {\n            QuakeRow(quake: .xsmall)\n            QuakeRow(quake: .small)\n            QuakeRow(quake: .medium)\n            QuakeRow(quake: .large)\n            QuakeRow(quake: .xlarge)\n        }\n        .padding()\n        .frame(minWidth: 300, alignment: .leading)\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"detail",children:"Detail"}),"\n",(0,a.jsx)(n.h4,{id:"mapviewswift",children:"MapView.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// A detail view that displays a map with an annotation for each stored quake.\n\nimport SwiftUI\nimport SwiftData\nimport MapKit\nimport simd\n\n/// A detail view that displays a map with an annotation for each stored quake.\nstruct MapView: View {\n    @Environment(\\.modelContext) private var modelContext\n    @Query(sort: \\Quake.magnitude, order: .reverse) private var quakes: [Quake]\n\n    @Binding var selectedId: Quake.ID?\n    @Binding var selectedIdMap: Quake.ID?\n\n    init(\n        selectedId: Binding<Quake.ID?>,\n        selectedIdMap: Binding<Quake.ID?>,\n        searchDate: Date = .now,\n        searchText: String = ""\n    ) {\n        _selectedId = selectedId\n        _selectedIdMap = selectedIdMap\n\n        _quakes = Query(\n            filter: Quake.predicate(\n                searchText: searchText,\n                searchDate: searchDate),\n            sort: \\.magnitude,\n            order: .reverse\n        )\n    }\n\n    var body: some View {\n        Map(selection: $selectedIdMap) {\n            ForEach(quakes) { quake in\n                QuakeMarker(quake: quake, selected: quake.id == selectedId)\n            }\n        }\n        .mapStyle(.standard(\n            elevation: .flat,\n            emphasis: .muted,\n            pointsOfInterest: .excludingAll))\n        .mapCameraKeyframeAnimator(trigger: selectedId) { initialCamera in\n            let start = initialCamera.centerCoordinate\n            let end = quakes[selectedId]?.location.coordinate ?? start\n            let travelDistance = start.distance(to: end)\n\n            let duration = max(min(travelDistance / 30, 5), 1)\n            let finalAltitude = travelDistance > 20 ? 3_000_000 : min(initialCamera.distance, 3_000_000)\n            let middleAltitude = finalAltitude * max(min(travelDistance / 5, 1.5), 1)\n\n            KeyframeTrack(\\MapCamera.centerCoordinate) {\n                CubicKeyframe(end, duration: duration)\n            }\n            KeyframeTrack(\\MapCamera.distance) {\n                CubicKeyframe(middleAltitude, duration: duration / 2)\n                CubicKeyframe(finalAltitude, duration: duration / 2)\n            }\n        }\n\n        // Synchronize changes from the main selector into the map.\n        .onChange(of: selectedId) { _, selectedId in\n            guard selectedId != selectedIdMap else { return }\n            selectedIdMap = selectedId\n        }\n    }\n}\n\nextension CLLocationCoordinate2D {\n    /// Calculates a value that\'s proportional to the distance between two points.\n    fileprivate func distance(to coordinate: CLLocationCoordinate2D) -> Double {\n        simd.distance(\n            SIMD2<Double>(x: latitude, y: longitude),\n            SIMD2<Double>(x: coordinate.latitude, y: coordinate.longitude))\n    }\n}\n\n#Preview {\n    MapView(selectedId: .constant(nil), selectedIdMap: .constant(nil))\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"quakemarkerswift",children:"QuakeMarker.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:"// Abstract:\n// A map annotation that represents a single earthquake.\n\nimport SwiftUI\nimport MapKit\n\n/// A map annotation that represents a single earthquake.\nstruct QuakeMarker: MapContent {\n    var quake: Quake\n    var selected: Bool\n\n    var body: some MapContent {\n        Annotation(coordinate: quake.location.coordinate) {\n            QuakeCircle(quake: quake, selected: selected)\n        } label: {\n            Text(quake.location.name)\n        }\n        .tag(quake)\n        .annotationTitles(.hidden)\n    }\n}\n\n/// The colorful circle that represents a single earthquake.\nprivate struct QuakeCircle: View {\n    var quake: Quake\n    var selected: Bool\n\n    var body: some View {\n        Circle()\n            .stroke(\n                selected ? Color.black : .gray,\n                style: .init(lineWidth: selected ? 2 : 1))\n            .fill(quake.color.opacity(selected ? 1 : 0.5))\n            .frame(width: quake.markerSize.width, height: quake.markerSize.width)\n    }\n}\n\n#Preview {\n    ModelContainerPreview(PreviewSampleData.inMemoryContainer) {\n        VStack {\n            QuakeCircle(quake: .xxsmall, selected: false)\n            QuakeCircle(quake: .xsmall, selected: false)\n            QuakeCircle(quake: .medium, selected: false)\n            QuakeCircle(quake: .large, selected: true)\n            QuakeCircle(quake: .xlarge, selected: false)\n            QuakeCircle(quake: .xxlarge, selected: false)\n            QuakeCircle(quake: .xxxlarge, selected: false)\n        }\n    }\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"model",children:"Model"}),"\n",(0,a.jsx)(n.h4,{id:"quakeswift",children:"Quake.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:"// Abstract:\n// A representation of an earthquake.\n\nimport SwiftUI\nimport SwiftData\n\n/// A representation of an earthquake.\n@Model\nclass Quake {\n    /// A unique identifier associated with each earthquake event.\n    @Attribute(.unique) var code: String\n\n    /// The measured strength of the earthquake.\n    var magnitude: Double\n\n    /// When the earthquake happened.\n    var time: Date\n\n    /// Where the earthquake happened.\n    var location: Location\n\n    /// Creates a new earthquake from the specified values.\n    init(\n        code: String,\n        magnitude: Double,\n        time: Date,\n        name: String,\n        longitude: Double,\n        latitude: Double\n    ) {\n        self.code = code\n        self.magnitude = magnitude\n        self.time = time\n        self.location = Location(name: name, longitude: longitude, latitude: latitude)\n    }\n}\n\n// A convenience for accessing a quake in an array by its identifier.\nextension Array where Element: Quake {\n    /// Gets the first quake in the array with the specified ID, if any.\n    subscript(id: Quake.ID?) -> Quake? {\n        first { $0.id == id }\n    }\n}\n\n// Values that the app uses to represent earthquakes in the interface.\nextension Quake {\n    /// A color that represents the quake's magnitude.\n    var color: Color {\n        switch magnitude {\n        case 0..<1:\n            return .green\n        case 1..<2:\n            return .yellow\n        case 2..<3:\n            return .orange\n        case 3..<5:\n            return .red\n        case 5..<7:\n            return .purple\n        case 7..<Double.greatestFiniteMagnitude:\n            return .indigo\n        default:\n            return .gray\n        }\n    }\n\n    /// The size for a marker that represents a quake on a map.\n    var markerSize: CGSize {\n        let value = (magnitude + 3) * 6\n        return CGSize(width: value, height: value)\n    }\n\n    /// The earthquakes magnitude, to one decimal place.\n    var magnitudeString: String {\n        magnitude.formatted(.number.precision(.fractionLength(1)))\n    }\n\n    /// A complete representation of the event's date.\n    var fullDate: String {\n        time.formatted(date: .complete, time: .complete)\n    }\n}\n\n// A string represenation of the quake.\nextension Quake: CustomStringConvertible {\n    var description: String {\n        \"\\(fullDate) \\(magnitudeString) \\(location)\"\n    }\n}\n\nextension Quake {\n    /// A filter that checks for a date and text in the quake's location name.\n    static func predicate(\n        searchText: String,\n        searchDate: Date\n    ) -> Predicate<Quake> {\n        let calendar = Calendar.autoupdatingCurrent\n        let start = calendar.startOfDay(for: searchDate)\n        let end = calendar.date(byAdding: .init(day: 1), to: start) ?? start\n\n        return #Predicate<Quake> { quake in\n            (searchText.isEmpty || quake.location.name.contains(searchText))\n            &&\n            (quake.time > start && quake.time < end)\n        }\n    }\n\n    /// Report the range of dates over which there are earthquakes.\n    static func dateRange(modelContext: ModelContext) -> ClosedRange<Date> {\n        let descriptor = FetchDescriptor<Quake>(sortBy: [.init(\\.time, order: .forward)])\n        guard let quakes = try? modelContext.fetch(descriptor),\n              let first = quakes.first?.time,\n              let last = quakes.last?.time else { return .distantPast ... .distantFuture }\n        return first ... last\n    }\n\n    /// Reports the total number of quakes.\n    static func totalQuakes(modelContext: ModelContext) -> Int {\n        (try? modelContext.fetchCount(FetchDescriptor<Quake>())) ?? 0\n    }\n}\n\n// Ensure that the model's conformance to Identifiable is public.\nextension Quake: Identifiable {}\n"})}),"\n",(0,a.jsx)(n.h4,{id:"locationswift",children:"Location.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// A location on Earth.\n\nimport CoreLocation\n\n/// A location on Earth.\nstruct Location: Codable {\n    /// A string that describes the location.\n    var name: String\n\n    /// The longitude of the location, given in degrees between -180 and 180.\n    var longitude: Double\n\n    /// The latitude of the location, given in degrees between -90 and 90.\n    var latitude: Double\n\n    /// The longitude and latitude collected into a location coordinate.\n    var coordinate: CLLocationCoordinate2D {\n        CLLocationCoordinate2D(latitude: latitude, longitude: longitude)\n    }\n}\n\n// A string represenation of the location.\nextension Location: CustomStringConvertible {\n    /// A string represenation of the location coordinate.\n    var description: String {\n        "["\n        + longitude.formatted(.number.precision(.fractionLength(1)))\n        + ", "\n        + latitude.formatted(.number.precision(.fractionLength(1)))\n        + "] "\n        + name\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"geofeaturecollectionswift",children:"GeoFeatureCollection.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// A representation of the JSON data served by the USGS server.\n\nimport Foundation\n\n/// A container that decodes a feature collection from the server.\n///\n/// This structure decodes JSON with the following layout:\n///\n/// ```json\n/// {\n///    "features": [\n///          {\n///       "properties": {\n///         "mag": 1.9,\n///         "place": "21km ENE of Honaunau-Napoopoo, Hawaii",\n///         "time": 1539187727610,\n///         "code": "70643082"\n///       },\n///       "gemoetry": {\n///         "coordinates": [63.2, -150.9, 5.2]\n///       }\n///     }\n///   ]\n/// }\n/// ```\n///\nstruct GeoFeatureCollection: Decodable {\n    let features: [Feature]\n\n    struct Feature: Decodable {\n        let properties: Properties\n        let geometry: Geometry\n\n        struct Properties: Decodable {\n            let mag: Double\n            let place: String\n            let time: Date\n            let code: String\n        }\n\n        struct Geometry: Decodable {\n            let coordinates: [Double]\n        }\n    }\n}\n\nextension GeoFeatureCollection.Feature: CustomStringConvertible {\n    var description: String {\n    """\n    feature: {\n        properties: {\n            mag: \\(properties.mag),\n            place: \\(properties.place),\n            time: \\(properties.time),\n            code: \\(properties.code)\n        },\n        geometry: { coordinates: \\(geometry.coordinates) }\n    }\n    """\n    }\n}\n\nextension GeoFeatureCollection: CustomStringConvertible {\n    var description: String {\n        var description = "Empty feature collection."\n        if let feature = features.first {\n            description = feature.description\n            if features.count > 1 {\n                description += "\\n...and \\(features.count - 1) more."\n            }\n        }\n        return description\n    }\n}\n\n// Fetch new data.\nextension GeoFeatureCollection {\n    /// Gets and decodes the latest earthquake data from the server.\n    static func fetchFeatures() async throws -> GeoFeatureCollection {\n        /// Geological data provided by the U.S. Geological Survey (USGS). See ACKNOWLEDGMENTS.txt for additional details.\n        let url = URL(string: "https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson")!\n\n        let session = URLSession.shared\n        guard let (data, response) = try? await session.data(from: url),\n              let httpResponse = response as? HTTPURLResponse,\n              httpResponse.statusCode == 200\n        else {\n            throw DownloadError.missingData\n        }\n\n        do {\n            // Decode the GeoJSON into a data model.\n            let jsonDecoder = JSONDecoder()\n            jsonDecoder.dateDecodingStrategy = .millisecondsSince1970\n            return try jsonDecoder.decode(GeoFeatureCollection.self, from: data)\n        } catch {\n            throw DownloadError.wrongDataFormat(error: error)\n        }\n    }\n}\n\n/// The kinds of errors that occur when loading feature data.\nenum DownloadError: Error {\n    case wrongDataFormat(error: Error)\n    case missingData\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"quakegeofeaturecollectionswift",children:"Quake+GeoFeatureCollection.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// Load and parse earthquake data via a feature collection.\n\nimport SwiftData\nimport OSLog\n\n// A mapping from items in the feature collection to earthquake items.\nextension Quake {\n    /// Creates a new quake instance from a decoded feature.\n    convenience init(from feature: GeoFeatureCollection.Feature) {\n        self.init(\n            code: feature.properties.code,\n            magnitude: feature.properties.mag,\n            time: feature.properties.time,\n            name: feature.properties.place,\n            longitude: feature.geometry.coordinates[0],\n            latitude: feature.geometry.coordinates[1]\n        )\n    }\n}\n\n// Helper methods for loading feature data and storing it as quakes.\nextension GeoFeatureCollection {\n    /// A logger for debugging.\n    fileprivate static let logger = Logger(subsystem: "com.example.apple-samplecode.DataCache", category: "parsing")\n\n    /// Loads new earthquakes and deletes outdated ones.\n    @MainActor\n    static func refresh(modelContext: ModelContext) async {\n        do {\n            // Fetch the latest set of quakes from the server.\n            logger.debug("Refreshing the data store...")\n            let featureCollection = try await fetchFeatures()\n            logger.debug("Loaded feature collection:\\n\\(featureCollection)")\n\n            // Add the content to the data store.\n            for feature in featureCollection.features {\n                let quake = Quake(from: feature)\n\n                // Ignore anything with a magnitude of zero or less.\n                if quake.magnitude > 0 {\n                    logger.debug("Inserting \\(quake)")\n                    modelContext.insert(quake)\n                }\n            }\n\n            logger.debug("Refresh complete.")\n\n        } catch let error {\n            logger.error("\\(error.localizedDescription)")\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"viewmodelswift",children:"ViewModel.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// User interface configuration values.\n\nimport Foundation\nimport SwiftData\n\n/// User interface configuration values.\n@Observable\nclass ViewModel {\n    /// The parameter to order quakes by in the list view.\n    var sortParameter: SortParameter = .time\n\n    /// The sort direction for quakes in the list view.\n    var sortOrder: SortOrder = .reverse\n\n    /// A location name to use when filtering quakes.\n    var searchText: String = ""\n\n    /// A date to use when filtering quakes.\n    ///\n    /// Both the list and map views display only the quakes that occur between\n    /// the start and end of the day in the current time zone that contain\n    /// the point in time represented by this date.\n    var searchDate: Date = .now\n\n    /// The range of dates that the date picker offers for filtering quakes.\n    ///\n    /// The app recalculates this range when the list of quakes changes, like\n    /// after loading new quakes or deleting existing ones, to\n    /// include the full range of dates over all the stored quakes.\n    var searchDateRange: ClosedRange<Date> = .distantPast ... .distantFuture\n\n    /// The total number of quakes in the store.\n    var totalQuakes: Int = 0\n\n    /// Updates the search date and search date range based on the current\n    /// set of stored quakes.\n    func update(modelContext: ModelContext) {\n        searchDateRange = Quake.dateRange(modelContext: modelContext)\n        searchDate = min(searchDateRange.upperBound, .now)\n        totalQuakes = Quake.totalQuakes(modelContext: modelContext)\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"preview-content",children:"Preview Content"}),"\n",(0,a.jsx)(n.h4,{id:"previewsampledataswift",children:"PreviewSampleData.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// An actor that provides an in-memory model container for previews.\n\nimport SwiftData\nimport SwiftUI\n\n/// An actor that provides an in-memory model container for previews.\nactor PreviewSampleData {\n    @MainActor\n    static var container: ModelContainer = {\n        return try! inMemoryContainer()\n    }()\n\n    static var inMemoryContainer: () throws -> ModelContainer = {\n        let schema = Schema([Quake.self])\n        let configuration = ModelConfiguration(isStoredInMemoryOnly: true)\n        let container = try! ModelContainer(for: schema, configurations: [configuration])\n        let sampleData: [any PersistentModel] = [\n            Quake.xxsmall,\n            Quake.xsmall,\n            Quake.small,\n            Quake.medium,\n            Quake.large,\n            Quake.xlarge,\n            Quake.xxlarge,\n            Quake.xxxlarge\n        ]\n        Task { @MainActor in\n            sampleData.forEach {\n                container.mainContext.insert($0)\n            }\n        }\n        return container\n    }\n}\n\n// Default quakes for use in previews.\nextension Quake {\n    static var xxsmall: Quake {\n        .init(code: "1", magnitude: 0.5, time: .now, name: "West of California", longitude: -125, latitude: 35)\n    }\n    static var xsmall: Quake {\n        .init(code: "2", magnitude: 1.5, time: .now, name: "West of California", longitude: -125, latitude: 35)\n    }\n    static var small: Quake {\n        .init(code: "3", magnitude: 2.5, time: .now, name: "West of California", longitude: -125, latitude: 35)\n    }\n    static var medium: Quake {\n        .init(code: "4", magnitude: 3.5, time: .now, name: "West of California", longitude: -125, latitude: 35)\n    }\n    static var large: Quake {\n        .init(code: "5", magnitude: 4.5, time: .now, name: "West of California", longitude: -125, latitude: 35)\n    }\n    static var xlarge: Quake {\n        .init(code: "6", magnitude: 5.5, time: .now, name: "West of California", longitude: -125, latitude: 35)\n    }\n    static var xxlarge: Quake {\n        .init(code: "7", magnitude: 6.5, time: .now, name: "West of California", longitude: -125, latitude: 35)\n    }\n    static var xxxlarge: Quake {\n        .init(code: "8", magnitude: 7.5, time: .now, name: "West of California", longitude: -125, latitude: 35)\n    }\n}\n\nextension ViewModel {\n    static var preview: ViewModel {\n        let model = ViewModel()\n        model.totalQuakes = 8\n        return model\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h4,{id:"modelcontainerpreviewsswift",children:"ModelContainerPreviews.swift"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// Abstract:\n// A view that creates a model container before showing preview content.\n\nimport SwiftUI\nimport SwiftData\n\n/// A view that creates a model container before showing preview content.\n///\n/// Use this view type only for previews, and only when you need\n/// to create a container before showing the view content. As an example\n/// of how to use this view, see the preview for `QuakeRow`.\nstruct ModelContainerPreview<Content: View>: View {\n    var content: () -> Content\n    let container: ModelContainer\n\n    /// Creates a view that creates the specified model container before\n    /// displaying the preview content.\n    init(\n        _ modelContainer: @escaping () throws -> ModelContainer,\n        @ViewBuilder content: @escaping () -> Content\n    ) {\n        self.content = content\n        do {\n            self.container = try MainActor.assumeIsolated(modelContainer)\n        } catch {\n            fatalError("Failed to create the model container: \\(error.localizedDescription)")\n        }\n    }\n\n    var body: some View {\n        content()\n            .modelContainer(container)\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"\u90e8\u5206\u793a\u4f8b\u622a\u56fe",children:"\u90e8\u5206\u793a\u4f8b\u622a\u56fe"}),"\n",(0,a.jsx)(s,{data:[t(35806),t(78724),t(19794)]})]})}function u(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}function h(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},11151:(e,n,t)=>{"use strict";t.d(n,{Z:()=>s,a:()=>o});var a=t(67294);const i={},r=a.createContext(i);function o(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);