"use strict";(self.webpackChunkswift_tutorials_cn=self.webpackChunkswift_tutorials_cn||[]).push([[340],{3905:(e,n,t)=>{t.d(n,{Zo:()=>s,kt:()=>k});var i=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=i.createContext({}),p=function(e){var n=i.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},s=function(e){var n=p(e.components);return i.createElement(c.Provider,{value:n},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},d=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),m=p(t),d=a,k=m["".concat(c,".").concat(d)]||m[d]||u[d]||r;return t?i.createElement(k,l(l({ref:n},s),{},{components:t})):i.createElement(k,l({ref:n},s))}));function k(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,l=new Array(r);l[0]=d;var o={};for(var c in n)hasOwnProperty.call(n,c)&&(o[c]=n[c]);o.originalType=e,o[m]="string"==typeof e?e:a,l[1]=o;for(var p=2;p<r;p++)l[p]=t[p];return i.createElement.apply(null,l)}return i.createElement.apply(null,t)}d.displayName="MDXCreateElement"},40790:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>_,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var i=t(87462),a=(t(67294),t(3905));const r={},l="\u5149\u7ebf\u8ffd\u8e2a\u7c7b\u578b",o={unversionedId:"metal-shading-language-specification/ray-tracing-types/index",id:"metal-shading-language-specification/ray-tracing-types/index",title:"\u5149\u7ebf\u8ffd\u8e2a\u7c7b\u578b",description:"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2.3 \u8d77\u652f\u6301\u5149\u7ebf\u8ffd\u8e2a\u7c7b\u578b\u3002\u8fd9\u4e9b\u7c7b\u578b\u5728\u547d\u540d\u7a7a\u95f4 metal::raytracing \u7684\u5934\u6587\u4ef6 `` \u4e2d\u5b9a\u4e49\u3002\u5728 Metal 2.3 \u4e2d\uff0c\u8fd9\u4e9b\u7c7b\u578b\u4ec5\u5728\u8ba1\u7b97\u51fd\u6570\uff08\u5185\u6838\u51fd\u6570\uff09\u4e2d\u53d7\u652f\u6301\uff0c\u9664\u975e\u4e0b\u9762\u53e6\u6709\u8bf4\u660e\u3002\u4ece Metal 2.4 \u5f00\u59cb\uff0c\u9876\u70b9\u3001\u7247\u6bb5\u548c\u56fe\u5757\u51fd\u6570\u4e5f\u652f\u6301\u5b83\u4eec\u3002\u5728 Metal 3.1 \u4e2d\uff0c\u5149\u7ebf\u8ffd\u8e2a\u652f\u6301\u66f2\u7ebf\u548c\u591a\u7ea7\u5b9e\u4f8b\u3002",source:"@site/docs/metal-shading-language-specification/ray-tracing-types/index.mdx",sourceDirName:"metal-shading-language-specification/ray-tracing-types",slug:"/metal-shading-language-specification/ray-tracing-types/",permalink:"/swift-tutorials-cn/docs/metal-shading-language-specification/ray-tracing-types/",draft:!1,editUrl:"https://github.com/zhuanghongji/swift-tutorials-cn/docs/metal-shading-language-specification/ray-tracing-types/index.mdx",tags:[],version:"current",lastUpdatedAt:1693648798,formattedLastUpdatedAt:"2023\u5e749\u67082\u65e5",frontMatter:{},sidebar:"metalshadinglanguagespecificationSidebar",previous:{title:"\u529f\u80fd\u7ec4\u5c5e\u6027",permalink:"/swift-tutorials-cn/docs/metal-shading-language-specification/function-group-attribute/"},next:{title:"\u63d2\u503c\u7c7b\u578b",permalink:"/swift-tutorials-cn/docs/metal-shading-language-specification/interpolant-type/"}},c={},p=[{value:"\u5149\u7ebf\u8ffd\u8e2a\u4ea4\u53c9\u70b9\u6807\u7b7e",id:"\u5149\u7ebf\u8ffd\u8e2a\u4ea4\u53c9\u70b9\u6807\u7b7e",level:2},{value:"\u5149\u7ebf\u7c7b\u578b",id:"\u5149\u7ebf\u7c7b\u578b",level:2},{value:"\u4ea4\u96c6\u51fd\u6570\u8868",id:"\u4ea4\u96c6\u51fd\u6570\u8868",level:2},{value:"\u4ea4\u96c6\u7ed3\u679c\u7c7b\u578b",id:"\u4ea4\u96c6\u7ed3\u679c\u7c7b\u578b",level:2},{value:"\u4ea4\u53c9\u7ebf\u7c7b\u578b",id:"\u4ea4\u53c9\u7ebf\u7c7b\u578b",level:2},{value:"\u52a0\u901f\u7ed3\u6784\u7c7b\u578b",id:"\u52a0\u901f\u7ed3\u6784\u7c7b\u578b",level:2},{value:"\u4ea4\u96c6\u67e5\u8be2\u7c7b\u578b",id:"\u4ea4\u96c6\u67e5\u8be2\u7c7b\u578b",level:2}],s=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,a.kt)("div",n)},m=s("OrigninalPDF"),u=s("TableView"),d={toc:p},k="wrapper";function _(e){let{components:n,...t}=e;return(0,a.kt)(k,(0,i.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u5149\u7ebf\u8ffd\u8e2a\u7c7b\u578b"},"\u5149\u7ebf\u8ffd\u8e2a\u7c7b\u578b"),(0,a.kt)(m,{title:"2.17 Ray Tracing Types",mdxType:"OrigninalPDF"}),(0,a.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2.3 \u8d77\u652f\u6301\u5149\u7ebf\u8ffd\u8e2a\u7c7b\u578b\u3002\u8fd9\u4e9b\u7c7b\u578b\u5728\u547d\u540d\u7a7a\u95f4 ",(0,a.kt)("inlineCode",{parentName:"p"},"metal::raytracing")," \u7684\u5934\u6587\u4ef6 ",(0,a.kt)("inlineCode",{parentName:"p"},"<metal_raytracing>")," \u4e2d\u5b9a\u4e49\u3002\u5728 Metal 2.3 \u4e2d\uff0c\u8fd9\u4e9b\u7c7b\u578b\u4ec5\u5728\u8ba1\u7b97\u51fd\u6570\uff08\u5185\u6838\u51fd\u6570\uff09\u4e2d\u53d7\u652f\u6301\uff0c\u9664\u975e\u4e0b\u9762\u53e6\u6709\u8bf4\u660e\u3002\u4ece Metal 2.4 \u5f00\u59cb\uff0c\u9876\u70b9\u3001\u7247\u6bb5\u548c\u56fe\u5757\u51fd\u6570\u4e5f\u652f\u6301\u5b83\u4eec\u3002\u5728 Metal 3.1 \u4e2d\uff0c\u5149\u7ebf\u8ffd\u8e2a\u652f\u6301\u66f2\u7ebf\u548c\u591a\u7ea7\u5b9e\u4f8b\u3002"),(0,a.kt)("h2",{id:"\u5149\u7ebf\u8ffd\u8e2a\u4ea4\u53c9\u70b9\u6807\u7b7e"},"\u5149\u7ebf\u8ffd\u8e2a\u4ea4\u53c9\u70b9\u6807\u7b7e"),(0,a.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u4ece Metal 2. 3 \u5f00\u59cb\u652f\u6301\u5149\u7ebf\u8ffd\u8e2a\u76f8\u4ea4\u6807\u7b7e\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"intersection_tags")," \u5728\u547d\u540d\u7a7a\u95f4 ",(0,a.kt)("inlineCode",{parentName:"p"},"metal::raytracing")," \u7684\u5934\u6587\u4ef6 ",(0,a.kt)("inlineCode",{parentName:"p"},"<metal_raytracing>")," \u4e2d\u5b9a\u4e49\u3002\u5b83\u4eec\u5217\u4e8e\u8868 2.9 \u4e2d\uff0c\u5e76\u5728\u5b9a\u4e49\u65f6\u7528\u4e8e\u5149\u7ebf\u8ffd\u8e2a\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u76f8\u4ea4\u51fd\u6570\uff08",(0,a.kt)("inlineCode",{parentName:"li"},"[[intersection]]"),"\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u76f8\u4ea4\u51fd\u6570\u8868\uff08",(0,a.kt)("inlineCode",{parentName:"li"},"intersection_function_table"),"\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u76f8\u4ea4\u7ed3\u679c\uff08",(0,a.kt)("inlineCode",{parentName:"li"},"intersection_result"),"\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u76f8\u4ea4\u7ebf\u7c7b\u578b\u548c\u76f8\u5173\u51fd\u6570\uff08",(0,a.kt)("inlineCode",{parentName:"li"},"intersector"),"\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u52a0\u901f\u5ea6\u7ed3\u6784\u7c7b\u578b\uff08",(0,a.kt)("inlineCode",{parentName:"li"},"acceleration_structure"),"\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u4ea4\u96c6\u67e5\u8be2\uff08",(0,a.kt)("inlineCode",{parentName:"li"},"intersection_query"),"\uff09")),(0,a.kt)("p",null,"\u6807\u7b7e\u7528\u4e8e\u914d\u7f6e\u5149\u7ebf\u8ffd\u8e2a\u8fc7\u7a0b\u5e76\u63a7\u5236\u4e0d\u540c\u7c7b\u578b\u548c\u8868\u7684\u884c\u4e3a\u548c\u8bed\u4e49\u3002\u8fd9\u4e9b\u6807\u7b7e\u6807\u8bc6\u76f8\u4ea4\u7684\u52a0\u901f\u5668\u7ed3\u6784\u7684\u7c7b\u578b\u3001\u53ef\u7528\u4e8e\u76f8\u4ea4\u51fd\u6570\u7684\u5185\u7f6e\u53c2\u6570\u3001\u76f8\u4ea4\u51fd\u6570\u8868\u4e2d\u76f8\u4ea4\u51fd\u6570\u7684\u7c7b\u578b\u3001\u76f8\u4ea4\u7c7b\u578b\u6216\u76f8\u4ea4\u67e5\u8be2\u5bf9\u8c61\u4e0a\u53ef\u7528\u7684\u65b9\u6cd5\u4ee5\u53ca\u76f8\u4ea4\u4e2d\u8fd4\u56de\u7684\u6570\u636e\u7ed3\u679c\u7c7b\u578b\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"intersector_tags")," \u7684\u6807\u7b7e\u7c7b\u578b\u548c\u987a\u5e8f\u5fc5\u987b\u4e0e ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_function_table"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_result"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"intersector")," \u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_query")," \u7684\u76f8\u5173\u4f7f\u7528\u4e4b\u95f4\u5339\u914d\uff0c\u5426\u5219\u7f16\u8bd1\u5668\u5c06\u751f\u6210\u9519\u8bef\u3002\u76f8\u4ea4\u7684\u52a0\u901f\u7ed3\u6784\u7c7b\u578b\u5fc5\u987b\u4e0e instancing\u3001primitive_motion \u548c instance_motion \u6807\u7b7e\u7684\u987a\u5e8f\u76f8\u5339\u914d\uff0c\u5982\u679c\u5b83\u4eec\u51fa\u73b0\u5728\u7528\u4e8e\u4e0e\u52a0\u901f\u7ed3\u6784\u76f8\u4ea4\u7684\u5176\u5b83\u5149\u7ebf\u8ddf\u8e2a\u7c7b\u578b\u4e0a\u7684\u8bdd\u3002\u5728\u4ea4\u96c6\u51fd\u6570\u8868\u4e2d\u8c03\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection")," \u51fd\u6570\u65f6\uff0c\u5f00\u53d1\u4eba\u5458\u5fc5\u987b\u786e\u4fdd\u5b83\u4eec\u4f7f\u7528\u76f8\u540c\u7684\u6709\u5e8f\u6807\u7b7e\u96c6\uff0c\u5426\u5219\u7ed3\u679c\u662f\u4e0d\u786e\u5b9a\u7684\u3002"),(0,a.kt)(u,{num:"2.9",title:"Intersection Tags",headers:["Intersection Tag","Description"],datasList:[["instancing","This tag indicates intersection functions can read the built-in instance_id and/or user_instance_id as described in section 5.2.3.7, and the acceleration structure is an instance acceleration structure. \n\nThe intersector<intersection_tags...>::intersect() function and intersection_query< intersection_tags...> assume that the acceleration structure needs to be an instance_acceleration_structure and it returns the instance_id value."],["triangle_data","This tag indicates triangle intersection functions can read input parameters with barycentric_coord or front_facing attribute as described in section 5.2.3.7. This tag cannot be used in defining an acceleration structure. \n\nThe intersector<intersection_tags...>::intersect() function and intersection_query< intersection_tags...> returns the triangle_barycentric_coord and triangle_front_facing values."],["world_space_data","This tag indicates intersection functions declared with this tag can query world_space_origin, world_space_direction, object_to_world_transform, and world_to_object_transform as described in section 5.2.3.7. This tag cannot be used in defining an acceleration structure or intersection_query. It enables support for world space data in intersector and intersection_function_table."],["primitive_motion \nAll OS: Since Metal 2.4.","This tag enables support for primitive level motion in intersector, intersection_query, intersection_function_table, and acceleration structures."],["instance_motion \nAll OS: Since Metal 2.4","This tag enables support for instance level motion in intersector, intersection_query, intersection_function_table, and acceleration structure."],["extended_limits \nAll OS: Since Metal 2.4","This tag indicates acceleration structures passed to intersection functions are built with extended limits for the number of primitives, number of geometries, number of instances, and increases the number of bits used for visibility masks. This tag cannot be used in defining an acceleration structure."],["curve_data \nSince Metal 3.1","This tag makes the curve_parameter of the curve intersection point available as a field of intersection_result object from methods of the intersection_query objects, and as input parameter to intersection functions as described in section 5.2.3.7."],["max_levels<Count> \nSince Metal 3.1","This tag enables support for multi-level instancing in intersector, intersection_query and intersection_function_table. It cannot be used in acceleration structures. Count is a template parameter that determines the maximum number of acceleration structure levels that can be traversed. It must be between [2, 16] for intersection_query. It must be [2,32] for intersector. For intersection_function_table, it needs to match it use with intersection_query or intersector."]],mdxType:"TableView"}),(0,a.kt)("p",null,"\u5728 Metal 2.3 \u4e2d\uff0c\u4ee5\u4e0b\u662f\u4ea4\u53c9\u6807\u7b7e\u7684\u6709\u6548\u7ec4\u5408\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"no ",(0,a.kt)("inlineCode",{parentName:"li"},"tags")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"world_space_data")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"world_space_data"))),(0,a.kt)("p",null,"Metal 2.4 \u6dfb\u52a0\u4e86\u4ee5\u4e0b\u9644\u52a0\u6709\u6548\u7ec4\u5408\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"world_space_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"world_space_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"world_space_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"world_space_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"world_space_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"world_space_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion"))),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"extended_limits")," \u6807\u7b7e\u53ef\u4ee5\u6dfb\u52a0\u5230\u4e0a\u9762\u5217\u51fa\u7684\u6240\u6709\u7ec4\u5408\u4e2d\u3002"),(0,a.kt)("p",null,"\u5728 Metal 3.1 \u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"curve_data")," \u53ef\u4ee5\u6dfb\u52a0\u5230\u4e0a\u9762\u5217\u51fa\u7684\u6240\u6709\u7ec4\u5408\u4e2d\u3002\u4ea4\u53c9\u6807\u7b7e ",(0,a.kt)("inlineCode",{parentName:"p"},"max_levels<Count>")," \u53ef\u4ee5\u6dfb\u52a0\u5230\u4e0a\u9762\u5305\u542b ",(0,a.kt)("inlineCode",{parentName:"p"},"instancing")," \u7684\u4efb\u4f55\u7ec4\u5408\u4e2d\u3002"),(0,a.kt)("h2",{id:"\u5149\u7ebf\u7c7b\u578b"},"\u5149\u7ebf\u7c7b\u578b"),(0,a.kt)("p",null,"\u5149\u7ebf\u7ed3\u6784\u662f\u76f8\u4ea4\u6240\u9700\u5149\u7ebf\u5c5e\u6027\u7684\u5bb9\u5668\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp"},"struct ray\n{\n    ray(float3 origin = 0.0f, float3 direction = 0.0f,\n        float min_distance = 0.0f, float max_distance = INFINITY);\n    float3 origin;\n    float3 direction;\n    float min_distance;\n    float max_distance;\n};\n")),(0,a.kt)("p",null,"\u5149\u7ebf\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"origin")," \u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"direction")," \u5b57\u6bb5\u4f4d\u4e8e\u4e16\u754c\u7a7a\u95f4\u4e2d\u3002\u5f53\u5149\u7ebf\u5bf9\u8c61\u4f20\u9012\u5230\u81ea\u5b9a\u4e49\u76f8\u4ea4\u6216\u4e09\u89d2\u5f62\u76f8\u4ea4\u51fd\u6570\u65f6\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"min_distance")," \u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"max_distance")," \u5b57\u6bb5\u5c06\u57fa\u4e8e\u5f53\u524d\u641c\u7d22\u95f4\u9694\uff1a\u5f53\u53d1\u73b0\u5019\u9009\u76f8\u4ea4\u65f6\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"max_distance")," \u5c06\u51cf\u5c0f\u4ee5\u5339\u914d\u65b0\u7f29\u5c0f\u7684\u641c\u7d22\u95f4\u9694\u3002\u5728\u4ea4\u96c6\u51fd\u6570\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"origin")," \u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"direction")," \u5c06\u4f4d\u4e8e\u5bf9\u8c61\u7a7a\u95f4\u4e2d\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"ray")," \u53ef\u80fd\u662f\u65e0\u6548\u7684\u3002\u65e0\u6548\u5149\u7ebf\u7684\u793a\u4f8b\u5305\u62ec\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"INF's or NaN's in ",(0,a.kt)("inlineCode",{parentName:"li"},"origin")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"direction")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"min_distance")," == NaN or ",(0,a.kt)("inlineCode",{parentName:"li"},"max_distance")," == NaN"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"min_distance")," == INF (Note that ",(0,a.kt)("inlineCode",{parentName:"li"},"max_distance")," may be positive INF)."),(0,a.kt)("li",{parentName:"ul"},"length(",(0,a.kt)("inlineCode",{parentName:"li"},"ray.direction"),") == 0.0"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"min_distance")," > ",(0,a.kt)("inlineCode",{parentName:"li"},"max_distance")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"min_distance")," < 0.0 or ",(0,a.kt)("inlineCode",{parentName:"li"},"max_distance")," < 0.0")),(0,a.kt)("p",null,"\u5149\u7ebf\u65b9\u5411\u4e0d\u9700\u8981\u6807\u51c6\u5316\uff0c\u5c3d\u7ba1\u5b83\u786e\u5b9e\u9700\u8981\u975e\u96f6\u3002"),(0,a.kt)("h2",{id:"\u4ea4\u96c6\u51fd\u6570\u8868"},"\u4ea4\u96c6\u51fd\u6570\u8868"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"intersection_function_table<intersection_tags...>")," \u7ed3\u6784\u7c7b\u578b\u63cf\u8ff0\u4e86\u4f20\u9012\u5230\u7740\u8272\u5668\u7684\u81ea\u5b9a\u4e49\u4ea4\u96c6\u51fd\u6570\u8868\uff0c\u5982\u7b2c 5.1.6 \u8282\u4e2d\u6240\u5b9a\u4e49\u3002\u4ea4\u96c6\u6807\u8bb0\uff08 intersection tags\uff09\u6839\u636e\u8868 2.9 \u8fdb\u884c\u5b9a\u4e49\u3002",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_function_table")," \u7c7b\u578b\u548c\u4ea4\u96c6\u51fd\u6570\u4e0a\u7684\u4ea4\u96c6\u6807\u8bb0\u5fc5\u987b\u5339\u914d\u3002\u8fd9\u79cd\u58f0\u660e\u7684\u4e00\u4e2a\u4f8b\u5b50\u662f\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-c"},"intersection_function_table<triangle_data, instancing> intersectionFuncs;\n")),(0,a.kt)("p",null,"\u8c03\u7528\u4ee5\u4e0b\u51fd\u6570\u68c0\u67e5 ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_function_table")," \u662f\u5426\u4e3a ",(0,a.kt)("inlineCode",{parentName:"p"},"null"),"\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-c"},"bool is_null_intersection_function_table(\n      intersection_function_table<intersection_tags...>)\n")),(0,a.kt)("p",null,"\u8c03\u7528\u4ee5\u4e0b\u6210\u5458\u51fd\u6570\u6765\u68c0\u67e5 ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_function_table")," \u662f\u5426\u4e3a\u7a7a\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-c"},"bool empty() const\n")),(0,a.kt)("p",null,"\u8c03\u7528\u4ee5\u4e0b\u6210\u5458\u51fd\u6570\u8fd4\u56de ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_function_table")," \u4e2d\u7684\u6761\u76ee\u6570\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-c"},"uint size() const\n")),(0,a.kt)("p",null,"Metal 3 \u652f\u6301\u4ee5\u4e0b\u51fd\u6570\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"get_buffer")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"get_visible_function_table"))),(0,a.kt)("p",null,"\u8c03\u7528\u4ee5\u4e0b\u6210\u5458\u51fd\u6570\u4ee5\u8fd4\u56de ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_function_table")," \u4e2d\u7d22\u5f15\u5904\u7684\u7f13\u51b2\u533a\uff0c\u5176\u4e2d ",(0,a.kt)("inlineCode",{parentName:"p"},"T")," \u662f\u8bbe\u5907\u6216 ",(0,a.kt)("inlineCode",{parentName:"p"},"constant")," \u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u6307\u9488\u6216\u5f15\u7528\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-c"},"template<typename T>\n    T get_buffer(uint index) const\n")),(0,a.kt)("p",null,"\u8c03\u7528\u4ee5\u4e0b\u6210\u5458\u51fd\u6570\u4ee5\u8fd4\u56de ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_function_table")," \u7d22\u5f15\u5904\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"visible_function_table<T>"),"\u3002",(0,a.kt)("inlineCode",{parentName:"p"},"T")," \u662f\u5b58\u50a8\u5728\u8868\u4e2d\u7684\u51fd\u6570\u7684\u7b7e\u540d\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-c"},"template <typename T> visible_function_table<T>\n    get_visible_function_table(uint index) const;\n")),(0,a.kt)("p",null,"Metal 3.1 \u652f\u6301\u4ee5\u4e0b\u51fd\u6570\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"set_buffer")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"set_visible_function_table"))),(0,a.kt)("p",null,"\u8c03\u7528\u4ee5\u4e0b\u6210\u5458\u51fd\u6570\u4ee5\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_function_table")," \u6761\u76ee\u4e2d\u7684\u7d22\u5f15\u4f4d\u7f6e\u5904\u8bbe\u7f6e ",(0,a.kt)("inlineCode",{parentName:"p"},"device")," \u6216 ",(0,a.kt)("inlineCode",{parentName:"p"},"constant")," \u7f13\u51b2\u533a\u5bf9\u8c61\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-c"},"void set_buffer(const device void *buf, uint index)\nvoid set_buffer(constant void *buf, uint index)\n")),(0,a.kt)("p",null,"\u8c03\u7528\u4ee5\u4e0b\u6210\u5458\u51fd\u6570\u5c06 ",(0,a.kt)("inlineCode",{parentName:"p"},"visible_function_table")," \u8bbe\u7f6e\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_function_table")," \u4e2d\u7684\u7d22\u5f15\u4f4d\u7f6e\uff0c\u5176\u4e2d ",(0,a.kt)("inlineCode",{parentName:"p"},"T")," \u662f\u5b58\u50a8\u5728\u8868\u4e2d\u7684\u51fd\u6570\u7684\u7b7e\u540d\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-c"},"template<typename T>\n    void set_visible_function_table(visible_function_table<T> vft,\n                                    uint index)\n")),(0,a.kt)("h2",{id:"\u4ea4\u96c6\u7ed3\u679c\u7c7b\u578b"},"\u4ea4\u96c6\u7ed3\u679c\u7c7b\u578b"),(0,a.kt)("p",null,"\u4ea4\u96c6\u7684\u7ed3\u679c\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_result<intersection_tags...>")," \u7ed3\u6784\u4e2d\u8fd4\u56de\uff0c\u5176\u4e2d ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_tags")," \u5728\u8868 2.9 \u4e2d\u5b9a\u4e49\u3002\u8fd4\u56de\u7ed3\u6784\u5b9a\u4e49\u4e3a\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp"},"class intersection_type {\n    none,\n    triangle,\n    bounding_box,\n    curve          // Available as of Metal 3.1\n};\n\ntemplate <typename...intersection_tags>\nstruct intersection_result\n{\n    intersection_type type;\n    float distance;\n    uint primitive_id;\n    uint geometry_id;\n\n    const device void *primitive_data;  // Available as of Metal 3\n\n    // Available only if intersection_tags include instancing without   // max_levels<Count>\n    uint instance_id;\n    uint user_instance_id; // Available as of Metal 2.4\n\n    // As of Metal 3.1, replaces instance_id and user_instance_id with\n    // an array if intersection_tags include instancing and\n    // max_levels<Count>.\n    uint instance_count;              // The number of instances intersected by the ray.\n    uint instance_id[Count - 1];      // The instance IDs of instances intersected by the ray.\n    uint user_instance_id[Count - 1]; // The user instance IDs of instances intersected by the ray.\n\n\n    // Available only if intersection_tags include triangle_data.\n    float2 triangle_barycentric_coord;\n    bool triangle_front_facing;\n\n    // As of Metal 2.4, the following is available only if\n    // intersection_tags include world_space_data and instancing\n    float4x3 world_to_object_transform;\n    float4x3 object_to_world_transform;\n\n    // As of Metal 3.1, the following is available only if\n    // intersection_tags include curve_data.\n    float curve_parameter;\n};\n")),(0,a.kt)("p",null,"\u5982\u679c ",(0,a.kt)("inlineCode",{parentName:"p"},"ray")," \u65e0\u6548\uff0c\u5219\u8fd4\u56de ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection::none"),"\u3002"),(0,a.kt)("p",null,"\u8fd4\u56de\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"distance")," \u662f\u5728\u4e16\u754c\u7a7a\u95f4\u4e2d\u3002"),(0,a.kt)("p",null,"\u5bf9\u4e8e\u9876\u70b9\u5c5e\u6027 ",(0,a.kt)("inlineCode",{parentName:"p"},"v0"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"v1")," \u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"v2"),"\uff0c\u6307\u5b9a\u4e09\u89d2\u5f62\u91cd\u5fc3\u70b9\u5904\u7684\u5c5e\u6027\u503c\u4e3a\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp"},"v1 * triangle_barycentric_coord.x +\nv2 * triangle_barycentric_coord.y +\nv0 * (1.0f - (triangle_barycentric_coord.x + triangle_barycentric_coord.y))\n")),(0,a.kt)("h2",{id:"\u4ea4\u53c9\u7ebf\u7c7b\u578b"},"\u4ea4\u53c9\u7ebf\u7c7b\u578b"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"intersector<intersection_tags...>")," \u7ed3\u6784\u7c7b\u578b\u5b9a\u4e49\u4e86\u4e00\u4e2a\u63a7\u5236\u52a0\u901f\u7ed3\u6784\u904d\u5386\u7684\u5bf9\u8c61\uff0c\u5e76\u5b9a\u4e49\u4e86\u50cf ",(0,a.kt)("inlineCode",{parentName:"p"},"intersect()")," \u8fd9\u6837\u7684\u4e0e\u5149\u7ebf\u76f8\u4ea4\u7684\u51fd\u6570\u3002\u521b\u5efa\u4ea4\u96c6\u65f6\uff0c\u8bf7\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_tags"),"\uff08\u5982\u8868 2.9 \u4e2d\u6240\u8ff0\uff09\u6765\u4e13\u95e8\u8bf4\u660e\u5176\u8fd0\u884c\u7684\u52a0\u901f\u7ed3\u6784\u7c7b\u578b\u4ee5\u53ca\u53ef\u7528\u7684\u529f\u80fd\uff08\u8bf7\u53c2\u9605\u7b2c 6.18.2 \u8282\uff09\u3002\u76f8\u4ea4\u7c7b\u578b\u4e0a\u7684\u76f8\u4ea4\u6807\u8bb0\u5fc5\u987b\u4e0e\u5176\u5173\u8054\u7684\u76f8\u4ea4\u51fd\u6570\u76f8\u5339\u914d\uff08\u7b2c 5.1.6 \u8282\uff09\uff0c\u5426\u5219\u884c\u4e3a\u672a\u5b9a\u4e49\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp"},"// Create a default intersector\nintersector<> primitiveIntersector;\n\n// Create an intersector that is specialized to support triangle and\n// world space data.\nintersector<triangle_data, instancing, world_space_data> instanceInter;\n")),(0,a.kt)("p",null,"intersector \u7ed3\u6784\u7c7b\u578b\u4e3a 2.17.5 \u8282\u4e2d\u5b9a\u4e49\u7684\u4ea4\u96c6\u7ed3\u679c\u7c7b\u578b\u63d0\u4f9b\u4e86\u4e00\u79cd\u65b9\u4fbf\u7684\u7c7b\u578b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp"},"intersector<intersection_tags...>::result\n")),(0,a.kt)("h2",{id:"\u52a0\u901f\u7ed3\u6784\u7c7b\u578b"},"\u52a0\u901f\u7ed3\u6784\u7c7b\u578b"),(0,a.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u4ece Metal 2.3 \u5f00\u59cb\u652f\u6301\u52a0\u901f\u7ed3\u6784\u7c7b\u578b\u3002"),(0,a.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2.4 \u8d77\u652f\u6301\u52a0\u901f\u7ed3\u6784\u6a21\u677f\u7c7b\u578b\u3002"),(0,a.kt)("p",null,"Metal 2.3 \u652f\u6301\u4e24\u79cd\u7c7b\u578b\u7684\u52a0\u901f\u7ed3\u6784\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"primitive_acceleration_structure")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instance_acceleration_structure"))),(0,a.kt)("p",null,"\u8fd9\u4e9b\u662f\u4e0d\u900f\u660e\u5bf9\u8c61\uff0c\u53ef\u4ee5\u4f7f\u7528\u7f13\u51b2\u533a\u7ed1\u5b9a\u70b9\u6216\u901a\u8fc7\u53c2\u6570\u7f13\u51b2\u533a\u76f4\u63a5\u7ed1\u5b9a\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp"},"struct AccelerationStructs {\n    primitive_acceleration_structure prim_accel;\n    instance_acceleration_structure inst_accel;\n    array<primitive_acceleration_structure, 2> prim_accel_array;\n    array<instance_acceleration_structure, 2>  inst_accel_array;\n};\n\n[[kernel]]\nvoid intersectInstancesKernel(\n    primitive_acceleration_structure prim_accel [[buffer(0)]],\n    instance_acceleration_structure inst_accel [[buffer(1)]],\n    device AccelerationStructs *accels [[buffer(3)]]\n) {\n    // ...\n}\n")),(0,a.kt)("p",null,"\u53ef\u4ee5\u521b\u5efa\u6b64\u7c7b\u7c7b\u578b\u7684\u9ed8\u8ba4\u521d\u59cb\u5316\u53d8\u91cf\uff0c\u5e76\u4e14\u9ed8\u8ba4\u503c\u662f\u52a0\u901f\u7ed3\u6784\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"null"),"\u3002"),(0,a.kt)("p",null,"\u5728 Metal 2.4 \u4e2d\uff0c\u52a0\u901f\u7ed3\u6784\u88ab\u6a21\u677f\u5316\u7c7b\u578b ",(0,a.kt)("inlineCode",{parentName:"p"},"acceleration_structure<intersection_tags...>")," \u53d6\u4ee3\u3002\u6a21\u677f\u53c2\u6570 ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_tags")," \u53ef\u4ee5\u4e3a\u7a7a\uff0c\u4e5f\u53ef\u4ee5\u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"instancing"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"primitive_motion")," \u6216 ",(0,a.kt)("inlineCode",{parentName:"p"},"instance_motion")," \u7684\u7ec4\u5408\uff0c\u5982\u8868 2.9 \u4e2d\u6240\u5b9a\u4e49\u3002\u4ea4\u53c9\u70b9\u6807\u7b7e\uff08Intersection Tags\uff09\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u5b9a\u4e49\u4e86\u4e00\u4e2a\u652f\u6301\u539f\u59cb\u8fd0\u52a8\u7684\u5b9e\u4f8b\u52a0\u901f\u7ed3\u6784\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp"},"acceleration_structure<instancing, primitive_motion> accel_struct;\n")),(0,a.kt)("p",null,"\u4ee5\u4e0b\u6807\u7b7e\u7ec4\u5408\u53ef\u7528\u4e8e\u58f0\u660e\u539f\u59cb\u52a0\u901f\u7ed3\u6784"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"no ",(0,a.kt)("inlineCode",{parentName:"li"},"tags")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion"))),(0,a.kt)("p",null,"\u4ee5\u4e0b\u6807\u7b7e\u7ec4\u5408\u53ef\u7528\u4e8e\u58f0\u660e\u5b9e\u4f8b\u52a0\u901f\u7ed3\u6784"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"primitive_motion"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"instance_motion"))),(0,a.kt)("p",null,"\u4e3a\u4e86\u4fdd\u6301\u5411\u540e\u517c\u5bb9\u6027\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"primitive_acceleration_struct")," \u88ab\u522b\u540d\u4e3a ",(0,a.kt)("inlineCode",{parentName:"p"},"acceleration_struct<>"),"\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"instance_acceleration_struct")," \u88ab\u522b\u540d\u4e3a ",(0,a.kt)("inlineCode",{parentName:"p"},"acceleration_struct<instancing>"),"\u3002"),(0,a.kt)("p",null,"\u548c\u4ee5\u524d\u4e00\u6837\uff0c\u8fd9\u4e9b\u662f\u4e0d\u900f\u660e\u5bf9\u8c61\uff0c\u53ef\u4ee5\u4f7f\u7528\u7f13\u51b2\u533a\u7ed1\u5b9a\u70b9\u6216\u901a\u8fc7\u53c2\u6570\u7f13\u51b2\u533a\u76f4\u63a5\u7ed1\u5b9a\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cpp"},"struct AccelerationMotionStructs {\n    acceleration_structure<primitive_motion> prim_motion_accel;\n    acceleration_structure<instancing, instance_motion> inst_motion_accel;\n    array<acceleration_structure<>, 2> prim_accel_array;\n    array<acceleration_structure<instancing>, 2> inst_accel_array;\n};\n\n[[kernel]]\nvoid intersectMotionKernel(\n    acceleration_structure<primitive_motion> prim [[buffer(15)]],\n    acceleration_structure<instancing, primitive_motion, instance_motion> inst [[buffer(16)]],\n    device AccelerationMotionStructs *accels [[buffer(17)]]\n) {\n    // ...\n}\n")),(0,a.kt)("p",null,"\u5c06\u8fd9\u4e9b\u52a0\u901f\u7ed3\u6784\u4ece Metal API \u7ed1\u5b9a\u5230\u8ba1\u7b97\u6216\u56fe\u5f62\u51fd\u6570\u65f6\uff0c\u52a0\u901f\u7ed3\u6784\u7684\u7c7b\u578b\u5fc5\u987b\u4e0e\u7740\u8272\u5668\u4e2d\u5b9a\u4e49\u7684\u7c7b\u578b\u76f8\u5339\u914d\u3002\u4f8b\u5982\u52a0\u901f\u7ed3\u6784\uff0c\u53ef\u4ee5\u5c06\u4e0d\u652f\u6301 ",(0,a.kt)("inlineCode",{parentName:"p"},"primitive_motion")," \u7684\u5b9e\u4f8b\u52a0\u901f\u7ed3\u6784\u7ed1\u5b9a\u5230\u9700\u8981\u5177\u6709 ",(0,a.kt)("inlineCode",{parentName:"p"},"primitive_motion")," \u7684\u5b9e\u4f8b\u52a0\u901f\u7ed3\u6784\u7684\u7740\u8272\u5668\u3002\u4f8b\u5982\uff0c\u5177\u6709\u5b9e\u4f8b\u52a0\u901f\u7ed3\u6784\u7684 Metal \u7f13\u51b2\u533a\u53ef\u4ee5\u4f20\u9012\u7ed9\u5177\u6709 ",(0,a.kt)("inlineCode",{parentName:"p"},"acceleration_structure<instancing>")," \u7684\u7740\u8272\u5668\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"p"},"acceleration_structure<instancing, primitive_motion>")," \u4f20\u9012\u7ed9\u7740\u8272\u5668\u3002\u8fd9\u4e00\u529f\u80fd\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u7f16\u5199\u4e00\u4e2a\u7740\u8272\u5668\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u53ef\u4ee5\u5904\u7406\u5e26\u6709\u6216\u4e0d\u5e26\u6709 ",(0,a.kt)("inlineCode",{parentName:"p"},"primitive_motion")," \u7684\u52a0\u901f\u7ed3\u6784\uff0c\u4f46\u4ee3\u4ef7\u662f\u5149\u7ebf\u8ffd\u8e2a\u8fd0\u884c\u65f6\u68c0\u67e5\u57fa\u5143\u8fd0\u52a8\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u6210\u672c\uff0c\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u7f16\u5199\u4e24\u4e2a\u51fd\u6570\uff0c\u5176\u4e2d\u4e00\u4e2a\u4f7f\u7528\u5e26 ",(0,a.kt)("inlineCode",{parentName:"p"},"primitive_motion")," \u7684\u52a0\u901f\u7ed3\u6784\uff0c\u53e6\u4e00\u4e2a\u4e0d\u4f7f\u7528\u3002"),(0,a.kt)("p",null,"\u6709\u5173\u52a0\u901f\u7ed3\u6784\u4e3a\u7a7a\u65f6\u8981\u8c03\u7528\u7684\u51fd\u6570\uff0c\u8bf7\u53c2\u9605\u7b2c 6.18.1 \u8282\u3002"),(0,a.kt)("h2",{id:"\u4ea4\u96c6\u67e5\u8be2\u7c7b\u578b"},"\u4ea4\u96c6\u67e5\u8be2\u7c7b\u578b"),(0,a.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2. 4 \u8d77\u652f\u6301\u4ea4\u53c9\u53e3\u67e5\u8be2"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"intersection_query<intersection_tags...>")," \u7c7b\u578b\u5b9a\u4e49\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f7f\u7528\u6237\u80fd\u591f\u5b8c\u5168\u63a7\u5236\u5149\u7ebf\u8ddf\u8e2a\u8fc7\u7a0b\u4ee5\u53ca\u4f55\u65f6\u8c03\u7528\u81ea\u5b9a\u4e49\u76f8\u4ea4\u4ee3\u7801\u3002\u8def\u53e3\u67e5\u8be2\u5bf9\u8c61\u63d0\u4f9b\u4e86\u4e00\u7ec4\u51fd\u6570\uff0c\u901a\u8fc7\u52a0\u901f\u7ed3\u6784\u548c\u67e5\u8be2\u904d\u5386\u4fe1\u606f\u6765\u63a8\u8fdb\u67e5\u8be2\u3002\u5728\u521b\u5efa ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_query<intersection_tags...>")," \u7c7b\u578b\u65f6\uff0c\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"intersection_tags"),"\uff08\u5728\u8868 2.9 \u4e2d\u5b9a\u4e49\uff09\u6765\u4e13\u95e8\u6307\u5b9a\u52a0\u901f\u7ed3\u6784\u7684\u7c7b\u578b\u4ee5\u53ca\u53ef\u7528\u7684\u51fd\u6570\uff08\u8bf7\u53c2\u9605\u7b2c 6.18.4 \u8282\uff09\u3002\u5b83\u652f\u6301\u4ee5\u4e0b\u4ea4\u53c9\u6807\u7b7e\u7ec4\u5408\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"no ",(0,a.kt)("inlineCode",{parentName:"li"},"tags")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data"))),(0,a.kt)("p",null,"Metal 3.1 \u652f\u6301\u4ee5\u4e0b\u9644\u52a0\u7ec4\u5408\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"max_levels<Count>")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"instancing"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"triangle_data"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"max_levels<Count>"))),(0,a.kt)("p",null,"\u5728 Metal 3.1 \u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"curve_data")," \u53ef\u4ee5\u6dfb\u52a0\u5230\u4e0a\u9762\u5217\u51fa\u7684\u6240\u6709\u7ec4\u5408\u4e2d\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"intersection_query<intersection_tags...>")," \u7c7b\u578b\u6709\u4ee5\u4e0b\u9650\u5236"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5b83\u4e0d\u80fd\u7528\u4e8e\u7ed3\u6784/\u8054\u5408\u7684\u6210\u5458"),(0,a.kt)("li",{parentName:"ul"},"\u5b83\u4e0d\u80fd\u4ece\u51fd\u6570\u8fd4\u56de"),(0,a.kt)("li",{parentName:"ul"},"\u5b83\u4e0d\u80fd\u5206\u914d\u7ed9")),(0,a.kt)("p",null,"\u8fd9\u4e9b\u9650\u5236\u963b\u6b62\u590d\u5236\u4ea4\u96c6\u67e5\u8be2\u5bf9\u8c61\u3002"))}_.isMDXComponent=!0}}]);