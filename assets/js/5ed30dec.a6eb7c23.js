"use strict";(self.webpackChunkswift_tutorials_cn=self.webpackChunkswift_tutorials_cn||[]).push([[4386],{3905:(t,e,n)=>{n.d(e,{Zo:()=>d,kt:()=>c});var l=n(67294);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,l)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e){if(null==t)return{};var n,l,i=function(t,e){if(null==t)return{};var n,l,i={},r=Object.keys(t);for(l=0;l<r.length;l++)n=r[l],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(l=0;l<r.length;l++)n=r[l],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var u=l.createContext({}),o=function(t){var e=l.useContext(u),n=e;return t&&(n="function"==typeof t?t(e):a(a({},e),t)),n},d=function(t){var e=o(t.components);return l.createElement(u.Provider,{value:e},t.children)},_="mdxType",s={inlineCode:"code",wrapper:function(t){var e=t.children;return l.createElement(l.Fragment,{},e)}},k=l.forwardRef((function(t,e){var n=t.components,i=t.mdxType,r=t.originalType,u=t.parentName,d=p(t,["components","mdxType","originalType","parentName"]),_=o(n),k=i,c=_["".concat(u,".").concat(k)]||_[k]||s[k]||r;return n?l.createElement(c,a(a({ref:e},d),{},{components:n})):l.createElement(c,a({ref:e},d))}));function c(t,e){var n=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var r=n.length,a=new Array(r);a[0]=k;var p={};for(var u in e)hasOwnProperty.call(e,u)&&(p[u]=e[u]);p.originalType=t,p[_]="string"==typeof t?t:i,a[1]=p;for(var o=2;o<r;o++)a[o]=n[o];return l.createElement.apply(null,a)}return l.createElement.apply(null,n)}k.displayName="MDXCreateElement"},55444:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>u,contentTitle:()=>a,default:()=>c,frontMatter:()=>r,metadata:()=>p,toc:()=>o});var l=n(87462),i=(n(67294),n(3905));const r={},a="\u51fd\u6570\u53c2\u6570\u548c\u53d8\u91cf",p={unversionedId:"metal-shading-language-specification/function-arguments-and-variables/index",id:"metal-shading-language-specification/function-arguments-and-variables/index",title:"\u51fd\u6570\u53c2\u6570\u548c\u53d8\u91cf",description:"\u56fe\u5f62\uff08\u9876\u70b9\u6216\u7247\u6bb5\uff09\u548c\u5185\u6838\u51fd\u6570\u7684\u5927\u591a\u6570\u8f93\u5165\u548c\u8f93\u51fa\u90fd\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002\uff08\u5e38\u91cf\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u521d\u59cb\u5316\u53d8\u91cf\u548c\u7a0b\u5e8f\u8303\u56f4\u4e2d\u58f0\u660e\u7684\u91c7\u6837\u5668\u662f\u8f93\u5165\u548c\u8f93\u51fa\uff0c\u4e0d\u5fc5\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002\uff09\u4ece Metal 3.1 \u5f00\u59cb\uff0c\u5185\u6838\u3001\u7f51\u683c\u548c\u5bf9\u8c61\u7740\u8272\u5668\u7684\u5185\u7f6e\u8f93\u5165\u53d8\u91cf\u73b0\u5728\u53ef\u4ee5\u5728\u7a0b\u5e8f\u8303\u56f4\u5185\u58f0\u660e\uff0c\u907f\u514d\u5c06\u5b83\u4eec\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002\u5982\u679c\u5b83\u4eec\u672a\u5728\u52a8\u6001\u5e93\u6216\u5355\u72ec\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u51fd\u6570\u4e2d\u4f7f\u7528\uff0c\u5219\u8fd9\u9002\u7528\u3002",source:"@site/docs/metal-shading-language-specification/function-arguments-and-variables/index.mdx",sourceDirName:"metal-shading-language-specification/function-arguments-and-variables",slug:"/metal-shading-language-specification/function-arguments-and-variables/",permalink:"/swift-tutorials-cn/docs/metal-shading-language-specification/function-arguments-and-variables/",draft:!1,editUrl:"https://github.com/zhuanghongji/swift-tutorials-cn/docs/metal-shading-language-specification/function-arguments-and-variables/index.mdx",tags:[],version:"current",lastUpdatedAt:1693285264,formattedLastUpdatedAt:"2023\u5e748\u670829\u65e5",frontMatter:{},sidebar:"metalshadinglanguagespecificationSidebar",previous:{title:"\u51fd\u6570",permalink:"/swift-tutorials-cn/docs/metal-shading-language-specification/functions/"},next:{title:"\u5b58\u50a8\u7c7b\u8bf4\u660e\u7b26",permalink:"/swift-tutorials-cn/docs/metal-shading-language-specification/storage-class-specifiers/"}},u={},o=[{value:"5.2.1 \u5b9a\u4f4d\u7f13\u51b2\u533a\u3001\u7eb9\u7406\u548c\u91c7\u6837\u5668\u53c2\u6570",id:"521-\u5b9a\u4f4d\u7f13\u51b2\u533a\u7eb9\u7406\u548c\u91c7\u6837\u5668\u53c2\u6570",level:2},{value:"5.2.1.1 \u5177\u6709\u8d44\u6e90\u548c\u8f93\u51fa\u5230\u8bbe\u5907\u5185\u5b58\u7684\u9876\u70b9\u51fd\u6570\u793a\u4f8b",id:"5211-\u5177\u6709\u8d44\u6e90\u548c\u8f93\u51fa\u5230\u8bbe\u5907\u5185\u5b58\u7684\u9876\u70b9\u51fd\u6570\u793a\u4f8b",level:2},{value:"5.2.1.2 \u5149\u6805\u987a\u5e8f\u7ec4",id:"5212-\u5149\u6805\u987a\u5e8f\u7ec4",level:2},{value:"5.2.2 \u5b9a\u4f4d\u6bcf\u4e2a\u9876\u70b9\u8f93\u5165\u7684\u5c5e\u6027",id:"522-\u5b9a\u4f4d\u6bcf\u4e2a\u9876\u70b9\u8f93\u5165\u7684\u5c5e\u6027",level:2},{value:"5.2.3 \u5185\u7f6e\u53d8\u91cf\u7684\u5c5e\u6027",id:"523-\u5185\u7f6e\u53d8\u91cf\u7684\u5c5e\u6027",level:2},{value:"5.2.3.1 \u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027",id:"5231-\u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027",level:2},{value:"\u8868 5.2\u3002\u9876\u70b9\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",id:"\u8868-52\u9876\u70b9\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",level:2},{value:"5.2.3.2 \u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027",id:"5232-\u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027",level:2},{value:"\u8868 5.2\u3002\u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",id:"\u8868-52\u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",level:2},{value:"5.2.3.3 \u9876\u70b9\u51fd\u6570\u8f93\u51fa\u5c5e\u6027",id:"5233-\u9876\u70b9\u51fd\u6570\u8f93\u51fa\u5c5e\u6027",level:2},{value:"\u8868 5.3\u3002\u9876\u70b9\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027",id:"\u8868-53\u9876\u70b9\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027",level:2},{value:"5.2.3.4 \u7247\u6bb5\u51fd\u6570\u8f93\u5165\u5c5e\u6027",id:"5234-\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u5c5e\u6027",level:2},{value:"\u8868 5.4\u3002\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",id:"\u8868-54\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",level:2},{value:"\u8868 5.5\u3002\u7247\u6bb5\u51fd\u6570\u56fe\u5757\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",id:"\u8868-55\u7247\u6bb5\u51fd\u6570\u56fe\u5757\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",level:2},{value:"5.2.3.5 \u7247\u6bb5\u51fd\u6570\u8f93\u51fa\u5c5e\u6027",id:"5235-\u7247\u6bb5\u51fd\u6570\u8f93\u51fa\u5c5e\u6027",level:2},{value:"\u8868 5.6\u3002\u7247\u6bb5\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027",id:"\u8868-56\u7247\u6bb5\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027",level:2},{value:"5.2.3.6 \u5185\u6838\u51fd\u6570\u8f93\u5165\u5c5e\u6027",id:"5236-\u5185\u6838\u51fd\u6570\u8f93\u5165\u5c5e\u6027",level:2},{value:"\u8868 5.7\u3002\u5185\u6838\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",id:"\u8868-57\u5185\u6838\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",level:2},{value:"\u8868 5.8\u3002\u5185\u6838\u51fd\u6570\u56fe\u5757\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",id:"\u8868-58\u5185\u6838\u51fd\u6570\u56fe\u5757\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",level:2},{value:"5.2.3.7 \u4ea4\u96c6\u51fd\u6570\u8f93\u5165\u5c5e\u6027",id:"5237-\u4ea4\u96c6\u51fd\u6570\u8f93\u5165\u5c5e\u6027",level:2},{value:"\u8868 5.9\u3002\u4ea4\u96c6\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",id:"\u8868-59\u4ea4\u96c6\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027",level:2},{value:"5.2.3.8 \u4ea4\u96c6\u51fd\u6570\u8f93\u51fa\u5c5e\u6027",id:"5238-\u4ea4\u96c6\u51fd\u6570\u8f93\u51fa\u5c5e\u6027",level:2},{value:"\u8868 5.10\u3002\u4ea4\u96c6\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027",id:"\u8868-510\u4ea4\u96c6\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027",level:2},{value:"5.2.3.9 \u5bf9\u8c61\u51fd\u6570\u8f93\u5165\u5c5e\u6027",id:"5239-\u5bf9\u8c61\u51fd\u6570\u8f93\u5165\u5c5e\u6027",level:2},{value:"\u8868 5.11\u3002\u5bf9\u8c61\u51fd\u6570\u7684\u5c5e\u6027",id:"\u8868-511\u5bf9\u8c61\u51fd\u6570\u7684\u5c5e\u6027",level:2},{value:"5.2.3.10 \u7f51\u683c\u51fd\u6570\u8f93\u5165\u5c5e\u6027",id:"52310-\u7f51\u683c\u51fd\u6570\u8f93\u5165\u5c5e\u6027",level:2},{value:"\u8868 5.12\u3002\u7f51\u683c\u51fd\u6570\u7684\u5c5e\u6027",id:"\u8868-512\u7f51\u683c\u51fd\u6570\u7684\u5c5e\u6027",level:2},{value:"5.2.4 \u8f93\u5165\u7ec4\u4ef6\u5c5e\u6027",id:"524-\u8f93\u5165\u7ec4\u4ef6\u5c5e\u6027",level:2},{value:"5.2.4.1 \u9876\u70b9\u51fd\u6570\u8f93\u51fa\u793a\u4f8b",id:"5241-\u9876\u70b9\u51fd\u6570\u8f93\u51fa\u793a\u4f8b",level:2},{value:"5.2.4.2 \u7247\u6bb5\u51fd\u6570\u8f93\u5165\u793a\u4f8b",id:"5242-\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u793a\u4f8b",level:2},{value:"5.2.4.3 \u5185\u6838\u51fd\u6570\u6bcf\u7ebf\u7a0b\u8f93\u5165\u793a\u4f8b",id:"5243-\u5185\u6838\u51fd\u6570\u6bcf\u7ebf\u7a0b\u8f93\u5165\u793a\u4f8b",level:2}],d=(_="OrigninalPDF",function(t){return console.warn("Component "+_+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)});var _;const s={toc:o},k="wrapper";function c(t){let{components:e,...n}=t;return(0,i.kt)(k,(0,l.Z)({},s,n,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"\u51fd\u6570\u53c2\u6570\u548c\u53d8\u91cf"},"\u51fd\u6570\u53c2\u6570\u548c\u53d8\u91cf"),(0,i.kt)(d,{title:"5.2 Function Arguments and Variables",mdxType:"OrigninalPDF"}),(0,i.kt)("p",null,"\u56fe\u5f62\uff08\u9876\u70b9\u6216\u7247\u6bb5\uff09\u548c\u5185\u6838\u51fd\u6570\u7684\u5927\u591a\u6570\u8f93\u5165\u548c\u8f93\u51fa\u90fd\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002\uff08\u5e38\u91cf\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u521d\u59cb\u5316\u53d8\u91cf\u548c\u7a0b\u5e8f\u8303\u56f4\u4e2d\u58f0\u660e\u7684\u91c7\u6837\u5668\u662f\u8f93\u5165\u548c\u8f93\u51fa\uff0c\u4e0d\u5fc5\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002\uff09\u4ece Metal 3.1 \u5f00\u59cb\uff0c\u5185\u6838\u3001\u7f51\u683c\u548c\u5bf9\u8c61\u7740\u8272\u5668\u7684\u5185\u7f6e\u8f93\u5165\u53d8\u91cf\u73b0\u5728\u53ef\u4ee5\u5728\u7a0b\u5e8f\u8303\u56f4\u5185\u58f0\u660e\uff0c\u907f\u514d\u5c06\u5b83\u4eec\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002\u5982\u679c\u5b83\u4eec\u672a\u5728\u52a8\u6001\u5e93\u6216\u5355\u72ec\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u51fd\u6570\u4e2d\u4f7f\u7528\uff0c\u5219\u8fd9\u9002\u7528\u3002"),(0,i.kt)("p",null,"\u56fe\u5f62\u548c\u5185\u6838\u51fd\u6570\u7684\u53c2\u6570\u53ef\u4ee5\u662f\u4ee5\u4e0b\u4efb\u4f55\u4e00\u4e2a\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u8bbe\u5907\u7f13\u51b2\u533a\u2014\u2014\u6307\u5411\u8bbe\u5907\u5730\u5740\u7a7a\u95f4\u4e2d\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u7684\u6307\u9488\u6216\u5f15\u7528\uff08\u53c2\u89c1\u7b2c 2.8 \u8282\uff09\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u5e38\u91cf\u7f13\u51b2\u533a\u2014\u2014\u6307\u5411\u5e38\u91cf\u5730\u5740\u7a7a\u95f4\u4e2d\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u7684\u6307\u9488\u6216\u5f15\u7528\uff08\u53c2\u89c1\u7b2c 2.8 \u8282\uff09\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u7eb9\u7406\u5bf9\u8c61\uff08\u53c2\u89c1\u7b2c 2.9 \u8282\uff09\u6216\u7eb9\u7406\u6570\u7ec4\u3002"),(0,i.kt)("li",{parentName:"ul"},"texture_buffer \u5bf9\u8c61\uff08\u53c2\u89c1\u7b2c 2.9.1 \u8282\uff09\u6216\u7eb9\u7406\u7f13\u51b2\u533a\u6570\u7ec4\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u91c7\u6837\u5668\u5bf9\u8c61\uff08\u53c2\u89c1\u7b2c 2.10 \u8282\uff09\u6216\u91c7\u6837\u5668\u6570\u7ec4\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u7ebf\u7a0b\u4e4b\u95f4\u5171\u4eab\u7684\u7f13\u51b2\u533a"),(0,i.kt)("li",{parentName:"ul"},"\u6307\u5411\u7ebf\u7a0b\u7ec4\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u7c7b\u578b\u7684\u6307\u9488\uff0c\u53ea\u80fd\u7528\u4f5c\u5185\u6838\u51fd\u6570\u7684\u53c2\u6570\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u56fe\u50cf\u5757\uff08\u53c2\u89c1\u7b2c 2.11 \u8282\uff09\u3002- \u53c2\u6570\u7f13\u51b2\u533a\uff08\u53c2\u89c1\u7b2c 2.13 \u8282\uff09\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u5185\u6838\u51fd\u6570\u7684\u53ef\u89c1\u51fd\u6570\u8868\uff08\u53c2\u89c1\u7b2c 2.15 \u8282\uff09\u3002\u4ece Metal 2.4 \u5f00\u59cb\uff0c\u53ef\u89c1\u51fd\u6570\u8868\u4e5f\u53ef\u4ee5\u7528\u4e8e\u56fe\u5f62\u51fd\u6570\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u6838\u51fd\u6570\u7684\u4ea4\u96c6\u51fd\u6570\u8868\uff08\u53c2\u89c1\u7b2c 2.17.3 \u8282\uff09\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u7528\u4e8e\u4ea4\u96c6\u51fd\u6570\u7684\u52a0\u901f\u7ed3\u6784\uff08\u53c2\u89c1\u7b2c 6.18.1 \u8282\uff09\u3002- \u5305\u542b\u7f13\u51b2\u533a\u3001\u7eb9\u7406\u6216\u7eb9\u7406\u7f13\u51b2\u533a\u5143\u7d20\u7684\u7ed3\u6784\u3002")),(0,i.kt)("p",null,"\u6307\u5b9a\u4e3a\u56fe\u5f62\u6216\u5185\u6838\u51fd\u6570\u7684\u53c2\u6570\u503c\u7684\u7f13\u51b2\u533a\uff08\u8bbe\u5907\uff09\u4e0d\u80fd\u4f7f\u7528\u522b\u540d\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f5c\u4e3a\u53c2\u6570\u503c\u4f20\u9012\u7684\u7f13\u51b2\u533a\u4e0d\u80fd\u4e0e\u4f20\u9012\u7ed9\u540c\u4e00\u56fe\u5f62\u6216\u5185\u6838\u51fd\u6570\u7684\u5355\u72ec\u53c2\u6570\u7684\u53e6\u4e00\u4e2a\u7f13\u51b2\u533a\u91cd\u53e0\u3002"),(0,i.kt)("p",null,"\u4f60\u4e0d\u80fd\u5c06\u56fe\u5f62\u548c\u5185\u6838\u51fd\u6570\u7684\u53c2\u6570\u58f0\u660e\u4e3a size_t\u3001ptrdiff_t \u7c7b\u578b\uff0c\u6216\u8005\u5305\u542b\u58f0\u660e\u4e3a\u8fd9\u4e9b\u5185\u7f6e\u6807\u91cf\u7c7b\u578b\u4e4b\u4e00\u7684\u6210\u5458\u7684\u7ed3\u6784\u548c/\u6216\u8054\u5408\u3002"),(0,i.kt)("p",null,"\u8fd9\u4e9b\u51fd\u6570\u7684\u53c2\u6570\u901a\u5e38\u7528\u5c5e\u6027\u6765\u6307\u5b9a\uff0c\u4ee5\u63d0\u4f9b\u5bf9\u5176\u4f7f\u7528\u7684\u8fdb\u4e00\u6b65\u6307\u5bfc\u3002\u5c5e\u6027\u7528\u4e8e\u6307\u5b9a\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u53c2\u6570\u7684\u8d44\u6e90\u4f4d\u7f6e\uff08\u53c2\u89c1\u7b2c 5.2.1 \u8282\uff09\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u652f\u6301\u56fa\u5b9a\u529f\u80fd\u548c\u53ef\u7f16\u7a0b\u6d41\u6c34\u7ebf\u7ea7\u4e4b\u95f4\u6570\u636e\u901a\u4fe1\u7684\u5185\u7f6e\u53d8\u91cf\uff08\u53c2\u89c1\u7b2c 5.2.3 \u8282\uff09\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u54ea\u4e9b\u6570\u636e\u6cbf\u7740\u7ba1\u9053\u4ece\u9876\u70b9\u51fd\u6570\u53d1\u9001\u5230\u7247\u6bb5\u51fd\u6570\uff08\u53c2\u89c1\u7b2c 5.2.4 \u8282\uff09\u3002")),(0,i.kt)("h2",{id:"521-\u5b9a\u4f4d\u7f13\u51b2\u533a\u7eb9\u7406\u548c\u91c7\u6837\u5668\u53c2\u6570"},"5.2.1 \u5b9a\u4f4d\u7f13\u51b2\u533a\u3001\u7eb9\u7406\u548c\u91c7\u6837\u5668\u53c2\u6570"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u6bcf\u4e2a\u53c2\u6570\uff0c\u53ef\u4ee5\u9009\u62e9\u6307\u5b9a\u4e00\u4e2a\u5c5e\u6027\u6765\u6807\u8bc6\u7528\u4e8e\u8be5\u53c2\u6570\u7c7b\u578b\u7684\u7f13\u51b2\u533a\u3001\u7eb9\u7406\u6216\u91c7\u6837\u5668\u7684\u4f4d\u7f6e\u3002Metal \u6846\u67b6 API \u4f7f\u7528\u6b64\u5c5e\u6027\u6765\u6807\u8bc6\u8fd9\u4e9b\u53c2\u6570\u7c7b\u578b\u7684\u4f4d\u7f6e\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u8bbe\u5907\u548c\u5e38\u91cf\u7f13\u51b2\u533a\uff1a",(0,i.kt)("inlineCode",{parentName:"li"},"[[buffer(index)]]")),(0,i.kt)("li",{parentName:"ul"},"\u7eb9\u7406\uff08\u5305\u62ec\u7eb9\u7406\u7f13\u51b2\u533a\uff09\uff1a",(0,i.kt)("inlineCode",{parentName:"li"},"[[texture(index)]]")),(0,i.kt)("li",{parentName:"ul"},"\u91c7\u6837\u5668\uff1a",(0,i.kt)("inlineCode",{parentName:"li"},"[[sampler(index)]]")),(0,i.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u7ec4\u7f13\u51b2\u533a\uff1a",(0,i.kt)("inlineCode",{parentName:"li"},"[[threadgroup(index) )]]"))),(0,i.kt)("p",null,"\u7d22\u5f15\u503c\u662f\u4e00\u4e2a\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u7528\u4e8e\u6807\u8bc6\u5206\u914d\u7684\u7f13\u51b2\u533a\u3001\u7eb9\u7406\u6216\u91c7\u6837\u5668\u53c2\u6570\u7684\u4f4d\u7f6e\u3002\uff08\u7eb9\u7406\u7f13\u51b2\u533a\u662f\u4e00\u79cd\u7279\u5b9a\u7c7b\u578b\u7684\u7eb9\u7406\u3002\uff09\u6b63\u786e\u7684\u8bed\u6cd5\u662f\u5c5e\u6027\u9075\u5faa\u53c2\u6570\u6216\u53d8\u91cf\u540d\u79f0\u3002"),(0,i.kt)("p",null,"\u4e0b\u9762\u7684\u793a\u4f8b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5185\u6838\u51fd\u6570 add_vectors\uff0c\u5b83\u5c06\u8bbe\u5907\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u4e24\u4e2a\u7f13\u51b2\u533a inA \u548c inB \u7684\u6570\u7ec4\u76f8\u52a0\uff0c\u5e76\u5c06\u7ed3\u679c\u8fd4\u56de\u5230\u7f13\u51b2\u533a out \u4e2d\u3002\u5c5e\u6027 (buffer(index)) \u6307\u5b9a\u51fd\u6570\u53c2\u6570\u7684\u7f13\u51b2\u533a\u4f4d\u7f6e\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},"[[kernel]] void\nadd_vectors(const device float4 *inA [[buffer(0)]],\n  const device float4 *inB [[buffer(1)]],\n  device float4 *out [[buffer(2)]],\n  uint id [[thread_position_in_grid]])\n{\n  out[id] = inA[id] + inB[id];\n}\n")),(0,i.kt)("p",null,"\u4e0b\u9762\u7684\u793a\u4f8b\u663e\u793a\u4e86\u7528\u4e8e\u51e0\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u51fd\u6570\u53c2\u6570\uff08\u7f13\u51b2\u533a\u3001\u7eb9\u7406\u548c\u91c7\u6837\u5668\uff09\u7684\u5c5e\u6027\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},"[[kernel]] void\nmy_kernel(device float4 *p [[buffer(0)]],\ntexture2d<float> img [[texture(0)]],\nsampler sam [[sampler(1)]])\n{\u2026}\n")),(0,i.kt)("p",null,"\u5982\u679c\u672a\u6307\u5b9a\u4f4d\u7f6e\u7d22\u5f15\uff0cMetal \u7f16\u8bd1\u5668\u5c06\u4f7f\u7528\u7b2c\u4e00\u4e2a\u53ef\u7528\u7684\u4f4d\u7f6e\u7d22\u5f15\u6765\u5206\u914d\u5b83\u4eec\u3002\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u4e3a src \u5206\u914d\u7eb9\u7406\u7d22\u5f15 0\u3001dst \u7eb9\u7406\u7d22\u5f15 1\u3001s \u91c7\u6837\u5668\u7d22\u5f15 0 \u548c u \u7f13\u51b2\u533a\u7d22\u5f15 0\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},"kernel void\nmy_kernel(texture2d<half> src,\n      texture2d<half, access::write> dst,\n      sampler s,\n      device myUserInfo *u)\n{\u2026}\n")),(0,i.kt)("p",null,"\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u4e00\u4e9b\u5185\u6838\u53c2\u6570\u5df2\u663e\u5f0f\u5206\u914d\u4f4d\u7f6e\u7d22\u5f15\uff0c\u800c\u53e6\u4e00\u4e9b\u5219\u6ca1\u6709\u3002src \u663e\u5f0f\u5206\u914d\u7eb9\u7406\u7d22\u5f15 0\uff0cf \u663e\u5f0f\u5206\u914d\u7f13\u51b2\u533a\u7d22\u5f15"),(0,i.kt)("ol",{start:10},(0,i.kt)("li",{parentName:"ol"},"\u5982\u679c\u4f7f\u7528\u51fd\u6570\u5e38\u91cf\u5206\u914d\u4f4d\u7f6e\u7d22\u5f15\uff08\u7b2c 5.8 \u8282\uff09\uff0c\u5219\u7f16\u8bd1\u5668\u5728\u5206\u914d\u7d22\u5f15\u65f6\u4e0d\u4f1a\u8003\u8651\u8fd9\u4e9b\u6761\u76ee\u3002\u5176\u4ed6\u53c2\u6570\u5206\u914d\u7b2c\u4e00\u4e2a\u53ef\u7528\u4f4d\u7f6e\u7d22\u5f15\uff1adst \u7eb9\u7406\u7d22\u5f15 1\u3001s \u91c7\u6837\u5668\u7d22\u5f15 0 \u548c u \u7f13\u51b2\u533a\u7d22\u5f15 0\u3002")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},"kernel void\nmy_kernel(texture2d<half> src [[texture(0)]],\n     texture2d<half, access::write> dst,\nsampler s,\ndevice myUserInfo *u,\ndevice float *f [[buffer(10)]])\n{\u2026}\n")),(0,i.kt)("p",null,"\u6bcf\u4e2a\u5c5e\u6027\uff08\u7f13\u51b2\u533a\u3001\u7ebf\u7a0b\u7ec4\u3001\u7eb9\u7406\u548c\u91c7\u6837\u5668\uff09\u4ee3\u8868\u4e00\u7ec4\u8d44\u6e90\u3002\u53c2\u6570\u4e0a\u6307\u5b9a\u7684\u7d22\u5f15\u503c\u5728\u6bcf\u4e2a\u8d44\u6e90\u7ec4\u4e2d\u5e94\u662f\u552f\u4e00\u7684\u3002\u5177\u6709\u76f8\u540c\u7d22\u5f15\u503c\u7684\u591a\u4e2a\u7f13\u51b2\u533a\u3001\u7eb9\u7406\u6216\u91c7\u6837\u5668\u53c2\u6570\u4f1a\u751f\u6210\u7f16\u8bd1\u9519\u8bef\uff0c\u9664\u975e\u4f7f\u7528\u51fd\u6570\u5e38\u91cf\u5c5e\u6027\u58f0\u660e\u5b83\u4eec\uff08\u8bf7\u53c2\u9605\u7b2c 5.8.1 \u8282\uff09\u3002"),(0,i.kt)("h2",{id:"5211-\u5177\u6709\u8d44\u6e90\u548c\u8f93\u51fa\u5230\u8bbe\u5907\u5185\u5b58\u7684\u9876\u70b9\u51fd\u6570\u793a\u4f8b"},"5.2.1.1 \u5177\u6709\u8d44\u6e90\u548c\u8f93\u51fa\u5230\u8bbe\u5907\u5185\u5b58\u7684\u9876\u70b9\u51fd\u6570\u793a\u4f8b"),(0,i.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u662f\u4e00\u4e2a\u9876\u70b9\u51fd\u6570 render_vertex\uff0c\u5b83\u8f93\u51fa\u5230\u6570\u7ec4 xform_output \u4e2d\u7684\u8bbe\u5907\u5185\u5b58\uff0c\u8be5\u6570\u7ec4\u662f\u4f7f\u7528 device \u5c5e\u6027\u6307\u5b9a\u7684\u51fd\u6570\u53c2\u6570"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},"struct VertexOutput {\nfloat4 position [[position]];\nfloat4 color;\nfloat2 texcoord;\n};\n\nstruct VertexInput {\nfloat4 position;\nfloat3 normal;\nfloat2 texcoord;\n};\n\nconstexpr constant uint MAX_LIGHTS = 4;\n\nstruct LightDesc {\nuint  num_lights;\nfloat4 light_position[MAX_LIGHTS];\nfloat4 light_color[MAX_LIGHTS];\nfloat4 light_attenuation_factors[MAX_LIGHTS];\n};\n\nvertex void\nrender_vertex(const device VertexInput* v_in [[buffer(0)]],\n    constant float4x4& mvp_matrix [[buffer(1)]],\n    constant LightDesc& light_desc [[buffer(2)]],\n    device VertexOutput* xform_output [[buffer(3)]],\n    uint v_id [[vertex_id]] )\n{\nVertexOutput v_out;\nv_out.position = v_in[v_id].position * mvp_matrix; v_out.color = do_lighting(v_in[v_id].position,\nv_in[v_id].normal, light_desc);\n\nv_out.texcoord = v_in[v_id].texcoord;\n// Output the position to a buffer. xform_output[v_id] = v_out;\n}\n")),(0,i.kt)("h2",{id:"5212-\u5149\u6805\u987a\u5e8f\u7ec4"},"5.2.1.2 \u5149\u6805\u987a\u5e8f\u7ec4"),(0,i.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2 \u8d77\u652f\u6301\u5149\u6805\u987a\u5e8f\u7ec4\u5c5e\u6027\u3002"),(0,i.kt)("p",null,"\u7247\u6bb5\u51fd\u6570\u4e2d\u7684\u7f13\u51b2\u533a\uff08\u5728\u8bbe\u5907\u5185\u5b58\u4e2d\uff09\u548c\u7eb9\u7406\u7684\u52a0\u8f7d\u548c\u5b58\u50a8\u662f\u65e0\u5e8f\u7684\u3002\u7528\u4e8e\u7f13\u51b2\u533a\u6216\u7eb9\u7406\u7684 [","[raster_order_group(index)]","] \u5c5e\u6027"),(0,i.kt)("p",null,"\u5982\u679c\u6bcf\u4e2a\u6837\u672c\u7740\u8272\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\uff0c\u5219\u4fdd\u8bc1\u6620\u5c04\u5230\u76f8\u540c (x,y) \u50cf\u7d20\u5750\u6807\u548c\u6837\u672c\u7684\u4e0d\u540c\u57fa\u5143\u7684\u4efb\u4f55\u91cd\u53e0\u7247\u6bb5\u7684\u8bbf\u95ee\u987a\u5e8f\u3002"),(0,i.kt)("p",null,"[","[raster_order_group(index)]","] \u5c5e\u6027\u53ef\u4ee5\u5728\u7eb9\u7406\uff08\u59cb\u7ec8\u4f4d\u4e8e\u8bbe\u5907\u5185\u5b58\u4e2d\uff09\u6216\u5728\u8bbe\u5907\u5185\u5b58\u4e2d\u58f0\u660e\u7684\u7f13\u51b2\u533a\u4e0a\u6307\u5b9a\uff0c\u4f46\u4e0d\u80fd\u5728\u7ebf\u7a0b\u7ec4\u6216\u5e38\u91cf\u5730\u5740\u7a7a\u95f4\u4e2d\u6307\u5b9a\u3002[","[raster_order_group(index)]","] \u5c5e\u6027\u4e0d\u80fd\u4e0e\u7ed3\u6784\u6216\u7c7b\u4e00\u8d77\u4f7f\u7528\u3002"),(0,i.kt)("p",null,"\u4f7f\u7528 [","[raster_order_group(index)]","] \u5c5e\u6027\u6807\u8bb0\u5bf9\u7f13\u51b2\u533a\u6216\u7eb9\u7406\u7684\u91cd\u53e0\u8bbf\u95ee\u7684\u7247\u6bb5\u51fd\u6570\u8c03\u7528\u7684\u6267\u884c\u987a\u5e8f\u4e0e\u63d0\u4ea4\u51e0\u4f55\u56fe\u5f62\u7684\u987a\u5e8f\u76f8\u540c\u3002\u5bf9\u4e8e\u91cd\u53e0\u7247\u6bb5\u51fd\u6570\u8c03\u7528\uff0c\u7247\u6bb5\u51fd\u6570\u8c03\u7528\u5bf9\u6807\u6709 [","[raster_order_group(index)]","] \u5c5e\u6027\u7684\u7f13\u51b2\u533a\u6216\u7eb9\u7406\u6267\u884c\u7684\u5199\u5165\u9700\u8981\u53ef\u4f9b\u540e\u7eed\u8c03\u7528\u8bfb\u53d6\uff0c\u5e76\u4e14\u4e0d\u5f97\u5f71\u54cd\u5148\u524d\u8c03\u7528\u7684\u8bfb\u53d6\u3002\u540c\u6837\uff0c\u7247\u6bb5\u51fd\u6570\u8c03\u7528\u6267\u884c\u7684\u8bfb\u53d6\u5fc5\u987b\u53cd\u6620\u5148\u524d\u8c03\u7528\u7684\u5199\u5165\uff0c\u5e76\u4e14\u4e0d\u5f97\u53cd\u6620\u540e\u7eed\u8c03\u7528\u7684\u5199\u5165\u3002"),(0,i.kt)("p",null,"[","[raster_order_group(index)]","] \u4e2d\u7684\u7d22\u5f15\u662f\u4e00\u4e2a\u6574\u6570\u503c\uff0c\u5b83\u6307\u5b9a\u5149\u6805\u5668\u987a\u5e8f ID\uff0c\u5b83\u63d0\u4f9b\u5bf9\u52a0\u8f7d\u548c\u5b58\u50a8\u987a\u5e8f\u7684\u66f4\u7ec6\u7c92\u5ea6\u7684\u63a7\u5236\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e24\u4e2a\u7f13\u51b2\u533a A \u548c B \u88ab\u6807\u8bb0\u6709\u4e0d\u540c\u7684\u5149\u6805\u5668\u987a\u5e8f ID \u503c\uff0c\u5219\u53ef\u4ee5\u72ec\u7acb\u5730\u540c\u6b65\u5bf9\u7f13\u51b2\u533a A \u548c B \u7684\u91cd\u53e0\u7247\u6bb5\u7684\u52a0\u8f7d\u548c\u5b58\u50a8\u3002"),(0,i.kt)("p",null,"\u4f8b\u5b50\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},"fragment void\nmy_fragment(texture2d<float, access::read_write> texA\n                             [[raster_order_group(0), texture(0)]], \u2026)\n{\nushort2 coord;\nfloat4 clr = texA.read(coord); // do operations on clr\nclr = \u2026;\ntexA.write(clr, coord);\n}\n")),(0,i.kt)("p",null,"\u5bf9\u4e8e\u53c2\u6570\u7f13\u51b2\u533a\uff0c\u4f60\u53ef\u4ee5\u5728\u7ed3\u6784\u4e2d\u7684\u7f13\u51b2\u533a\u6216\u7eb9\u7406\u6210\u5458\u4e0a\u4f7f\u7528 [","[raster_order_group(index)]","] \u5c5e\u6027\u3002"),(0,i.kt)("h2",{id:"522-\u5b9a\u4f4d\u6bcf\u4e2a\u9876\u70b9\u8f93\u5165\u7684\u5c5e\u6027"},"5.2.2 \u5b9a\u4f4d\u6bcf\u4e2a\u9876\u70b9\u8f93\u5165\u7684\u5c5e\u6027"),(0,i.kt)("p",null,"\u9876\u70b9\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u9876\u70b9\u548c\u5b9e\u4f8b ID \u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u9876\u70b9\u51fd\u6570\u7684\u7f13\u51b2\u533a\u8fdb\u884c\u7d22\u5f15\u6765\u8bfb\u53d6\u6bcf\u4e2a\u9876\u70b9\u7684\u8f93\u5165\u3002\u6b64\u5916\uff0c\u4f60\u8fd8\u53ef\u4ee5\u4f7f\u7528 [","[stage_in]","] \u5c5e\u6027\u58f0\u660e\u6bcf\u4e2a\u9876\u70b9\u8f93\u5165\uff0c\u5e76\u5c06\u8be5\u8f93\u5165\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002\u5bf9\u4e8e\u4f5c\u4e3a\u4f7f\u7528 [","[stage_in]","] \u5c5e\u6027\u58f0\u660e\u7684\u53c2\u6570\u4f20\u9012\u7684\u6bcf\u9876\u70b9\u8f93\u5165\uff0c\u6bcf\u9876\u70b9\u8f93\u5165\u7684\u6bcf\u4e2a\u5143\u7d20\u5fc5\u987b\u5c06\u9876\u70b9\u5c5e\u6027\u4f4d\u7f6e\u6307\u5b9a\u4e3a [","[attribute(index)]","]\u3002\u6709\u5173 [","[stage_in]","] \u5c5e\u6027\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7b2c 5.2.4 \u8282\u3002"),(0,i.kt)("p",null,"\u7d22\u5f15\u503c\u662f\u4e00\u4e2a\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u7528\u4e8e\u6807\u8bc6\u5206\u914d\u7684\u9876\u70b9\u8f93\u5165\u4f4d\u7f6e\u3002\u6b63\u786e\u7684\u8bed\u6cd5\u662f\u5c5e\u6027\u9075\u5faa\u53c2\u6570\u6216\u53d8\u91cf\u540d\u79f0\u3002Metal API \u4f7f\u7528"),(0,i.kt)("p",null,"\u8be5\u5c5e\u6027\u7528\u4e8e\u6807\u8bc6\u9876\u70b9\u7f13\u51b2\u533a\u7684\u4f4d\u7f6e\u5e76\u63cf\u8ff0\u9876\u70b9\u6570\u636e\uff0c\u4f8b\u5982\u4ece\u4e2d\u83b7\u53d6\u6bcf\u4e2a\u9876\u70b9\u6570\u636e\u7684\u7f13\u51b2\u533a\u3001\u5176\u6570\u636e\u683c\u5f0f\u53ca\u5176\u6b65\u5e45\u3002"),(0,i.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u5982\u4f55\u5c06\u9876\u70b9\u5c5e\u6027\u5206\u914d\u7ed9\u4f7f\u7528 stage_in \u5c5e\u6027\u4f20\u9012\u7ed9\u9876\u70b9\u51fd\u6570\u7684\u9876\u70b9\u8f93\u5165\u7ed3\u6784\u7684\u5143\u7d20\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},"struct VertexInput {\nfloat4 position [[attribute(0)]];\nfloat3 normal   [[attribute(1)]];\nhalf4 color     [[attribute(2)]];\nhalf2 texcoord  [[attribute(3)]];\n};\n\nconstexpr constant uint MAX_LIGHTS = 4;\n\nstruct LightDesc {\nuint  num_lights;\nfloat4 light_position[MAX_LIGHTS];\nfloat4 light_color[MAX_LIGHTS];\nfloat4 light_attenuation_factors[MAX_LIGHTS];\n};\n\nconstexpr sampler s = sampler(coord::normalized,\naddress::clamp_to_zero,\n                              filter::linear);\n\nvertex VertexOutput\nrender_vertex(VertexInput v_in [[stage_in]],\n    constant float4x4& mvp_matrix [[buffer(1)]],\n    constant LightDesc& lights [[buffer(2)]],\n    uint v_id [[vertex_id]])\n{\nVertexOutput v_out; \u2026\nreturn v_out;\n}\n")),(0,i.kt)("p",null,"\u4e0b\u9762\u7684\u793a\u4f8b\u663e\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u7f13\u51b2\u533a\u548c stage_in \u5c5e\u6027\u6765\u83b7\u53d6\u9876\u70b9\u51fd\u6570\u4e2d\u7684\u6bcf\u4e2a\u9876\u70b9\u8f93\u5165\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},"struct VertexInput {\nfloat4 position [[attribute(0)]];\nfloat3 normal   [[attribute(1)]];\n};\n\nstruct VertexInput2 {\nhalf4 color;\nhalf2 texcoord[4];\n};\n\n2023-06-02 | Copyright \xa9 2023 Apple Inc. | All Rights Reserved.\nPage 98 of 287\nconstexpr constant uint MAX_LIGHTS = 4;\n\nstruct LightDesc {\nuint  num_lights;\nfloat4 light_position[MAX_LIGHTS];\nfloat4 light_color[MAX_LIGHTS];\nfloat4 light_attenuation_factors[MAX_LIGHTS];\n};\n\nconstexpr sampler s = sampler(coord::normalized,\naddress::clamp_to_zero,\n                              filter::linear);\n\nvertex VertexOutput\nrender_vertex(VertexInput v_in [[stage_in]],\n    VertexInput2 v_in2 [[buffer(0)]],\n    constant float4x4& mvp_matrix [[buffer(1)]],     constant LightDesc& lights [[buffer(2)]],\n    uint v_id [[vertex_id]])\n{\nVertexOutput vOut; \u2026\nreturn vOut;\n}\n")),(0,i.kt)("p",null,"\u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u53ef\u4ee5\u8bfb\u53d6\u6bcf\u4e2a\u9762\u7247\u548c\u9762\u7247\u63a7\u5236\u70b9\u6570\u636e\u3002\u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u5c06\u9762\u7247\u63a7\u5236\u70b9\u6570\u636e\u6307\u5b9a\u4e3a\u4ee5\u4e0b\u6a21\u677f\u5316\u7c7b\u578b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},"patch_control_point<T>\n")),(0,i.kt)("p",null,"\u5176\u4e2d T \u662f\u7528\u6237\u5b9a\u4e49\u7684\u7ed3\u6784\u3002T \u7684\u6bcf\u4e2a\u5143\u7d20\u5fc5\u987b\u4f7f\u7528 [","[attribute(index)]","] \u6307\u5b9a\u5c5e\u6027\u4f4d\u7f6e\u3002"),(0,i.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1.2 \u8d77\u652f\u6301\u8865\u4e01\u63a7\u5236\u70b9\u6a21\u677f\u7c7b\u578b\u3002"),(0,i.kt)("p",null,"patch_control_point \u7c7b\u578b\u652f\u6301\u4ee5\u4e0b\u6210\u5458\u51fd\u6570\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"constexpr size_t size() const; "))),(0,i.kt)("p",null,"\u5b83\u8fd4\u56de\u8865\u4e01\u4e2d\u63a7\u5236\u70b9\u7684\u6570\u91cf\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"constexpr const_reference operator[] (size_t pos) const;"))),(0,i.kt)("p",null,"\u5b83\u8fd4\u56de pos \u6807\u8bc6\u7684\u7279\u5b9a\u6591\u5757\u63a7\u5236\u70b9\u7684\u6570\u636e\u3002"),(0,i.kt)("p",null,"\u4f8b\u5b50\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"},"struct ControlPoint {\nint3 patchParam  [[attribute(0)]];\nfloat3 P         [[attribute(1)]];\nfloat3 P1        [[attribute(2)]];\nfloat3 P2        [[attribute(3)]];\nfloat2 vSegments [[attribute(4)]];\n};\n\nstruct PerPatchData {\nfloat4 patchConstant          [[attribute(5)]];\nfloat4 someOtherPatchConstant [[attribute(6)]];\n};\n\nstruct PatchData {\npatch_control_point<ControlPoint> cp; // Control-point data\nPerPatchData patchData;    // Per-patch data\n};\n\n[[patch(quad)]]\nvertex VertexOutput\npost_tess_vertex_func(PatchData input [[stage_in ]], \u2026)\n{\u2026}\n")),(0,i.kt)("h2",{id:"523-\u5185\u7f6e\u53d8\u91cf\u7684\u5c5e\u6027"},"5.2.3 \u5185\u7f6e\u53d8\u91cf\u7684\u5c5e\u6027"),(0,i.kt)("p",null,"\u4e00\u4e9b\u56fe\u5f62\u64cd\u4f5c\u53d1\u751f\u5728\u56fa\u5b9a\u529f\u80fd\u6d41\u6c34\u7ebf\u9636\u6bb5\uff0c\u9700\u8981\u5411\u56fe\u5f62\u51fd\u6570\u63d0\u4f9b\u503c\u6216\u4ece\u56fe\u5f62\u51fd\u6570\u63a5\u6536\u503c\u3002\u5185\u7f6e\u8f93\u5165\u548c\u8f93\u51fa\u53d8\u91cf\u7528\u4e8e\u5728\u56fe\u5f62\uff08\u9876\u70b9\u548c\u7247\u6bb5\uff09\u51fd\u6570\u548c\u56fa\u5b9a\u529f\u80fd\u56fe\u5f62\u7ba1\u9053\u9636\u6bb5\u4e4b\u95f4\u4f20\u9012\u503c\u3002\u5c5e\u6027\u4e0e\u56fe\u5f62\u51fd\u6570\u7684\u53c2\u6570\u548c\u8fd4\u56de\u7c7b\u578b\u4e00\u8d77\u4f7f\u7528\u6765\u6807\u8bc6\u8fd9\u4e9b\u5185\u7f6e\u53d8\u91cf\u3002"),(0,i.kt)("h2",{id:"5231-\u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027"},"5.2.3.1 \u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027"),(0,i.kt)("p",null,"\u8868 5. 2 \u5217\u51fa\u4e86\u53ef\u4ee5\u4e3a\u9876\u70b9\u51fd\u6570\u7684\u53c2\u6570\u6307\u5b9a\u7684\u5185\u7f6e\u5c5e\u6027\u4ee5\u53ca\u53ef\u4ee5\u4f7f\u7528\u5b83\u4eec\u7684\u76f8\u5e94\u6570\u636e\u7c7b\u578b\u3002"),(0,i.kt)("h2",{id:"\u8868-52\u9876\u70b9\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"},"\u8868 5.2\u3002\u9876\u70b9\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,"``amplification_count macOS\uff1a\u81ea Metal 2.3 \u8d77\u3002iOS\uff1a\u81ea Metal 2.2 \u8d77\u3002````"),(0,i.kt)("p",null,"``` ushort \u6216 uint \u4e3a\u6bcf\u4e2a\u9876\u70b9\u5b9e\u4f8b\u751f\u6210\u7684\u8f93\u51fa\u9876\u70b9\u6570\u3002````"),(0,i.kt)("p",null,"```mplification_id macOS\uff1a\u81ea Metal 2.3 \u8d77\u3002iOS\uff1a\u81ea Metal 2.2 \u8d77\u3002````"),(0,i.kt)("p",null,"``` ushort \u6216 uint \u89c6\u53e3\u548c\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\u7684\u6570\u7ec4\u7d22\u5f15\u504f\u79fb\u6620\u5c04\uff0c\u5b83\u5141\u8bb8\u5c06\u653e\u5927\u7684\u9876\u70b9\u8def\u7531\u5230\u4e0d\u540c\u7684\u89c6\u53e3\u548c\u6e32\u67d3\u76ee\u6807\u3002````"),(0,i.kt)("p",null,"``` base_instance ushort \u6216 uint \u5728\u8bfb\u53d6\u6bcf\u4e2a\u5b9e\u4f8b\u6570\u636e\u4e4b\u524d\u6dfb\u52a0\u5230\u6bcf\u4e2a\u5b9e\u4f8b\u6807\u8bc6\u7b26\u7684\u57fa\u672c\u5b9e\u4f8b\u503c\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,"``` base_vertex ushort \u6216 uint \u5728\u8bfb\u53d6\u6bcf\u4e2a\u9876\u70b9\u6570\u636e\u4e4b\u524d\u6dfb\u52a0\u5230\u6bcf\u4e2a\u9876\u70b9\u6807\u8bc6\u7b26\u7684\u57fa\u672c\u9876\u70b9\u503c\u3002````"),(0,i.kt)("p",null,"``` instance_id ushort \u6216 uint \u6bcf\u4e2a\u5b9e\u4f8b\u7684\u6807\u8bc6\u7b26\uff0c\u5176\u4e2d\u5305\u62ec\u57fa\u672c\u5b9e\u4f8b\u503c\uff08\u5982\u679c\u6307\u5b9a\uff09\u3002````"),(0,i.kt)("p",null,"``` vertex_id ushort \u6216 uint \u6bcf\u4e2a\u9876\u70b9\u6807\u8bc6\u7b26\uff0c\u5176\u4e2d\u5305\u62ec\u57fa\u672c\u9876\u70b9\u503c\uff08\u5982\u679c\u6307\u5b9a\uff09\u3002````"),(0,i.kt)("p",null,"[","[amplification_count]","]\u7684\u9ed8\u8ba4\u503c\u4e3a 1\uff0c\u8868\u793a\u7981\u7528\u9876\u70b9\u653e\u5927\u3002"),(0,i.kt)("p",null,"[","[amplification_id]","] \u7684\u503c\u5e94\u5728 [0,amplification_count) \u8303\u56f4\u5185\u3002"),(0,i.kt)("p",null,"\u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027\u7c7b\u578b\u6ce8\u610f\u4e8b\u9879\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5982\u679c\u58f0\u660e [","[vertex_id]","] \u7684\u7c7b\u578b\u4e3a uint\uff0c\u5219\u58f0\u660e [","[base_vertex]","] \u7684\u7c7b\u578b\u9700\u8981\u4e3a uint \u6216 ushort\u3002- \u5982\u679c\u58f0\u660e [","[vertex_id]","] \u7684\u7c7b\u578b\u4e3a ushort\uff0c\u5219\u58f0\u660e [","[base_vertex]","] \u7684\u7c7b\u578b\u4e5f\u9700\u8981\u4e3a ushort\u3002- \u5982\u679c\u58f0\u660e [","[instance_id]","] \u7684\u7c7b\u578b\u4e3a uint\uff0c\u5219\u58f0\u660e [","[base_instance]","] \u7684\u7c7b\u578b\u9700\u8981\u4e3a uint \u6216 ushort\u3002- \u5982\u679c\u58f0\u660e [","[instance_id]","] \u7684\u7c7b\u578b\u4e3a ushort\uff0c\u5219\u58f0\u660e [","[base_instance]","] \u7684\u7c7b\u578b\u4e5f\u9700\u8981\u4e3a ushort\u3002")),(0,i.kt)("h2",{id:"5232-\u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027"},"5.2.3.2 \u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027"),(0,i.kt)("p",null,"\u8868 5. 3 \u5217\u51fa\u4e86\u53ef\u4ee5\u4e3a\u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u7684\u53c2\u6570\u6307\u5b9a\u7684\u5185\u7f6e\u5c5e\u6027\u4ee5\u53ca\u53ef\u4ee5\u4f7f\u7528\u5b83\u4eec\u7684\u76f8\u5e94\u6570\u636e\u7c7b\u578b\u3002"),(0,i.kt)("h2",{id:"\u8868-52\u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"},"\u8868 5.2\u3002\u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,"``` base_instance ushort \u6216 uint \u5728\u8bfb\u53d6\u6bcf\u4e2a\u5b9e\u4f8b\u6570\u636e\u4e4b\u524d\u6dfb\u52a0\u5230\u6bcf\u4e2a\u5b9e\u4f8b\u6807\u8bc6\u7b26\u7684\u57fa\u672c\u5b9e\u4f8b\u503c\u3002````"),(0,i.kt)("p",null,"``` instance_id ushort \u6216 uint \u6bcf\u4e2a\u5b9e\u4f8b\u7684\u6807\u8bc6\u7b26\uff0c\u5176\u4e2d\u5305\u62ec\u57fa\u672c\u5b9e\u4f8b\u503c\uff08\u5982\u679c\u6307\u5b9a\uff09\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,"``` patch_id ushort \u6216 uint \u8865\u4e01\u6807\u8bc6\u7b26\u3002````"),(0,i.kt)("p",null,"```position_in_patch float2 \u6216 float3 \u5b9a\u4e49\u6b63\u5728\u8bc4\u4f30\u7684\u8865\u4e01\u4e0a\u7684\u4f4d\u7f6e\u3002\u5bf9\u4e8e\u56db\u8fb9\u5f62\u8865\u4e01\uff0c\u5fc5\u987b\u662f float2\u3002\u5bf9\u4e8e\u4e09\u89d2\u5f62\u9762\u7247\uff0c\u5fc5\u987b\u662f float3\u3002````"),(0,i.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1.2 \u8d77\u652f\u6301\u8868 5. 3 \u4e2d\u7684\u6240\u6709\u5c5e\u6027\u3002"),(0,i.kt)("p",null,"\u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027\u6ce8\u610f\u4e8b\u9879\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5982\u679c\u58f0\u660e [","[instance_id]","] \u7684\u7c7b\u578b\u4e3a uint\uff0c\u5219\u58f0\u660e [","[base_instance]","] \u7684\u7c7b\u578b\u9700\u8981\u4e3a uint \u6216 ushort\u3002- \u5982\u679c\u58f0\u660e [","[instance_id]","] \u7684\u7c7b\u578b\u4e3a ushort\uff0c\u5219\u58f0\u660e [","[base_instance]","] \u7684\u7c7b\u578b\u4e5f\u9700\u8981\u4e3a ushort\u3002")),(0,i.kt)("h2",{id:"5233-\u9876\u70b9\u51fd\u6570\u8f93\u51fa\u5c5e\u6027"},"5.2.3.3 \u9876\u70b9\u51fd\u6570\u8f93\u51fa\u5c5e\u6027"),(0,i.kt)("p",null,"\u8868 5. 4 \u5217\u51fa\u4e86\u53ef\u4ee5\u4e3a\u9876\u70b9\u51fd\u6570\u7684\u8fd4\u56de\u7c7b\u578b\u6216\u9876\u70b9\u51fd\u6570\u8fd4\u56de\u7684\u7ed3\u6784\u4f53\u7684\u6210\u5458\u6307\u5b9a\u7684\u5185\u7f6e\u5c5e\u6027\uff08\u53ca\u5176\u76f8\u5e94\u7684\u6570\u636e\u7c7b\u578b\uff09\u3002"),(0,i.kt)("h2",{id:"\u8868-53\u9876\u70b9\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027"},"\u8868 5.3\u3002\u9876\u70b9\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Clip_distance float \u6216 float[n] n \u9700\u8981\u5728\u7f16\u8bd1\u65f6\u77e5\u9053")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u4ece\u9876\u70b9\u5230\u88c1\u526a\u5e73\u9762\u7684\u8ddd\u79bb")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u4e0d\u53d8\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2 .1")),(0,i.kt)("p",null,"`` \u4e0d\u9002\u7528\uff1b\u9700\u8981\u4e0e [","[position]","] ``` \u4e00\u8d77\u4f7f\u7528"),(0,i.kt)("p",null,"``` \u6807\u8bb0\u8f93\u51fa\u4f4d\u7f6e\uff0c\u4ee5\u4fbf\u5982\u679c\u591a\u4e2a\u9876\u70b9\u7740\u8272\u5668\u4e2d\u7528\u4e8e\u8ba1\u7b97\u8f93\u51fa\u4f4d\u7f6e\u7684\u64cd\u4f5c\u5e8f\u5217\u76f8\u540c\uff0c\u5219\u8fd9\u4e9b\u9876\u70b9\u7740\u8272\u5668\u8ba1\u7b97\u7684\u7ed3\u679c\u8f93\u51fa\u4f4d\u7f6e\u5f88\u53ef\u80fd\u662f\u76f8\u540c\u7684\u503c\u3002\u8981\u6c42\u7528\u6237\u4f20\u9012-fpreserve-invariance\u3002\u8bf7\u53c2\u9605\u4e0b\u9762\u7684\u63cf\u8ff0\u4ee5\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"point_size float \u70b9\u57fa\u5143\u7684\u5927\u5c0f")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"position float4 \u53d8\u6362\u540e\u7684\u9876\u70b9\u4f4d\u7f6e")),(0,i.kt)("p",null,"``` render_target_array_ind ex macOS\uff1a\u81ea Metal 1 .1 \u8d77\u3002iOS\uff1a\u81ea Metal 2 .1 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"uchar\u3001ushort \u6216 uint")),(0,i.kt)("p",null,"``` \u5f15\u7528\u4ee5\u4e0b\u4e4b\u4e00\u7684\u6570\u7ec4\u7d22\u5f15\uff1a1) \u7eb9\u7406\u6570\u7ec4\u7684\u6570\u7ec4\u5207\u7247\uff0c2) 3D \u7eb9\u7406\u6307\u5b9a\u6df1\u5ea6\u7684\u6570\u636e\uff0c3) \u7acb\u65b9\u4f53\u8d34\u56fe\u7684\u9762\uff0c\u6216 4) \u7eb9\u7406\u7684\u6307\u5b9a\u9762\u7acb\u65b9\u4f53\u8d34\u56fe\u6570\u7ec4\u7684\u6307\u5b9a\u6570\u7ec4\u5207\u7247\u3002````"),(0,i.kt)("p",null,"``` \u5171\u4eab macOS\uff1a\u81ea Metal 2.3 \u8d77\u3002iOS\uff1a\u81ea Metal 2.2 \u8d77\u3002````"),(0,i.kt)("p",null,"``` \u4e0d\u9002\u7528 \u5982\u679c\u5b58\u5728\uff0c\u5219\u5bf9\u4e8e\u6bcf\u4e2a amplification_id\uff0c\u8f93\u51fa\u5e94\u5177\u6709\u76f8\u540c\u7684\u503c\u3002````"),(0,i.kt)("p",null,"``` viewport_array_index macOS\uff1a\u81ea Metal 2 \u8d77\u3002iOS\uff1a\u81ea Metal 2.1 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"uchar\u3001ushort \u6216 uint")),(0,i.kt)("p",null,"``` \u56fe\u5143\u7684\u89c6\u53e3\uff08\u548c\u526a\u5200\u77e9\u5f62\uff09\u7d22\u5f15\u503c\u3002````"),(0,i.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u652f\u6301\u8868 5. 4 \u4e2d\u7684\u5c5e\u6027\uff0c\u9664\u975e\u53e6\u6709\u8bf4\u660e\u3002"),(0,i.kt)("p",null,"\u7acb\u65b9\u4f53\u8d34\u56fe\u8868\u793a\u4e3a\u5177\u6709\u516d\u5c42\u7684\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\uff0c\u6bcf\u4e2a\u9762\u4e00\u5c42\uff0c[","[render_target_array_index]","] \u662f\u9762\u7d22\u5f15\uff0c\u5176\u503c\u4e3a 0 \u5230 5 \u4e4b\u95f4\u7684\u503c\u3002\u5bf9\u4e8e\u7acb\u65b9\u4f53\u8d34\u56fe\u6570\u7ec4\uff0c[","[render_target_array_index]","] \u4e3a\u8ba1\u7b97\u4e3a\uff1aarray_slice_index"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"6 + \u9762\u6307\u6570\u3002")),(0,i.kt)("p",null,"\u4f60\u5fc5\u987b\u4e3a\u57fa\u5143\u4e2d\u7684\u6bcf\u4e2a\u9876\u70b9\u8fd4\u56de\u76f8\u540c\u7684 [","[render_target_array_index]","] \u503c\u3002\u5982\u679c\u503c\u4e0d\u540c\uff0c\u5219\u4f20\u9012\u7ed9\u7247\u6bb5\u51fd\u6570\u7684\u884c\u4e3a\u548c\u503c\u672a\u5b9a\u4e49\u3002\u76f8\u540c\u7684\u884c\u4e3a\u9002\u7528\u4e8e\u7531\u66f2\u9762\u7ec6\u5206\u751f\u6210\u7684\u56fe\u5143\u3002\u5982\u679c [","[render_target_array_index]","] \u8d8a\u754c\uff08\u5373\u5927\u4e8e\u6216\u7b49\u4e8e renderTargetArrayLength\uff09\uff0c\u5219\u786c\u4ef6\u4f1a\u5c06\u6b64\u503c\u89e3\u91ca\u4e3a 0\u3002\u6709\u5173 [","[render_target_array_index]","] \u4f5c\u4e3a\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7b2c 5.2.3.4 \u8282\u3002"),(0,i.kt)("p",null,"[","[viewport_array_index]","] \u5141\u8bb8\u4ece\u591a\u4e2a\u6d3b\u52a8\u89c6\u53e3\u548c\u526a\u5200\u77e9\u5f62\u6307\u5b9a\u4e00\u4e2a\u89c6\u53e3\u548c\u526a\u5200\u77e9\u5f62\u3002\u5982\u679c\u9876\u70b9\u51fd\u6570\u6ca1\u6709\u6307\u5b9a[","[viewport_array_index]","]\uff0c\u5219\u8f93\u51fa\u89c6\u53e3\u6570\u7ec4\u7d22\u5f15\u503c\u4e3a 0\u3002\u6709\u5173[","[viewport_array_index]","]\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u7b2c 5.10 \u8282\u3002"),(0,i.kt)("p",null,"[","[invariant]","] \u8868\u793a\u591a\u4e2a\u51fd\u6570\u4f20\u9012\u4e2d\u4f7f\u7528\u7684\u6d6e\u70b9\u6570\u5b66\u5fc5\u987b\u751f\u6210\u4e0e\u6bcf\u4e2a\u4f20\u9012\u5b8c\u5168\u5339\u914d\u7684\u9876\u70b9\u4f4d\u7f6e\u3002[","[invariant]","] \u53ea\u80fd\u7528\u4e8e\u9876\u70b9\u51fd\u6570\u4e2d\u7684\u4f4d\u7f6e\uff08\u5177\u6709 [","[position]","] \u5c5e\u6027\u7684\u5b57\u6bb5\uff09\uff0c\u4ee5\u6307\u793a\u8f93\u51fa\u7684\u8ba1\u7b97\u7ed3\u679c\u662f\u4e0d\u53d8\u7684\u3002\u5728 iOS 14.0 \u548c macOS 11.0 \u4e4b\u524d\u7684\u7f16\u8bd1\u5668\u4e2d\uff0c\u8ba1\u7b97\u53ef\u80fd\uff08\u5c3d\u7ba1\u4e0d\u80fd\u4fdd\u8bc1\uff09\u662f\u4e0d\u53d8\u7684\u3002\u73b0\u5728\uff0c\u5f53\u4f20\u9012 - fpreserve-invariance \u9009\u9879\u6216\u4ece Metal API \u7684 MTLCompilerOptions \u8bbe\u7f6e preserveInvariance \u8fdb\u884c\u8fd0\u884c\u65f6\u7f16\u8bd1\u65f6\uff0c\u6b64\u8ba1\u7b97\u4fdd\u8bc1\u4e0d\u53d8\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u672a\u4f20\u9012\u9009\u9879\uff0c\u5219 [","[invariant]","] \u5c06\u88ab\u5ffd\u7565\u3002\u8fd9\u79cd\u4f4d\u7f6e\u4e0d\u53d8\u6027\u5bf9\u4e8e\u9634\u5f71\u4f53\u79ef\u6216 z \u9884\u901a\u9053\u7b49\u6280\u672f\u81f3\u5173\u91cd\u8981\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u9876\u70b9\u51fd\u6570\u7684\u8fd4\u56de\u7c7b\u578b\u4e0d\u662f void\uff0c\u5219\u5b83\u5fc5\u987b\u5305\u542b\u9876\u70b9\u4f4d\u7f6e\u3002\u5982\u679c\u9876\u70b9\u8fd4\u56de\u7c7b\u578b\u662f float4\uff0c\u90a3\u4e48\u5b83\u603b\u662f\u5f15\u7528\u9876\u70b9\u4f4d\u7f6e\uff0c\u5e76\u4e14\u4e0d\u80fd\u6307\u5b9a[","[position]","]\u5c5e\u6027\u3002\u5982\u679c\u9876\u70b9\u8fd4\u56de\u7c7b\u578b\u662f\u7ed3\u6784\u4f53\uff0c\u5219\u5b83\u5fc5\u987b\u5305\u542b\u4f7f\u7528 [","[position]","] \u5c5e\u6027\u58f0\u660e\u7684\u5143\u7d20\u3002"),(0,i.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u63cf\u8ff0\u4e86\u4e00\u4e2a\u540d\u4e3a process_vertex \u7684\u9876\u70b9\u51fd\u6570\u3002\u8be5\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u540d\u4e3a VertexOutput \u7684\u7528\u6237\u5b9a\u4e49\u7ed3\u6784\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u8868\u793a\u9876\u70b9\u4f4d\u7f6e\u7684\u5185\u7f6e\u53d8\u91cf\uff0c\u56e0\u6b64\u9700\u8981 [","[position]","] \u5c5e\u6027\u3002"),(0,i.kt)("p",null,"struct VertexOutput { float4 \u4f4d\u7f6e [","[\u4f4d\u7f6e]","];\u6d6e\u52a8 4 \u989c\u8272\uff1b float2 \u7eb9\u7406\u5750\u6807\uff1b }"),(0,i.kt)("p",null,"\u9876\u70b9 \u9876\u70b9\u8f93\u51fa"),(0,i.kt)("p",null,"process_vertex(...) { VertexOutput v_out; // \u8ba1\u7b97\u6bcf\u4e2a\u9876\u70b9\u7684\u8f93\u51fa"),(0,i.kt)("p",null,"\u8fd4\u56de v_out\uff1b }"),(0,i.kt)("p",null,"\u66f2\u9762\u7ec6\u5206\u540e\u9876\u70b9\u51fd\u6570\u8f93\u51fa\u4e0e\u5e38\u89c4\u9876\u70b9\u51fd\u6570\u76f8\u540c\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u542f\u7528\u9876\u70b9\u653e\u5927\uff0c\u5e76\u4e14\u9876\u70b9\u8f93\u51fa\u53d8\u91cf\u7684\u6bcf\u4e2a [","[amplification_id]","] \u5c5e\u6027\u5177\u6709\u76f8\u540c\u7684\u503c\uff0c\u5219\u9876\u70b9\u8f93\u51fa\u88ab\u89c6\u4e3a",(0,i.kt)("em",{parentName:"p"},"\u5171\u4eab"),"\u3002\u5171\u4eab\u7684\u9876\u70b9\u8f93\u51fa\u53ef\u4ee5\u4f7f\u7528\u5355\u4e2a\u53d8\u5316\u7684\u8f93\u51fa\u69fd\uff0c\u8fd9\u662f\u6709\u9650\u7684\u8d44\u6e90\u3002\u672a\u5171\u4eab\u7684\u9876\u70b9\u8f93\u51fa\u6d88\u8017\u591a\u4e2a\u4e0d\u540c\u7684\u8f93\u51fa\u69fd\u3002\uff08Metal \u6846\u67b6\u8c03\u7528 ","[MTLRenderPipelineDescriptor maxVertexAmplificationCount]"," \u8fd4\u56de\u53ef\u7528\u4e8e\u5c06\u653e\u5927\u7684\u6570\u636e\u4f20\u9012\u5230\u7247\u6bb5\u51fd\u6570\u8c03\u7528\u7684\u53d8\u5316\u69fd\u7684\u6570\u91cf\uff0c\u8fd9\u4f1a\u5f71\u54cd\u53ef\u7528\u53d8\u5316\u69fd\u7684\u603b\u6570\u3002\uff09"),(0,i.kt)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u5185\u7f6e\u9876\u70b9\u8f93\u51fa\u90fd\u662f\u5171\u4eab\u7684\uff0c\u9664\u4e86\u5177\u6709 [","[position]","] \u5c5e\u6027\u7684\u9876\u70b9\u8f93\u51fa\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e0d\u5171\u4eab\u6240\u6709\u5176\u4ed6\u9876\u70b9\u8f93\u51fa\u3002\u8981\u663e\u5f0f\u6307\u5b9a\u8f93\u51fa\u662f\u5171\u4eab\u7684\uff0c\u8bf7\u5c06 [","[shared]","] \u5c5e\u6027\u4e0e\u9876\u70b9\u8f93\u51fa\u53d8\u91cf\u4e00\u8d77\u4f7f\u7528\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u7740\u8272\u5668\u7f16\u8bd1\u5668\u53ef\u4ee5\u63a8\u65ad\u51fa\u9876\u70b9\u8f93\u51fa\u53d8\u91cf\u5bf9\u4e8e\u6bcf\u4e2a amplification_id \u5177\u6709\u76f8\u540c\u7684\u503c\uff0c\u5219\u7f16\u8bd1\u5668\u53ef\u4ee5\u5c06\u8be5\u9876\u70b9\u8f93\u51fa\u6807\u8bb0\u4e3a\u5171\u4eab\u3002\u5728\u4ee5\u4e0b\u4efb\u4f55\u60c5\u51b5\u4e0b\uff0c\u7f16\u8bd1\u5668\u53ef\u80fd\u4e0d\u4f1a\u5c06\u9876\u70b9\u8f93\u51fa\u6807\u8bb0\u4e3a\u5171\u4eab\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u8f93\u51fa\u503c\u53d6\u51b3\u4e8e[","[amplification_id]","]\u3002- \u539f\u5b50\u8bfb-\u4fee\u6539-\u5199\u64cd\u4f5c\u8fd4\u56de\u8f93\u51fa\u503c\u3002- \u7740\u8272\u5668\u4ece\u6613\u5931\u6027\u5b58\u50a8\u5668\u52a0\u8f7d\u8f93\u51fa\u503c\u3002")),(0,i.kt)("h2",{id:"5234-\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u5c5e\u6027"},"5.2.3.4 \u7247\u6bb5\u51fd\u6570\u8f93\u5165\u5c5e\u6027"),(0,i.kt)("p",null,"\u8868 5. 5 \u5217\u51fa\u4e86\u53ef\u4ee5\u4e3a\u7247\u6bb5\u51fd\u6570\u7684\u53c2\u6570\u6307\u5b9a\u7684\u5185\u7f6e\u5c5e\u6027\uff08\u53ca\u5176\u76f8\u5e94\u7684\u6570\u636e\u7c7b\u578b\uff09\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u9876\u70b9\u51fd\u6570\u7684\u8fd4\u56de\u7c7b\u578b\u4e0d\u662f void\uff0c\u5219\u5b83\u5fc5\u987b\u5305\u542b\u9876\u70b9\u4f4d\u7f6e\u3002\u5982\u679c\u9876\u70b9\u8fd4\u56de\u7c7b\u578b\u662f float4\uff0c\u5219\u5b83\u59cb\u7ec8\u6307\u7684\u662f\u9876\u70b9\u4f4d\u7f6e\uff08\u5e76\u4e14\u4e0d\u9700\u8981\u6307\u5b9a [","[position]","] \u5c5e\u6027\uff09\u3002\u5982\u679c\u9876\u70b9\u8fd4\u56de\u7c7b\u578b\u662f\u7ed3\u6784\u4f53\uff0c\u5219\u5b83\u5fc5\u987b\u5305\u542b\u4f7f\u7528 [","[position]","] \u5c5e\u6027\u58f0\u660e\u7684\u5143\u7d20\u3002"),(0,i.kt)("h2",{id:"\u8868-54\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"},"\u8868 5.4\u3002\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,"``amplification_count macOS\uff1a\u81ea Metal 2.3 \u8d77\u3002iOS\uff1a\u81ea Metal 2.2 \u8d77\u3002````"),(0,i.kt)("p",null,"``` ushort \u6216 uint \u4e3a\u6bcf\u4e2a\u9876\u70b9\u5b9e\u4f8b\u751f\u6210\u7684\u8f93\u51fa\u9876\u70b9\u6570\u3002````"),(0,i.kt)("p",null,"```mplification_id macOS\uff1a\u81ea Metal 2.3 \u8d77\u3002iOS\uff1a\u81ea Metal 2.2 \u8d77\u3002````"),(0,i.kt)("p",null,"``` ushort \u6216 uint \u89c6\u53e3\u548c\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\u7684\u6570\u7ec4\u7d22\u5f15\u504f\u79fb\u6620\u5c04\uff0c\u5b83\u5141\u8bb8\u5c06\u653e\u5927\u7684\u9876\u70b9\u8def\u7531\u5230\u4e0d\u540c\u7684\u89c6\u53e3\u548c\u6e32\u67d3\u76ee\u6807\u3002````"),(0,i.kt)("p",null,"``` barycentric_coord macOS\uff1a\u81ea Metal 2.2 \u8d77\u3002iOS\uff1a\u81ea Metal 2.3 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"float\u3001float2 \u6216 float3")),(0,i.kt)("p",null,"`` \u91cd\u5fc3\u5750\u6807\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," color(m) macOS\uff1a\u81ea Metal 2.3 \u8d77\u3002iOS\uff1a\u4ece Metal 1 \u5f00\u59cb\u3002")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"floatn\u3001halfn\u3001intn\u3001uintn\u3001shortn \u6216 ushortn m \u9700\u8981\u5728\u7f16\u8bd1\u65f6\u77e5\u9053")),(0,i.kt)("p",null,"``` \u4ece\u989c\u8272\u9644\u4ef6\u8bfb\u53d6\u7684\u8f93\u5165\u503c\u3002\u7d22\u5f15 m \u6307\u793a\u8981\u8bfb\u53d6\u54ea\u4e2a\u989c\u8272\u9644\u4ef6\u3002````"),(0,i.kt)("p",null,"``` front_faceing bool \u5982\u679c\u7247\u6bb5\u5c5e\u4e8e\u524d\u7f6e\u57fa\u5143\uff0c\u5219\u8be5\u503c\u4e3a true\u3002````"),(0,i.kt)("p",null,"``` point_coord float2 \u4e8c\u7ef4\u5750\u6807\uff0c\u8303\u56f4\u4e3a\u70b9\u57fa\u5143\u4e0a\u7684 0.0 \u5230 1.0\uff0c\u6307\u5b9a\u70b9\u57fa\u5143\u4e2d\u5f53\u524d\u7247\u6bb5\u7684\u4f4d\u7f6e\u3002````"),(0,i.kt)("p",null,"```position float4 \u63cf\u8ff0\u7247\u6bb5\u7684\u7a97\u53e3\u76f8\u5bf9\u5750\u6807\uff08x\u3001y\u3001z\u30011/w\uff09\u503c\u3002````"),(0,i.kt)("p",null,"``` Primitive_id macOS\uff1a\u81ea Metal 2.2 \u8d77\u3002iOS\uff1a\u81ea Metal 2.3 \u8d77\u3002````"),(0,i.kt)("p",null,"``` uint \u4e0e\u91cd\u5fc3\u5750\u6807\u4e00\u8d77\u4f7f\u7528\u7684\u6bcf\u4e2a\u57fa\u5143\u6807\u8bc6\u7b26\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,"``` render_target_array_ind ex macOS\uff1a\u81ea Metal 1.1 \u8d77\u3002iOS\uff1a\u81ea Metal 2.1 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"uchar\u3001ushort \u6216 uint")),(0,i.kt)("p",null,"``` \u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\uff0c\u6307\u7acb\u65b9\u4f53\u8d34\u56fe\u7684\u9762\u30013D \u7eb9\u7406\u6307\u5b9a\u6df1\u5ea6\u7684\u6570\u636e\u3001\u7eb9\u7406\u6570\u7ec4\u7684\u6570\u7ec4\u5207\u7247\u3001\u6570\u7ec4\u5207\u7247\u6216\u7acb\u65b9\u4f53\u8d34\u56fe\u6570\u7ec4\u7684\u9762\u3002\u5bf9\u4e8e\u7acb\u65b9\u4f53\u8d34\u56fe\uff0c\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\u662f\u9762\u7d22\u5f15\uff0c\u5176\u503c\u4e3a 0 \u5230 5 \u4e4b\u95f4\u7684\u503c\u3002\u5bf9\u4e8e\u7acb\u65b9\u4f53\u8d34\u56fe\u6570\u7ec4\uff0c\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\u8ba1\u7b97\u5982\u4e0b\uff1a\u6570\u7ec4\u5207\u7247\u7d22\u5f15 ","*"," 6 + \u9762\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"```sample_id uint \u5f53\u524d\u6b63\u5728\u5904\u7406\u7684\u6837\u672c\u7684\u6837\u672c\u7f16\u53f7\u3002````"),(0,i.kt)("p",null,"``sample_mask uint \u5728\u591a\u6837\u672c\u5149\u6805\u5316\u671f\u95f4\u751f\u6210\u7247\u6bb5\u7684\u57fa\u5143\u6240\u8986\u76d6\u7684\u6837\u672c\u96c6\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"sample_mask, post_depth_coverage iOS: \u81ea Metal 2. macOS: \u81ea Metal 2.3 ")),(0,i.kt)("p",null,"``` uint \u5728\u591a\u6837\u672c\u5149\u6805\u5316\u671f\u95f4\u5e94\u7528\u65e9\u671f\u6df1\u5ea6\u548c\u6a21\u677f\u6d4b\u8bd5\u540e\u751f\u6210\u7247\u6bb5\u7684\u57fa\u5143\u6240\u8986\u76d6\u7684\u6837\u672c\u96c6\u3002Early_fragment_tests \u5c5e\u6027\u9700\u8981\u7528\u5728 fragment \u51fd\u6570\u4e0a\uff1b\u5426\u5219\u7f16\u8bd1\u5931\u8d25\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"thread_index_in_quadgro up \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2. 2.")),(0,i.kt)("p",null,"``` ushort \u6216 uint \u56db\u5143\u7ec4\u4e2d\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"thread_index_in_simdgro up \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2. 2.")),(0,i.kt)("p",null,"``` ushort \u6216 uint SIMD \u7ec4\u4e2d\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"threads_per_simdgroup \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2.2.")),(0,i.kt)("p",null,"``` ushort \u6216 uint SIMD \u7ec4\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"``` viewport_array_index macOS\uff1a\u81ea Metal 2 \u8d77\u3002iOS\uff1a\u81ea Metal 2.1 \u8d77\u3002````"),(0,i.kt)("p",null,"``` uint \u56fe\u5143\u7684\u89c6\u53e3\uff08\u548c\u526a\u5200\u77e9\u5f62\uff09\u7d22\u5f15\u503c\u3002````"),(0,i.kt)("p",null,"\u4f7f\u7528 [","[position]","] \u5c5e\u6027\u58f0\u660e\u4e3a\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u7684\u53d8\u91cf\u53ea\u80fd\u4f7f\u7528 center_no_perspective \u91c7\u6837\u548c\u63d2\u503c\u5c5e\u6027\u58f0\u660e\u3002\uff08\u53c2\u89c1\u7b2c 5.4 \u8282\u3002\uff09"),(0,i.kt)("p",null,"\u5bf9\u4e8e [","[color(m)]","]\uff0cm \u7528\u4e8e\u5728\u7247\u6bb5\u51fd\u6570\u4e2d\u8bbf\u95ee\uff08\u8bfb\u53d6\u6216\u5199\u5165\uff09\u591a\u4e2a\u989c\u8272\u9644\u4ef6\u65f6\u6307\u5b9a\u989c\u8272\u9644\u4ef6\u7d22\u5f15\u3002"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u7247\u6bb5\u51fd\u6570\u8f93\u5165\uff0c[","[sample_mask]","] \u5c5e\u6027\u53ea\u80fd\u58f0\u660e\u4e00\u6b21\u3002"),(0,i.kt)("p",null,"\u7247\u6bb5\u51fd\u6570\u4e2d [","[render_target_array_index]","] \u7684\u503c\u4e0e\u4ece\u9876\u70b9\u51fd\u6570\u5199\u5165\u7684\u503c\u76f8\u540c\uff0c\u5373\u4f7f\u6307\u5b9a\u7684\u503c\u8d85\u51fa\u8303\u56f4\u3002"),(0,i.kt)("p",null,"\u6709\u5173 [","[viewport_array_index]","] \u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7b2c 5.10 \u8282\u3002"),(0,i.kt)("p",null,"[","[amplification_count]","]\u7684\u9ed8\u8ba4\u503c\u4e3a 1\uff0c\u8868\u793a\u7981\u7528\u9876\u70b9\u653e\u5927\u3002"),(0,i.kt)("p",null,"[","[amplification_id]","] \u7684\u503c\u5e94\u5728 [0,amplification_count) \u8303\u56f4\u5185\u3002"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u6307\u5b9a\u7684 [","[amplification_id]","] \u5c5e\u6027\u503c\uff0c[","[viewport_array_index]","] \u548c [","[render_target_array_index]","] \u5185\u7f6e\u7247\u6bb5\u8f93\u5165\u503c\u5c06\u6dfb\u52a0\u5230\u76f8\u5e94 MTLVertexAmplificationViewMapping \u7ed3\u6784\u63d0\u4f9b\u7684\u503c\uff08\u504f\u79fb\uff09\u3002"),(0,i.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u63cf\u8ff0\u4e86\u7ed3\u6784\u4f53 MyVertexOut\uff0c\u5b83\u65e2\u662f\u9876\u70b9\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u53c8\u662f\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u7c7b\u578b\u3002MyVertexOut \u4f7f\u7528\u8f93\u5165\u53c2\u6570 amp_id \u7684 [","[amplification_id]","] \u5c5e\u6027\u6765\u653e\u5927\u4f4d\u7f6e\u548c ampData \u6210\u5458\u3002\u4f7f\u7528 [","[shared]","] \u5c5e\u6027\u663e\u5f0f\u786e\u4fdd texcoord \u6210\u5458\u5728\u9876\u70b9\u653e\u5927\u4e0b\u5bf9\u4e8e\u6240\u6709\u53d8\u91cf\u5177\u6709\u76f8\u540c\u7684\u503c\uff0c\u5982\u7b2c 5.2.3.3 \u8282\u6240\u8ff0\u3002"),(0,i.kt)("p",null,"\u5728\u9876\u70b9\u51fd\u6570 myVertex \u4e2d\uff0c[","[amplification_id]","] \u548c [","[amplification_count]","] \u5c5e\u6027\u6307\u5b9a\u7528\u4e8e\u9876\u70b9\u653e\u5927\u7684\u9876\u70b9\u51fd\u6570\u8f93\u5165\u53d8\u91cf\uff0c\u8be6\u89c1 5.2.3.1 \u8282\u3002\u7740\u8272\u5668\u7f16\u8bd1\u5668\u63a8\u65ad\u51fa\u6bcf\u4e2a [","[amplification_id]","] \u7684\u666e\u901a\u6210\u5458\u5177\u6709\u76f8\u540c\u7684\u503c\uff0c\u56e0\u6b64\u7f16\u8bd1\u5668\u5728\u9876\u70b9\u8f93\u51fa\u4e2d\u5c06\u5176\u6807\u8bb0\u4e3a\u5171\u4eab\u3002"),(0,i.kt)("p",null,"\u5728\u7247\u6bb5\u51fd\u6570 myFragment \u4e2d\uff0c\u76f8\u540c\u7684 [","[amplification_id]","] \u548c [","[amplification_count]","] \u5c5e\u6027\u6307\u5b9a\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u53d8\u91cf\u3002\u5982\u679c\u542f\u7528\u9876\u70b9\u653e\u5927\uff0c\u5219 amp_id \u786e\u5b9a\u4ece\u4e2d\u9009\u62e9\u89c6\u53e3\u6570\u7ec4\u7d22\u5f15\uff08viewportArrayIndexOffset \u6210\u5458\uff09\u7684\u6620\u5c04\uff08MTLVertexAmplificationViewMapping \u7ed3\u6784\uff09\u3002"),(0,i.kt)("p",null,"struct MyVertexIn { float4 \u4f4d\u7f6e [","[attribute(0)]","]; float3 \u6b63\u5e38 [","[\u5c5e\u6027(1)]","]; float3 \u6b63\u5207 [","[\u5c5e\u6027(2)]","]; float2 texcoord [","[\u5c5e\u6027(3)]","]; };"),(0,i.kt)("p",null,"struct MyVertexOut { float4 \u4f4d\u7f6e [","[\u4f4d\u7f6e]","]; float3 \u6b63\u5e38\uff1b float3 \u5207\u7ebf\uff1b float3 \u53cc\u5207\u7ebf\uff1b float2 texcoord [","[\u5171\u4eab]","]; // \u663e\u5f0f\u5171\u4eab\u3002\u6d6e\u70b9\u6570\u636e\uff1b"),(0,i.kt)("p",null,"ushort \u89c6\u53e3 [","[viewport_array_index]","]; // \u9690\u5f0f\u5171\u4eab };"),(0,i.kt)("p",null,"constexpr ushort MAX_AMP = 2;"),(0,i.kt)("p",null,"\u9876\u70b9 MyVertexOut myVertex(MyVertexIn in [","[stage_in]","], \u5e38\u91cf float4x4 view_proj","[MAX_AMP]",", \u5e38\u91cf float data","[MAX_AMP]",", ushort amp_id [","[amplification_id]","], ushort amp_count [","[amplification_count]","], ...) { MyVertexOut vert; vert.position = view_proj","[amp_id]"," ","*"," in.position; // \u63a8\u5bfc\u51fa\u653e\u5927\u540e\u7684 vert.normal = in.normal; // \u63a8\u5bfc\u51fa\u5171\u4eab vert.tangent = ...; vert.bitangent = ...; vert.texcoord = ...; vert.ampData = \u6570\u636e","[amp_id]","; // \u4e0d\u5171\u4eab vert.viewport = 1;\u8fd4\u56de\u5782\u76f4\uff1b }"),(0,i.kt)("p",null,"\u7247\u6bb5 float4 myFragment(MyVertexOut in [","[stage_in]","], ushort amp_id [","[amplification_id]","], ushort amp_count [","[amplification_count]","], ...) { // \u5bf9\u4e8e MTLVertexAmplificationViewMapping = {{1,3},{2,4} } // \u5f53 amp_id == 0 \u65f6\uff0cin.viewport == 2 // \u5f53 amp_id == 1 \u65f6\uff0cin.viewport == 3 ushort viewport = in.viewport; ... }"),(0,i.kt)("p",null,"\u4f7f\u7528 [","[barycentric_coord]","] \u5c5e\u6027\u58f0\u660e\u7684\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u53ea\u80fd\u4f7f\u7528 center_perspective\uff08\u9ed8\u8ba4\uff09\u6216 center_no_perspective \u91c7\u6837\u548c\u63d2\u503c\u5c5e\u6027\u8fdb\u884c\u58f0\u660e\u3002\u91cd\u5fc3\u5750\u6807\u548c\u6bcf\u50cf\u7d20\u57fa\u5143 ID \u53ef\u4ee5\u4f5c\u4e3a\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u4f20\u9012\u5230\u6309\u4ee5\u4e0b\u793a\u4f8b\u6240\u793a\u7ec4\u7ec7\u7684\u7ed3\u6784\u4e2d\uff1a"),(0,i.kt)("p",null,"struct FragmentInput0 { uint Primitive_id [","[primitive_id]","]; // [","[center_perspective]","] \u662f\u9ed8\u8ba4\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u7701\u7565\u3002float3 barycentric_coord [","[barycentric_coord, center_perspective]","]; };"),(0,i.kt)("p",null,"struct FragmentInput1 { uint primitive_id [","[primitive_id]","]; float2 linear_barycentric_coord [","[barycentric_coord, center_no_perspective]","]; };"),(0,i.kt)("p",null,"\u901a\u8fc7\u5b58\u50a8\u91cd\u5fc3\u5750\u6807\u548c\u6bcf\u50cf\u7d20\u56fe\u5143 ID\uff0c\u7740\u8272\u5668\u53ef\u4ee5\u5728\u7247\u6bb5\u9636\u6bb5\u5185\u624b\u52a8\u8bfb\u53d6\u548c\u63d2\u5165\u7ed8\u5236\u56fe\u5143\u7684\u9876\u70b9\uff0c\u6216\u5c06\u6b64\u63d2\u503c\u63a8\u8fdf\u5230\u5355\u72ec\u7684\u901a\u9053\u3002\u5728\u5ef6\u8fdf\u63d2\u503c\u573a\u666f\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528 thin buffer"),(0,i.kt)("p",null,"\u5728\u51e0\u4f55\u901a\u9053\u671f\u95f4\u5b58\u50a8\u6700\u5c0f\u7684\u8868\u9762\u6570\u636e\u96c6\uff0c\u5305\u62ec\u9884\u88c1\u526a\u7684\u91cd\u5fc3\u5750\u6807\u3002\u5728\u7a0d\u540e\u9636\u6bb5\uff0c\u4f60\u5fc5\u987b\u6709\u8db3\u591f\u7684\u6570\u636e\u6765\u6839\u636e\u56fe\u5143 ID \u6570\u636e\u91cd\u5efa\u539f\u59cb\u9876\u70b9\u7d22\u5f15\uff0c\u5e76\u5c06\u91cd\u5fc3\u5750\u6807\u4e0e\u8fd9\u4e9b\u9876\u70b9\u7d22\u5f15\u76f8\u5173\u8054\u3002"),(0,i.kt)("p",null,"\u5f53\u5c06 barycentric",(0,i.kt)("em",{parentName:"p"},"coord \u5c5e\u6027\u5e94\u7528\u4e8e\u5177\u6709 ","_","more")," \u7ec4\u4ef6\u7684\u8f93\u5165\u53c2\u6570\uff08\u6216\u53c2\u6570\u7684\u5b57\u6bb5\uff09\u65f6\uff0c\u5176\u4f59\u5143\u7d20\u5c06\u4f7f\u7528 0.0f \u8fdb\u884c\u521d\u59cb\u5316\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e"),(0,i.kt)("p",null,"\u7247\u6bb5 float4 frag (float3 coord [","[barycentric_coord]","]) { ... }"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u7ed8\u5236\u70b9\u65f6\uff0ccoord.yz \u4e3a float2(0.0f)\u3002- \u753b\u7ebf\u65f6\uff0ccoord.z \u4e3a 0.0f\u3002")),(0,i.kt)("p",null,"\u5f53\u5c06 barycentric",(0,i.kt)("em",{parentName:"p"},"coord \u5c5e\u6027\u5e94\u7528\u4e8e\u5177\u6709 ","_","fewer")," \u5206\u91cf\u7684\u8f93\u5165\u53c2\u6570\uff08\u6216\u53c2\u6570\u7684\u5b57\u6bb5\uff09\u65f6\uff0c\u5176\u4f59\u5143\u7d20\u5c06\u88ab\u5ffd\u7565\u3002"),(0,i.kt)("p",null,"\u8868 5. 6 \u5217\u51fa\u4e86\u53ef\u4ee5\u4e3a\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u7684\u56fe\u5757\u53c2\u6570\u6307\u5b9a\u7684\u5c5e\u6027\u3002\u58f0\u660e [","[pixel_position_in_tile]","] \u548c [","[pixels_per_tile]","] \u7684\u6570\u636e\u7c7b\u578b\u5fc5\u987b\u5339\u914d\u3002"),(0,i.kt)("h2",{id:"\u8868-55\u7247\u6bb5\u51fd\u6570\u56fe\u5757\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"},"\u8868 5.5\u3002\u7247\u6bb5\u51fd\u6570\u56fe\u5757\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,"``` Pixel_position_in_tile ushort2 \u6216 uint2 (x, y) \u7247\u6bb5\u5728\u56fe\u5757\u4e2d\u7684\u4f4d\u7f6e\u3002````"),(0,i.kt)("p",null,"``pixels_per_tile ushort2 \u6216 uint2\uff08\u5bbd\u5ea6\u3001\u9ad8\u5ea6\uff09\uff0c\u4ee5\u50cf\u7d20\u4e3a\u5355\u4f4d\u7684\u56fe\u5757\u3002````"),(0,i.kt)("p",null,"```tile_index ushort \u6216 uint \u4e00\u7ef4\u56fe\u5757\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"render_target_array_ind ex")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"uchar\u3001ushort \u6216 uint")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\uff0c\u6307\u7acb\u65b9\u4f53\u8d34\u56fe\u7684\u9762\u30013D \u7eb9\u7406\u6307\u5b9a\u6df1\u5ea6\u7684\u6570\u636e\u3001\u7eb9\u7406\u6570\u7ec4\u7684\u6570\u7ec4\u5207\u7247\u3001\u6570\u7ec4\u5207\u7247\u6216\u7acb\u65b9\u4f53\u8d34\u56fe\u6570\u7ec4\u7684\u9762\u3002\u5bf9\u4e8e\u7acb\u65b9\u4f53\u8d34\u56fe\uff0c\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\u662f\u9762\u7d22\u5f15\uff0c\u5b83\u662f\u4ece 0 \u5230")," \u7684\u503c"),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},"\u5bf9\u4e8e\u7acb\u65b9\u4f53\u8d34\u56fe\u6570\u7ec4\uff0c\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\u8ba1\u7b97\u5982\u4e0b\uff1a\u6570\u7ec4\u5207\u7247\u7d22\u5f15 ","*"," 6 + \u9762\u7d22\u5f15\u3002")),(0,i.kt)("p",null,"macOS\uff1a\u81ea Metal 2.3 \u8d77\u652f\u6301\u8868 5.6 \u4e2d\u7684\u5c5e\u6027\u3002"),(0,i.kt)("p",null,"iOS\uff1a\u81ea Metal 2 \u8d77\u652f\u6301\u8868 5.6 \u4e2d\u7684\u5c5e\u6027\u3002"),(0,i.kt)("p",null,"[","[tile_index]","] \u662f [0, n) \u4e2d\u7684\u503c\uff0c\u5176\u4e2d n \u662f\u6e32\u67d3\u76ee\u6807\u4e2d\u7684\u56fe\u5757\u6570\u91cf\u3002"),(0,i.kt)("h2",{id:"5235-\u7247\u6bb5\u51fd\u6570\u8f93\u51fa\u5c5e\u6027"},"5.2.3.5 \u7247\u6bb5\u51fd\u6570\u8f93\u51fa\u5c5e\u6027"),(0,i.kt)("p",null,"\u7247\u6bb5\u51fd\u6570\u7684\u8fd4\u56de\u7c7b\u578b\u63cf\u8ff0\u4e86\u6bcf\u4e2a\u7247\u6bb5\u7684\u8f93\u51fa\u3002\u4f60\u5fc5\u987b\u4f7f\u7528\u8868 5. 7 \u4e2d\u5217\u51fa\u7684\u5c5e\u6027\u6765\u6307\u5b9a\u7247\u6bb5\u51fd\u6570\u53ef\u4ee5\u8f93\u51fa\u4e00\u4e2a\u6216\u591a\u4e2a\u6e32\u67d3\u76ee\u6807\u989c\u8272\u503c\u3001\u6df1\u5ea6\u503c\u3001\u91c7\u6837\u8986\u76d6\u906e\u7f69\u6216\u6a21\u677f\u53c2\u8003\u503c\u3002\u5982\u679c\u7247\u6bb5\u51fd\u6570\u6ca1\u6709\u8f93\u51fa\u6df1\u5ea6\u503c\uff0c\u5219\u5c06\u5149\u6805\u5316\u5668\u751f\u6210\u7684\u6df1\u5ea6\u503c\u8f93\u51fa\u5230\u6df1\u5ea6\u9644\u4ef6\u3002"),(0,i.kt)("h2",{id:"\u8868-56\u7247\u6bb5\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027"},"\u8868 5.6\u3002\u7247\u6bb5\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," color(m) \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002")),(0,i.kt)("p",null,"``` \u989c\u8272(m)\uff0c\u7d22\u5f15(i) \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1.2 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"floatn\u3001halfn\u3001intn\u3001uintn\u3001shortn \u6216 ushortn")),(0,i.kt)("p",null,"`` \u989c\u8272\u9644\u4ef6\u7684\u989c\u8272\u503c\u8f93\u51fa\u3002````"),(0,i.kt)("p",null,"``` m \u662f\u989c\u8272\u9644\u4ef6\u7d22\u5f15\uff0c\u9700\u8981\u5728\u7f16\u8bd1\u65f6\u77e5\u9053\u3002\u7d22\u5f15 i \u53ef\u7528\u4e8e\u6307\u5b9a\u7247\u6bb5\u51fd\u6570\u9488\u5bf9\u7ed9\u5b9a\u989c\u8272\u9644\u4ef6\u8f93\u51fa\u7684\u4e00\u79cd\u6216\u591a\u79cd\u989c\u8272\uff0c\u5e76\u4e14\u662f\u6df7\u5408\u65b9\u7a0b\u7684\u8f93\u5165\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6df1\u5ea6\uff08\u6df1\u5ea6\u53c2\u6570\uff09 \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u4ee5\u6765\u3002")),(0,i.kt)("p",null,"``` float \u4f7f\u7528\u7531 height_argument \u6307\u5b9a\u7684\u51fd\u6570\u8f93\u51fa\u7684\u6df1\u5ea6\u503c\u3002````"),(0,i.kt)("p",null,"``sample_mask \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002````"),(0,i.kt)("p",null,"`` uint \u8986\u76d6\u7387\u63a9\u7801\u3002````"),(0,i.kt)("p",null,"``` stencil \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2.1 \u8d77\u3002````"),(0,i.kt)("p",null,"``` uint \u6a21\u677f\u6d4b\u8bd5\u4e2d\u4f7f\u7528\u7684\u6a21\u677f\u53c2\u8003\u503c\u3002````"),(0,i.kt)("p",null,"\u7247\u6bb5\u8f93\u51fa\u7684\u989c\u8272\u9644\u4ef6\u7d22\u5f15 m \u7684\u6307\u5b9a\u65b9\u5f0f\u4e0e\u7247\u6bb5\u8f93\u5165\u7684 [","[color(m)]","] \u7684\u6307\u5b9a\u65b9\u5f0f\u76f8\u540c\uff08\u53c2\u89c1\u8868 5. 5 \u7684\u8ba8\u8bba\uff09\u3002\u7247\u6bb5\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u4e2d\u4f7f\u7528\u76f8\u540c\u989c\u8272\u9644\u4ef6\u7d22\u5f15\u8fdb\u884c\u6df7\u5408\u7684\u591a\u4e2a\u5143\u7d20\u9700\u8981\u4f7f\u7528\u76f8\u540c\u7684\u6570\u636e\u7c7b\u578b\u8fdb\u884c\u58f0\u660e\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u7247\u6bb5\u51fd\u6570\u4e2d\u53ea\u6709\u5355\u8272\u9644\u4ef6\uff0c\u5219 [","[color(m)]","] \u662f\u53ef\u9009\u7684\u3002\u5982\u679c\u4e0d\u6307\u5b9a[","[color(m)]","]\uff0c\u5219\u9644\u4ef6\u7d22\u5f15\u4e3a 0\u3002\u5982\u679c\u6307\u5b9a\u591a\u4e2a\u989c\u8272\u9644\u4ef6\uff0c\u5219\u9700\u8981\u4e3a\u6240\u6709\u989c\u8272\u503c\u6307\u5b9a[","[color(m)]","]\u3002\u8bf7\u53c2\u9605\u7b2c 5.5 \u8282\u548c\u7b2c 5.8.1.5 \u8282\u4e2d\u6307\u5b9a\u989c\u8272\u9644\u4ef6\u7684\u793a\u4f8b\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u5c5e\u6027\u4e2d\u672a\u6307\u5b9a index(i)\uff0c\u5219\u9ed8\u8ba4\u7d22\u5f15\u4e3a 0\u3002\u5982\u679c\u6307\u5b9a\u4e86 index(i)\uff0c\u5219\u9700\u8981\u5728\u7f16\u8bd1\u65f6\u77e5\u9053 i \u7684\u503c\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u7247\u6bb5\u51fd\u6570\u5199\u5165\u6df1\u5ea6\u503c\uff0c\u5219\u9700\u8981\u4f7f\u7528\u4ee5\u4e0b\u503c\u4e4b\u4e00\u6307\u5b9a\u6df1\u5ea6\u53c2\u6570\uff1a"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"2023 - 06 - 02 | Copyright \xa9 2023 Apple Inc. | All Rights Reserved.")),(0,i.kt)("p",null,"\u4efb\u4f55"),(0,i.kt)("p",null,"\u66f4\u5927"),(0,i.kt)("p",null,"\u8f83\u5c11\u7684"),(0,i.kt)("p",null,"\u4f60\u4e0d\u80fd\u5728\u57fa\u4e8e\u7247\u6bb5\u7684\u56fe\u5757\u7740\u8272\u51fd\u6570\u4e2d\u4f7f\u7528 [","[stencil]","] \u5c5e\u6027\u3002[","[stencil]","] \u5c5e\u6027\u4e0e [","[early_fragment_tests]","] \u51fd\u6570\u5c5e\u6027\u4e0d\u517c\u5bb9\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u7247\u6bb5\u51fd\u6570\u6ca1\u6709\u8f93\u51fa\u6a21\u677f\u503c\uff0cMTLRenderCommandEncoder \u7684 setStencilReferenceValue: \u6216 setStencilFrontReferenceValue:backReferenceValue: \u65b9\u6cd5\u53ef\u4ee5\u8bbe\u7f6e\u6a21\u677f\u53c2\u8003\u503c\u3002"),(0,i.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u663e\u793a\u4e86\u5982\u4f55\u6307\u5b9a\u989c\u8272\u9644\u4ef6\u7d22\u5f15\u3002clr_f \u4e2d\u5199\u5165\u7684\u989c\u8272\u503c\u5199\u5165\u989c\u8272\u9644\u4ef6\u7d22\u5f15 0\uff0cclr_i \u5199\u5165\u989c\u8272\u9644\u4ef6\u7d22\u5f15 1\uff0cclr_ui \u5199\u5165\u989c\u8272\u9644\u4ef6\u7d22\u5f15 2\u3002"),(0,i.kt)("p",null,"struct MyFragmentOutput { // \u989c\u8272\u9644\u4ef6 0 float4 clr_f [","[color(0)]","];"),(0,i.kt)("p",null,"``` // \u989c\u8272\u9644\u4ef6 1 int4 clr_i [","[color(1)]","]; ````"),(0,i.kt)("p",null,"// \u989c\u8272\u9644\u4ef6 2 uint4 clr_ui [","[color(2)]","]; }"),(0,i.kt)("p",null,"\u7247\u6bb5 MyFragmentOutput my_fragment(...) { MyFragmentOutput f;"),(0,i.kt)("p",null,"f.clr_f = ...;"),(0,i.kt)("p",null,"\u8fd4\u56de f\uff1b }"),(0,i.kt)("p",null,"\u5982\u679c\u989c\u8272\u9644\u4ef6\u7d22\u5f15\u65e2\u7528\u4f5c\u7247\u6bb5\u51fd\u6570\u7684\u8f93\u5165\u53c8\u7528\u4f5c\u7247\u6bb5\u51fd\u6570\u7684\u8f93\u51fa\uff0c\u5219\u4e0e\u4f7f\u7528\u6b64\u989c\u8272\u9644\u4ef6\u7d22\u5f15\u58f0\u660e\u7684\u8f93\u5165\u53c2\u6570\u548c\u8f93\u51fa\u5173\u8054\u7684\u6570\u636e\u7c7b\u578b\u5fc5\u987b\u5339\u914d\u3002"),(0,i.kt)("h2",{id:"5236-\u5185\u6838\u51fd\u6570\u8f93\u5165\u5c5e\u6027"},"5.2.3.6 \u5185\u6838\u51fd\u6570\u8f93\u5165\u5c5e\u6027"),(0,i.kt)("p",null,"\u5f53\u5185\u6838\u51fd\u6570\u88ab\u63d0\u4ea4\u6267\u884c\u65f6\uff0c\u5b83\u4f1a\u5728 N \u7ef4\u7ebf\u7a0b\u7f51\u683c\u4e0a\u6267\u884c\uff0c\u5176\u4e2d N \u4e3a\u4e00\u3001\u4e8c\u6216\u4e09\u3002\u7ebf\u7a0b\u662f\u5185\u6838\u51fd\u6570\u7684\u4e00\u4e2a\u5b9e\u4f8b"),(0,i.kt)("p",null,"\u5bf9\u8be5\u7f51\u683c\u4e2d\u7684\u6bcf\u4e2a\u70b9\u6267\u884c\uff0c\u5e76\u4e14 thread_position_in_grid \u6807\u8bc6\u5176\u5728\u7f51\u683c\u4e2d\u7684\u4f4d\u7f6e\u3002"),(0,i.kt)("p",null,"\u5728\u8ba1\u7b97\u5355\u5143\u5185\uff0c\u7ebf\u7a0b\u7ec4\u88ab\u5212\u5206\u4e3a\u591a\u4e2a\u8f83\u5c0f\u7684\u7ec4\u6765\u6267\u884c\u3002\u8ba1\u7b97\u5355\u5143\u7684\u6267\u884c\u5bbd\u5ea6\uff08\u79f0\u4e3a threads_per_simdgroup\uff09\u51b3\u5b9a\u4e86\u8be5\u8f83\u5c0f\u7ec4\u7684\u5efa\u8bae\u5927\u5c0f\u3002\u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u6027\u80fd\uff0c\u8bf7\u5c06\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u7ebf\u7a0b\u603b\u6570\u8bbe\u7f6e\u4e3a threads_per_simdgroup \u7684\u500d\u6570\u3002"),(0,i.kt)("p",null,"\u7ebf\u7a0b\u7ec4\u5728\u7f51\u683c\u5185\u88ab\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684\u4f4d\u7f6e\uff08\u79f0\u4e3a threadgroup_position_in_grid\uff09\u3002\u7ebf\u7a0b\u5728\u7ebf\u7a0b\u7ec4\u5185\u88ab\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684\u4f4d\u7f6e\uff08\u79f0\u4e3a thread_position_in_threadgroup\uff09\u3002\u7ebf\u7a0b\u7ec4\u5185\u7ebf\u7a0b\u7684\u552f\u4e00\u6807\u91cf\u7d22\u5f15\u7531 thread_index_in_threadgroup \u7ed9\u51fa\u3002"),(0,i.kt)("p",null,"\u6bcf\u4e2a\u7ebf\u7a0b\u5728\u7f51\u683c\u4e2d\u7684\u4f4d\u7f6e\u548c\u5728\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u4f4d\u7f6e\u90fd\u662f N \u7ef4\u5143\u7ec4\u3002\u4f7f\u7528\u4e0e\u7ebf\u7a0b\u7c7b\u4f3c\u7684\u65b9\u6cd5\u4e3a\u7ebf\u7a0b\u7ec4\u5206\u914d\u4f4d\u7f6e\u3002\u7ebf\u7a0b\u88ab\u5206\u914d\u5230\u4e00\u4e2a\u7ebf\u7a0b\u7ec4\uff0c\u5e76\u5728\u7ebf\u7a0b\u7ec4\u4e2d\u6307\u5b9a\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5176\u7ec4\u4ef6\u7684\u8303\u56f4\u4ece\u96f6\u5230\u8be5\u7ef4\u5ea6\u4e2d\u7ebf\u7a0b\u7ec4\u5927\u5c0f\u7684\u5927\u5c0f\u51cf\u4e00\u3002"),(0,i.kt)("p",null,"\u5f53\u5185\u6838\u51fd\u6570\u63d0\u4ea4\u6267\u884c\u65f6\uff0c\u6307\u5b9a\u7ebf\u7a0b\u7ec4\u7684\u6570\u91cf\u548c\u7ebf\u7a0b\u7ec4\u5927\u5c0f\uff0c\u6216\u8005\u6307\u5b9a\u7f51\u683c\u4e2d\u7684\u7ebf\u7a0b\u6570\u548c\u7ebf\u7a0b\u7ec4\u5927\u5c0f\u3002\u4f8b\u5982\uff0c\u8003\u8651\u63d0\u4ea4\u6267\u884c\u7684\u5185\u6838\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u4f7f\u7528 2D \u7f51\u683c\uff0c\u5176\u4e2d\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u6570\u91cf\u4e3a (Wx, Wy)\uff0c\u7ebf\u7a0b\u7ec4\u5927\u5c0f\u4e3a (Sx, Sy)\u3002\u4ee4(wx,wy)\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u7ec4\u5728\u7f51\u683c\u4e2d\u7684\u4f4d\u7f6e(threadgroup_position_in_grid)\uff0c(lx,ly)\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u5728\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u4f4d\u7f6e(thread_position_in_threadgroup)\u3002"),(0,i.kt)("p",null,"\u7f51\u683c\u4e2d\u7684\u7ebf\u7a0b\u4f4d\u7f6e\uff08thread_position_in_grid\uff09\u4e3a\uff1a"),(0,i.kt)("p",null,"(gx, gy) = (wx ",(0,i.kt)("em",{parentName:"p"}," Sx + lx, wy ")," Sy + ly)"),(0,i.kt)("p",null,"\u7f51\u683c\u5927\u5c0f\uff08threads_per_grid\uff09\u4e3a\uff1a"),(0,i.kt)("p",null,"(Gx,Gy) = (Wx ",(0,i.kt)("em",{parentName:"p"}," Sx, Wy ")," Sy)"),(0,i.kt)("p",null,"\u5728\u9664\u56fe\u5757\u51fd\u6570\u4e4b\u5916\u7684\u60c5\u51b5\u4e0b\uff0c\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u7ebf\u7a0b\u7d22\u5f15 (thread_index_in_threadgroup) \u7531\u4ee5\u4e0b\u516c\u5f0f\u786e\u5b9a\uff1aly ","*"," Sx + lx"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u56fe\u5757\u51fd\u6570\uff0c\u7ebf\u7a0b\u7d22\u5f15\u4e0d\u662f lx \u548c ly \u503c\u7684\u7ebf\u6027\u6620\u5c04\u3002\u74e6\u7247\u51fd\u6570\u4e2d\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u4fdd\u8bc1\u83b7\u5f97 [0, Sx ","*"," Sy) \u8303\u56f4\u5185\u7684\u552f\u4e00\u7d22\u5f15\u3002"),(0,i.kt)("p",null,"\u5728\u7ebf\u7a0b\u7ec4\u5185\uff0c\u7ebf\u7a0b\u4ee5\u5b9e\u73b0\u5b9a\u4e49\u7684\u65b9\u5f0f\u5206\u4e3a SIMD \u7ec4\u3002SIMD \u7ec4\u4e2d\u7684\u4efb\u4f55\u7ed9\u5b9a\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u67e5\u8be2\u5176 SIMD \u901a\u9053 ID \u4ee5\u53ca\u5b83\u5c5e\u4e8e\u54ea\u4e2a SIMD \u7ec4\u3002"),(0,i.kt)("p",null,"\u8868 5. 8 \u5217\u51fa\u4e86\u53ef\u4ee5\u4e3a\u5185\u6838\u51fd\u6570\u7684\u53c2\u6570\u6307\u5b9a\u7684\u5185\u7f6e\u5c5e\u6027\u4ee5\u53ca\u53ef\u4ee5\u4f7f\u7528\u5b83\u4eec\u7684\u76f8\u5e94\u6570\u636e\u7c7b\u578b\u3002\u4ece Metal 3.1 \u5f00\u59cb\uff0c\u53ef\u4ee5\u5728\u8981\u5728\u5185\u6838\u4e0a\u4e0b\u6587\u4e2d\u4f7f\u7528\u7684\u5168\u5c40\uff08\u7a0b\u5e8f\u8303\u56f4\uff09\u53d8\u91cf\u4e0a\u6307\u5b9a\u5185\u7f6e\u5c5e\u6027\u3002"),(0,i.kt)("h2",{id:"\u8868-57\u5185\u6838\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"},"\u8868 5.7\u3002\u5185\u6838\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u76f8\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"dispatch_quadgroups_per_th readgroup macOS\uff1a\u81ea Metal 2.1 \u8d77\u3002iOS\uff1a\u4ece Metal 2 \u5f00\u59cb\u3002")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"``` \u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u7684\u56db\u7ec4\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"```dispatch_simdgroups_per_th readgroup macOS\uff1a\u81ea Metal 2 \u8d77\u3002iOS\uff1a\u81ea Metal 2.2 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"``` \u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u7684 SIMD \u7ec4\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"``dispatch_threads_per_threa dgroup \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"``` grid_origin \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1.2 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7f51\u683c\u7684\u539f\u70b9\uff08\u504f\u79fb\u91cf\uff09\uff0c\u5728\u8be5\u7f51\u683c\u4e0a\u542f\u52a8\u8bfb\u53d6\u6bcf\u4e2a\u7ebf\u7a0b\u9636\u6bb5\u6570\u636e\u7684\u8ba1\u7b97\u7ebf\u7a0b\u3002````"),(0,i.kt)("p",null,"``` grid_size \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1.2 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u542f\u52a8\u8bfb\u53d6\u6bcf\u4e2a\u7ebf\u7a0b\u9636\u6bb5\u6570\u636e\u7684\u8ba1\u7b97\u7ebf\u7a0b\u7684\u7f51\u683c\u7684\u6700\u5927\u5927\u5c0f\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"quadgroup_index_in_threadg \u7ec4 macOS\uff1a\u81ea Metal 2.1 \u8d77\u3002iOS\uff1a\u4ece Metal 2 \u5f00\u59cb\u3002")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u5185\u56db\u5143\u7ec4\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"quadgroups_per_threadgroup macOS\uff1a\u81ea Metal 2.1 \u8d77\u3002iOS\uff1a\u4ece Metal 2 \u5f00\u59cb\u3002")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"`` \u7ebf\u7a0b\u7ec4\u7684\u56db\u7ec4\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"``` simdgroup_index_in_threadg \u7ec4 macOS\uff1a\u81ea Metal 2 \u8d77\u3002iOS\uff1a\u81ea Metal 2.2 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u5185 SIMD \u7ec4\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"``` simdgroups_per_threadgroup macOS\uff1a\u81ea Metal 2 \u8d77\u3002iOS\uff1a\u81ea Metal 2.2 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"`` \u7ebf\u7a0b\u7ec4\u7684 SIMD \u7ec4\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,"thread_execution_width \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002[","[\u81ea Metal 3 \u8d77\u5df2\u5f03\u7528 - \u4f7f\u7528threads_per_simdgroup]","]"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"``` SIMD \u7ec4\uff08\u8ba1\u7b97\u5355\u5143\uff09\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"thread_index_in_quadgroup macOS\uff1a\u81ea Metal 2.1 \u8d77\u3002iOS\uff1a\u4ece Metal 2 \u5f00\u59cb\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"``` \u56db\u5143\u7ec4\u4e2d\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"thread_index_in_simdgroup macOS\uff1a\u81ea Metal 2 \u8d77\u3002iOS\uff1a\u81ea Metal 2.2 \u8d77\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"``` SIMD \u7ec4\u5185\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"thread_index_in_threadgroup \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002"),(0,i.kt)("p",null,"``` ushort \u6216 uint \u7ebf\u7a0b\u7ec4\u5185\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"thread_position_in_grid \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u5728 N \u7ef4\u7ebf\u7a0b\u7f51\u683c\u4e2d\u7684\u4f4d\u7f6e\u3002````"),(0,i.kt)("p",null,"thread_position_in_threadg group \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u7ebf\u7a0b\u5728\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u552f\u4e00\u4f4d\u7f6e")),(0,i.kt)("p",null,"threadgroup_position_in_gr id \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u5728\u7f51\u683c\u4e2d\u7684\u72ec\u7279\u4f4d\u7f6e\u3002````"),(0,i.kt)("p",null,"threadgroups_per_grid \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7f51\u683c\u4e2d\u7ebf\u7a0b\u7ec4\u7684\u6570\u91cf\u3002````"),(0,i.kt)("p",null,"threads_per_grid \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"`` \u7f51\u683c\u5927\u5c0f\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,"```threads_per_simdgroup macOS\uff1a\u81ea Metal 2 \u8d77\u3002iOS\uff1a\u81ea Metal 2.2 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"``` SIMD \u7ec4\uff08\u8ba1\u7b97\u5355\u5143\uff09\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"``threads_per_threadgroup \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1 \u8d77\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 1.2 \u8d77\uff0c\u652f\u6301 grid_origin \u548c grid_size\u3002"),(0,i.kt)("p",null,"macOS\uff1a\u4ece Metal 2 \u5f00\u59cb\uff0c\u652f\u6301 SIMD \u7ec4\u5c5e\u6027\u3002\u4ece Metal 2.1 \u5f00\u59cb\uff0c\u652f\u6301\u56db\u7ec4\u5c5e\u6027\u3002\u81ea Metal 1 \u4ee5\u6765\u652f\u6301\u7684\u5176\u4ed6\u5c5e\u6027\u3002"),(0,i.kt)("p",null,"iOS\uff1a\u4ece Metal 2 \u5f00\u59cb\uff0c\u652f\u6301\u56db\u7ec4\u5c5e\u6027\u3002\u4ece Metal 2 \u5f00\u59cb\uff0c\u652f\u6301 SIMD \u7ec4\u5c5e\u6027\u3002"),(0,i.kt)("p",null,"\u81ea Metal 1 \u4ee5\u6765\u652f\u6301\u7684\u5176\u4ed6\u5c5e\u6027\u3002"),(0,i.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u4ece Metal 3.1 \u5f00\u59cb\uff0c\u5168\u5c40\uff08\u7a0b\u5e8f\u8303\u56f4\uff09\u53d8\u91cf\u73b0\u5728\u53ef\u4ee5\u6307\u5b9a\u8fd9\u4e9b\u5c5e\u6027\uff0c\u9664\u975e\u5b83\u4eec\u5728\u52a8\u6001\u5e93\u6216\u5355\u72ec\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u51fd\u6570\u4e2d\u4f7f\u7528\u3002"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u6807\u51c6 Metal \u8ba1\u7b97\u51fd\u6570\uff08\u5e73\u94fa\u51fd\u6570\u9664\u5916\uff09\uff0cSIMD \u7ec4\u662f\u7ebf\u6027\u7684\u548c\u4e00\u7ef4\u7684\u3002\uff08\u7ebf\u7a0b\u7ec4\u53ef\u4ee5\u662f\u591a\u7ef4\u7684\u3002\uff09\u7ebf\u7a0b\u7ec4\u4e2d\u7684 SIMD \u7ec4\u6570\u91cf ([","[simdgroups_per_threadgroup]","]) \u662f\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u7ebf\u7a0b\u603b\u6570 ([","[threads_per_threadgroup]","]) \u9664\u4ee5 SIMD \u7ec4\u5927\u5c0f ([","[threads_per_simdgroup]","]\uff09\uff1a"),(0,i.kt)("p",null,"simdgroups_per_threadgroup = ceil(threads_per_threadgroup/threads_per_simdgroup)"),(0,i.kt)("p",null,"\u540c\u6837\uff0c\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u56db\u5143\u7ec4\u6570\u91cf\uff08quadgroups_per_threadgroup\uff09\u662f\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u7ebf\u7a0b\u603b\u6570\u9664\u4ee5 4\uff0c\u5373\u56db\u5143\u7ec4\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\uff1a"),(0,i.kt)("p",null,"quadgroups_per_threadgroup = ceil(threads_per_threadgroup/4)"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u5e73\u94fa\u51fd\u6570\uff0c\u7ebf\u7a0b\u6392\u5217\u4e3a 2 x 2 \u56db\u8fb9\u5f62\u3002\u5bf9\u4e8e\u6307\u5b9a\u7ebf\u7a0b\u7ec4\u6570\u91cf\u4e3a (Wx, Wy) \u7684 2 D \u7f51\u683c\uff0csimdgroups_per_threadgroup \u8ba1\u7b97\u5982\u4e0b\uff1a"),(0,i.kt)("p",null,"simdgroups",(0,i.kt)("em",{parentName:"p"},"per_threadgroup = ceil(Wx/2) ")," 2 ","_"," ceil(Wy/2) ","*"," 2 /threads_per_simdgroup"),(0,i.kt)("p",null,"simdgroups_per_threadgroup = ceil(Wx/2)",(0,i.kt)("em",{parentName:"p"},"ceil(Wy/2)"),"4/threads_per_simdgroup"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u56fe\u5757\u51fd\u6570\uff0cquadgroups_per_threadgroup \u7684\u8ba1\u7b97\u65b9\u5f0f\u5982\u4e0b\uff1a"),(0,i.kt)("p",null,"quadgroups",(0,i.kt)("em",{parentName:"p"},"per_threadgroup = ceil(Wx/2) ")," 2 ","_"," ceil(Wy/2) ","*"," 2 / 4"),(0,i.kt)("p",null,"quadgroups_per_threadgroup = ceil(Wx/2) ","*"," ceil(Wy/2)"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\uff0c[","[dispatch_simdgroups_per_threadgroup]","] \u548c [","[dispatch_quadgroups_per_threadgroup]","] \u7684\u8ba1\u7b97\u65b9\u5f0f\u7c7b\u4f3c\u3002"),(0,i.kt)("p",null,"SIMD \u7ec4\u5728\u7ed9\u5b9a\u7ebf\u7a0b\u7ec4\u5185\u5e76\u53d1\u6267\u884c\uff0c\u5e76\u5728\u6ca1\u6709\u7ebf\u7a0b\u7ec4\u5c4f\u969c\u64cd\u4f5c\u7684\u60c5\u51b5\u4e0b\u76f8\u4e92\u72ec\u7acb\u5730\u524d\u8fdb\u3002SIMD \u7ec4\u4e2d\u7684\u7ebf\u7a0b\u7d22\u5f15\uff08\u7531 [","[thread_index_in_simdgroup]","] \u7ed9\u51fa\uff09\u662f\u4ecb\u4e8e 0 \u548c SIMD \u7ec4\u5927\u5c0f - 1 \u4e4b\u95f4\u7684\u503c\uff08\u5305\u542b 0 \u548c 1\uff09\u3002\u7c7b\u4f3c\u5730\uff0c\u56db\u5143\u7ec4\u4e2d\u7684\u7ebf\u7a0b\u7d22\u5f15\uff08\u7531 [","[thread_index_in_quadgroup]","] \u7ed9\u51fa\uff09\u662f 0 \u5230 3 \u4e4b\u95f4\u7684\u503c\uff08\u5305\u542b 0 \u548c 3\uff09\u3002"),(0,i.kt)("p",null,"\u5728 Metal 2 \u4e2d\uff0c\u7f51\u683c\u4e2d\u7684\u7ebf\u7a0b\u6570\u91cf\u4e0d\u5fc5\u662f\u7ebf\u7a0b\u7ec4\u4e2d\u7ebf\u7a0b\u6570\u91cf\u7684\u500d\u6570\u3002\u56e0\u6b64\uff0c\u7279\u5b9a\u7ebf\u7a0b\u7ec4\u7684\u5b9e\u9645\u7ebf\u7a0b\u7ec4\u5927\u5c0f\u53ef\u80fd\u5c0f\u4e8e\u8c03\u5ea6\u4e2d\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u5927\u5c0f\u3002[","[threads_per_threadgroup]","] \u5c5e\u6027\u6307\u5b9a\u6267\u884c\u5185\u6838\u7684\u7ed9\u5b9a\u7ebf\u7a0b\u7ec4\u7684\u5b9e\u9645\u7ebf\u7a0b\u7ec4\u5927\u5c0f\u3002[","[dispatch_threads_per_threadgroup]","] \u5c5e\u6027\u662f\u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u5927\u5c0f\u3002"),(0,i.kt)("p",null,"\u6838\u51fd\u6570\u5c5e\u6027\u6ce8\u610f\u4e8b\u9879\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u58f0\u660e [","[thread_position_in_grid]","]\u3001[","[threads_per_grid]","]\u3001[","[thread_position_in_threadgroup]","]\u3001[","[threads_per_threadgroup]","]\u3001[","[threadgroup_position_in_grid]","]\u3001[","[dispatch_threads_per_threadgroup]","] \u548c [","[threadgroups_per_grid]","] \u7684\u7c7b\u578b\u5fc5\u987b\u662f\u6807\u91cf\u7c7b\u578b\u6216\u5411\u91cf\u7c7b\u578b\u3002\u5982\u679c\u5b83\u662f\u5411\u91cf\u7c7b\u578b\uff0c\u5219\u7528\u4e8e\u58f0\u660e\u8fd9\u4e9b\u53c2\u6570\u7684\u5411\u91cf\u7c7b\u578b\u7684\u7ec4\u4ef6\u6570\u91cf\u9700\u8981\u5339\u914d\u3002- \u58f0\u660e [","[thread_position_in_grid]","] \u548c [","[threads_per_grid]","] \u7684\u6570\u636e\u7c7b\u578b\u9700\u8981\u5339\u914d\u3002- \u58f0\u660e [","[thread_position_in_threadgroup]","]\u3001[","[threads_per_threadgroup]","] \u548c [","[dispatch_threads_per_threadgroup]","] \u7684\u6570\u636e\u7c7b\u578b\u9700\u8981\u5339\u914d\u3002- \u5982\u679c [","[thread_position_in_threadgroup]","] \u4e3a uint\u3001uint2 \u6216 uint3 \u7c7b\u578b\uff0c\u5219 [","[thread_index_in_threadgroup]","] \u9700\u8981\u4e3a uint \u7c7b\u578b\u3002- \u7528\u4e8e\u58f0\u660e [","[thread_index_in_simdgroup]","]\u3001[","[threads_per_simdgroup]","]\u3001[","[simdgroup_index_in_threadgroup]","]\u3001[","[simdgroups_per_threadgroup]","]\u3001[","[dispatch_simdgroups_per_threadgroup]","]\u3001[","[quadgroup_index_in_threadgroup]","]\u3001[","[quadgroups_per_threadgroup]","] \u548c [","[\u7684\u7c7b\u578bdispatch_quadgroups_per_threadgroup]","] \u9700\u8981\u4e3a ushort \u6216 uint\u3002\u58f0\u660e\u8fd9\u4e9b\u5185\u7f6e\u53d8\u91cf\u7684\u7c7b\u578b\u9700\u8981\u5339\u914d\u3002- [","[threads_per_simdgroup]","] \u548c [","[thread_execution_width]","] \u662f\u5f15\u7528\u76f8\u540c\u6982\u5ff5\u7684\u5f7c\u6b64\u7684\u522b\u540d\u3002")),(0,i.kt)("h2",{id:"\u8868-58\u5185\u6838\u51fd\u6570\u56fe\u5757\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"},"\u8868 5.8\u3002\u5185\u6838\u51fd\u6570\u56fe\u5757\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"render_target_array_index uchar\u3001ushort \u6216 uint")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\uff0c\u6307\u7684\u662f\u7acb\u65b9\u4f53\u8d34\u56fe\u7684\u9762\uff0c\u6307\u5b9a\u7684\u6570\u636e")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"3D \u7eb9\u7406\u7684\u6df1\u5ea6\u3001\u7eb9\u7406\u6570\u7ec4\u7684\u6570\u7ec4\u5207\u7247\u3001\u6570\u7ec4\u5207\u7247\u6216\u7acb\u65b9\u4f53\u8d34\u56fe\u6570\u7ec4\u7684\u9762\u3002\u5bf9\u4e8e\u7acb\u65b9\u4f53\u8d34\u56fe\uff0c\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\u662f\u9762\u7d22\u5f15\uff0c\u5b83\u662f\u4ece 0 \u5230")," \u7684\u503c"),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},"\u5bf9\u4e8e\u7acb\u65b9\u4f53\u8d34\u56fe\u6570\u7ec4\uff0c\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\u8ba1\u7b97\u5982\u4e0b\uff1a\u6570\u7ec4\u5207\u7247\u7d22\u5f15 ","*"," 6 + \u9762\u7d22\u5f15\u3002")),(0,i.kt)("p",null,"macOS\uff1a\u81ea Metal 2.3 \u8d77\u652f\u6301\u8868 5.9 \u4e2d\u7684\u5c5e\u6027\u3002"),(0,i.kt)("p",null,"iOS\uff1a\u4ece Metal 2 \u5f00\u59cb\u652f\u6301\u8868 5.9 \u4e2d\u7684\u5c5e\u6027\u3002"),(0,i.kt)("h2",{id:"5237-\u4ea4\u96c6\u51fd\u6570\u8f93\u5165\u5c5e\u6027"},"5.2.3.7 \u4ea4\u96c6\u51fd\u6570\u8f93\u5165\u5c5e\u6027"),(0,i.kt)("p",null,"\u8868 5. 10 \u5217\u51fa\u4e86\u53ef\u4ee5\u4e3a\u81ea\u5b9a\u4e49\u4ea4\u96c6\u51fd\u6570\u7684\u53c2\u6570\u6307\u5b9a\u7684\u5185\u7f6e\u5c5e\u6027\uff08\u8bf7\u53c2\u9605\u7b2c 5.1.6 \u8282\uff09\u3002\u5f53\u5728\u4ea4\u96c6\u51fd\u6570\u4e0a\u6307\u5b9a primitive_type \u548c intersection_tags \u7684\u7279\u5b9a\u503c\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u5185\u7f6e\u5c5e\u6027\u3002"),(0,i.kt)("p",null,"\u4f8b\u5982\uff0c\u5982\u679c junction_tags \u5305\u542b\u5b9e\u4f8b\u5316\uff0c\u5219 instance_id \u53ef\u7528\u3002"),(0,i.kt)("p",null,"[","[\u4ea4\u96c6\uff08\u4e09\u89d2\u5f62\uff0c\u4e09\u89d2\u5f62\u6570\u636e\uff0c\u5b9e\u4f8b\u5316\uff0c\u4e16\u754c\u7a7a\u95f4\u6570\u636e\uff09]","]"),(0,i.kt)("p",null,"bool triangleIntersectionFunction(..., uint id [","[instance_id]","], ...) {...}"),(0,i.kt)("p",null,"\u4efb\u4f55\u6b64\u7c7b\u9650\u5236\u90fd\u5217\u5728\u5c5e\u6027\u7684\u63cf\u8ff0\u4e2d\u3002"),(0,i.kt)("h2",{id:"\u8868-59\u4ea4\u96c6\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"},"\u8868 5.9\u3002\u4ea4\u96c6\u51fd\u6570\u8f93\u5165\u53c2\u6570\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u539f\u70b9 float3 \u5c04\u7ebf ^ \u539f\u70b9 ^ \u5728 ^ \u5bf9\u8c61 ^ \u7a7a\u95f4\u4e2d\u3002^")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u65b9\u5411 float3 \u5149\u7ebf^\u65b9\u5411^\u5728^\u5bf9\u8c61^\u7a7a\u95f4\u4e2d\u3002^ ")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,"min_distance float Ray^ min^ \u8ddd\u79bb\u3002^"),(0,i.kt)("p",null,"\u6700\u5927\u8ddd\u79bb\u6d6e\u70b9\u6570"),(0,i.kt)("p",null,"``` \u901a\u8fc7\u5f15\u7528\u4f20\u9012\u3002\u8fd4\u56de\u5f53\u524d\u6700\u8fd1\u7684\u4ea4\u53c9\u70b9\u6700\u5927\u8ddd\u79bb\u3002\u76f8\u4ea4\u5668\u7528\u5c04\u7ebf\u7684\u6700\u5927\u8ddd\u79bb\u521d\u59cb\u5316\u521d\u59cb\u503c\uff0c\u5e76\u4e14\u968f\u7740\u76f8\u4ea4\u5668\u627e\u5230\u76f8\u4ea4\uff0c\u8be5\u503c\u4f1a\u51cf\u5c0f\u3002````"),(0,i.kt)("p",null,"\u6709\u6548\u8d1f\u8f7d\u7528\u6237^\u7c7b\u578b\u3002^\u901a\u8fc7\u5f15\u7528\u4f20\u9012\u3002"),(0,i.kt)("p",null,"``` \u7531\u8c03\u7528\u7ebf\u7a0b\u4f20\u9012\u7684\u7528\u6237\u5b9a\u4e49\u7684\u6709\u6548\u8d1f\u8f7d\u3002\u9700\u8981\u6307\u5b9a\u4ee5\u5141\u8bb8\u901a\u8fc7 intersect() \u5339\u914d\u6709\u6548\u8d1f\u8f7d\u8868\uff08\u7b2c 6.18.2 \u8282\uff09\u3002````"),(0,i.kt)("p",null,"Geometry_id ushort \u6216 uint ^ \u6bcf\u4e2a\u51e0\u4f55^ id\u3002^"),(0,i.kt)("p",null,"Primitive_id ushort \u6216 uint"),(0,i.kt)("p",null,"``` \u6bcf\u4e2a\u57fa\u5143\u6807\u8bc6\u7b26\u3002\u5bf9\u4e8e\u66f2\u7ebf\uff0c\u8fd9\u662f\u66f2\u7ebf\u6bb5\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"instance_id uarrayshort_ref,^ uint^ \u6216 ^"),(0,i.kt)("p",null,"``` \u6bcf\u4e2a\u5b9e\u4f8b\u7684\u6807\u8bc6\u7b26\u3002\u5982\u679c\u4ea4\u96c6","_","\u6807\u7b7e\u5305\u542b\u5b9e\u4f8b\uff0c\u5219\u53ef\u7528\u3002\u4ece Metal 3.1 \u5f00\u59cb\uff0c\u5982\u679c junction_tags \u5305\u542b max_levels\uff0c\u5219\u7c7b\u578b\u5fc5\u987b\u4e3a array_ref\u3002\u5426\u5219\uff0c\u5b83\u662f ushort \u6216 uint\u3002````"),(0,i.kt)("p",null,"\u4e16\u754c\u7a7a\u95f4\u539f\u70b9 float3"),(0,i.kt)("p",null,"``\u539f\u70b9\u5728\u4e16\u754c\u7a7a\u95f4\u3002\u5982\u679c Intersection_tags \u5305\u542b world_space_data\uff0c\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,"\u4e16\u754c\u7a7a\u95f4\u65b9\u5411 float3"),(0,i.kt)("p",null,"`` \u4e16\u754c\u7a7a\u95f4\u4e2d\u7684\u65b9\u5411\u3002\u5982\u679c Intersection_tags \u5305\u542b world_space_data\uff0c\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,"\u91cd\u5fc3\u5750\u6807 float2"),(0,i.kt)("p",null,"`` \u91cd\u5fc3\u5750\u6807\u3002\u5982\u679c primitive_type \u662f\u4e09\u89d2\u5f62\u4e14\u4ea4\u96c6\u6807\u8bb0\u5305\u542b triangle_data\uff0c\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,"front_faceing \u5e03\u5c14\u503c"),(0,i.kt)("p",null,"``` \u5982\u679c\u4e09\u89d2\u5f62\u6b63\u9762\u4ece\u5c04\u7ebf\u539f\u70b9\u53ef\u89c1\uff0c\u5219\u8be5\u503c\u4e3a true\u3002\u5982\u679c\u4ea4\u96c6",(0,i.kt)("em",{parentName:"p"},"\u6807\u7b7e\u5305\u542b\u4e09\u89d2\u5f62"),"\u6570\u636e\uff0c\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,"\u8ddd\u79bb\u6d6e\u52a8"),(0,i.kt)("p",null,"`` \u4e09\u89d2\u5f62\u4ea4\u70b9\u5904\u6cbf\u5149\u7ebf\u7684\u8ddd\u79bb\u3002\u5982\u679c primitive_type \u662f\u4e09\u89d2\u5f62\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,"\u4e0d\u900f\u660e\u5e03\u5c14\u503c"),(0,i.kt)("p",null,"`` \u8fd9\u4e2a\u539f\u8bed\u662f\u5426\u5e94\u88ab\u89c6\u4e3a\u4e0d\u900f\u660e\u3002\u5982\u679c primitive_type \u662f bounding_box\uff0c\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,"\u5b9e\u4f8b",(0,i.kt)("em",{parentName:"p"},"\u4ea4\u96c6")," function_table_offset"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"``` \u4ea4\u96c6\u51fd\u6570\u8868\u4e2d\u7684\u504f\u79fb\u91cf\uff0c\u7528\u4e8e\u9009\u62e9\u4ea4\u96c6\u5b9e\u4f8b\u3002````"),(0,i.kt)("p",null,"\u51e0\u4f55",(0,i.kt)("em",{parentName:"p"},"\u4ea4\u96c6")," function_table_offset"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort \u6216 uint")),(0,i.kt)("p",null,"`` \u7528\u4e8e\u9009\u62e9\u4ea4\u96c6\u5b9e\u4f8b\u7684\u51e0\u4f55\u5bf9\u8c61\u7684\u504f\u79fb\u91cf\u3002````"),(0,i.kt)("p",null,"\u65f6\u95f4 \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2. 4."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6d6e\u52a8")),(0,i.kt)("p",null,"`` \u5149\u7ebf\u76f8\u4ea4\u65f6\u95f4\u3002\u5982\u679c\u4ea4\u96c6","_","\u6807\u7b7e\u5305\u542b primitive_motion\uff0c\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,"motion_start_time \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2. 4."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6d6e\u52a8")),(0,i.kt)("p",null,"`` \u8be5\u51e0\u4f55\u4f53\u7684\u8fd0\u52a8\u5f00\u59cb\u65f6\u95f4\u3002\u5982\u679c\u4ea4\u96c6","_","\u6807\u7b7e\u5305\u542b primitive_motion\uff0c\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,"motion_end_time \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2. 4."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6d6e\u52a8")),(0,i.kt)("p",null,"`` \u8be5\u51e0\u4f55\u4f53\u7684\u8fd0\u52a8\u7ed3\u675f\u65f6\u95f4\u3002\u5982\u679c\u4ea4\u96c6","_","\u6807\u7b7e\u5305\u542b primitive_motion\uff0c\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,"key_frame_count \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2. 4. ushort^ \u6216 ^ uint^"),(0,i.kt)("p",null,"`` \u5173\u952e\u5e27\u7684\u6570\u91cf\u3002\u5982\u679c\u4ea4\u96c6","_","\u6807\u7b7e\u5305\u542b primitive_motion\uff0c\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,"object_to_world_transform \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2. 4."),(0,i.kt)("p",null,"``float4x3````"),(0,i.kt)("p",null,"`` \u5bf9\u8c61\u7a7a\u95f4\u5230\u4e16\u754c\u7a7a\u95f4\u7684\u53d8\u6362\u77e9\u9635\u3002\u5982\u679c Intersection_tags \u5305\u542b\u5b9e\u4f8b\u5316\u548c world_space_data\uff0c\u5219\u53ef\u7528\u3002\u5982\u679c intersection_tags \u5305\u542b instance_motion\uff0c\u5219\u6839\u636e\u65f6\u95f4\u5bf9\u77e9\u9635\u8fdb\u884c\u63d2\u503c\u3002````"),(0,i.kt)("p",null,"world_to_object_transform \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2. 4."),(0,i.kt)("p",null,"``float4x3````"),(0,i.kt)("p",null,"`` \u4e16\u754c\u7a7a\u95f4\u5230\u5bf9\u8c61\u7a7a\u95f4\u7684\u53d8\u6362\u77e9\u9635\u3002\u5982\u679c Intersection_tags \u5305\u542b\u5b9e\u4f8b\u5316\u548c world_space_data\uff0c\u5219\u53ef\u7528\u3002\u5982\u679c intersection_tags \u5305\u542b instance_motion\uff0c\u5219\u6839\u636e\u65f6\u95f4\u5bf9\u77e9\u9635\u8fdb\u884c\u63d2\u503c\u3002````"),(0,i.kt)("p",null,"user_instance_id \u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 2. 4."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001uint \u6216 array_ref")),(0,i.kt)("p",null,"``` \u7528\u6237\u5b9a\u4e49\u7684\u5b9e\u4f8b ID\u3002\u5982\u679c\u4ea4\u96c6","_","\u6807\u7b7e\u5305\u542b\u5b9e\u4f8b\uff0c\u5219\u53ef\u7528\u3002\u4ece Metal 3.1 \u5f00\u59cb\uff0c\u5982\u679c junction_tags \u5305\u542b max_levels\uff0c\u5219\u7c7b\u578b\u5fc5\u987b\u4e3a array_ref\u3002\u5426\u5219\uff0c\u5b83\u662f ushort \u6216 uint\u3002````"),(0,i.kt)("p",null,"Primitive_data \u4ece Metal 3 \u5f00\u59cb\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"const device T* \u6216 const device T&")),(0,i.kt)("p",null,"`` \u6bcf\u4e2a\u539f\u59cb\u6570\u636e\u3002\u6570\u636e\u662f\u53ea\u8bfb\u7684\u5e76\u5728\u8bbe\u5907\u5730\u5740\u7a7a\u95f4\u4e2d\u4f20\u9012\u3002````"),(0,i.kt)("p",null,"curve_parameter \u81ea Metal 3.1 \u8d77"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6d6e\u52a8")),(0,i.kt)("p",null,"`` \u9700\u8981\u4f20\u9012\u7ed9\u66f2\u7ebf\u57fa\u51fd\u6570\u4ee5\u91cd\u5efa\u4e0e\u6cbf\u66f2\u7ebf\u6bb5\u7684\u4ea4\u70b9\u76f8\u5bf9\u5e94\u7684\u4f4d\u7f6e\u7684\u503c\u3002\u5f53\u4e14\u4ec5\u5f53\u5c04\u7ebf\u4e0e\u66f2\u7ebf\u7aef\u76d6\u6216\u5f2f\u5934\u76f8\u4ea4\u65f6\uff0c\u8be5\u503c\u5c06\u6070\u597d\u4e3a 0 .0F \u6216 1 .0F\u3002\u5982\u679c\u4ea4\u96c6",(0,i.kt)("em",{parentName:"p"},"\u6807\u7b7e\u5305\u542b\u66f2\u7ebf"),"\u6570\u636e\uff0c\u5219\u53ef\u7528\u3002\u6709\u5173\u4e00\u7ec4\u66f2\u7ebf\u5b9e\u7528\u51fd\u6570\uff0c\u8bf7\u53c2\u89c1\u7b2c 6.18.6 \u8282\u3002````"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u9876\u70b9\u5c5e\u6027 v0\u3001v1 \u548c v2\uff0c\u6307\u5b9a\u91cd\u5fc3\u70b9\u5904\u7684\u5c5e\u6027\u503c\u4e3a\uff1av1 ",(0,i.kt)("em",{parentName:"p"}," barycentric_coord.x + v2 ")," barycentric_coord.y + v0 ","*"," (1.0f - (barycentric_coord.x + barycentric_coord.y))"),(0,i.kt)("p",null,"\u5177\u6709 [","[payload]","] \u5c5e\u6027\u7684\u53c2\u6570\u7684\u7c7b\u578b\u91c7\u7528 ray_data T & \u5f62\u5f0f\u3002\u5b83\u901a\u8fc7\u5f15\u7528\u4f20\u9012\u7ed9\u4ea4\u96c6\u51fd\u6570\uff0c\u5e76\u5206\u914d\u5728 ray_data \u5730\u5740\u7a7a\u95f4\u4e2d\u3002\u6709\u6548\u8d1f\u8f7d\u7684\u7c7b\u578b T \u53ef\u4ee5\u662f\u6216\u5305\u542b\u4ee5\u4e0b\u7c7b\u578b\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u8bbe\u5907\u6216\u5e38\u91cf\u6307\u9488\u6216\u5f15\u7528 - \u6574\u6570\u7c7b\u578b - \u679a\u4e3e\u7c7b\u578b - \u6d6e\u70b9\u7c7b\u578b - \u5411\u91cf\u7c7b\u578b - \u6b64\u7c7b\u7c7b\u578b\u7684\u6570\u7ec4 - \u7ed3\u6784\u4f53\u548c\u8054\u5408\u4f53\uff08atomic \u548c imageblock \u9664\u5916\uff09\u3002")),(0,i.kt)("h2",{id:"5238-\u4ea4\u96c6\u51fd\u6570\u8f93\u51fa\u5c5e\u6027"},"5.2.3.8 \u4ea4\u96c6\u51fd\u6570\u8f93\u51fa\u5c5e\u6027"),(0,i.kt)("p",null,"\u8868 5. 11 \u5217\u51fa\u4e86\u53ef\u4ee5\u4e3a [","[intersection(primitive_type, junction_tags...)]","] \u51fd\u6570\u7684\u8fd4\u56de\u7c7b\u578b\u6307\u5b9a\u7684\u5185\u7f6e\u5c5e\u6027\uff08\u53ca\u5176\u76f8\u5e94\u7684\u6570\u636e\u7c7b\u578b\uff09\u3002"),(0,i.kt)("h2",{id:"\u8868-510\u4ea4\u96c6\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027"},"\u8868 5.10\u3002\u4ea4\u96c6\u8fd4\u56de\u7c7b\u578b\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,"Accept_intersection bool (^) \u5982\u679c\u4e3a true\uff0c\u5219\u8be5\u539f\u8bed\u5c06\u6210\u4e3a\u4e0b\u4e00\u4e2a\u63d0\u4ea4\u7684\u547d\u4e2d\uff1a\u5982\u679c\u5b83\u662f\u6700\u8fd1\u7684\uff0c\u5219\u5c06\u4ece intersect() \u8fd4\u56de\u3002continue_search bool \u5982\u679c\u63a5\u53d7\u547d\u4e2d ([","[accept_intersection]","] == true)\uff0c\u5219 continue_search \u6307\u793a\u641c\u7d22\u662f\u5426\u5e94\u7ee7\u7eed\u3002\u5982\u679c continue_search \u4e3a true\uff0c\u5219 intersect() \u5c06\u7ee7\u7eed\u641c\u7d22\u66f4\u63a5\u8fd1\u7684\u547d\u4e2d\u3002\u5982\u679c\u4e3a false\uff0c\u5219\u4e0d\u4f1a\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u641c\u7d22\u3002\u5f53\u524d\u6700\u8fd1\u7684\u547d\u4e2d\u7531 intersect() \u8fd4\u56de\u3002\u9ed8\u8ba4\u4e3a true\u3002\u5373\u4f7f\u8fd4\u56de true\uff0c\u5982\u679c accept_any_intersection()\u4e3a true\uff0c\u63d0\u4ea4\u7684\u547d\u4e2d\u4e5f\u4f1a\u7acb\u5373\u505c\u6b62\u641c\u7d22\u3002distance float \u8fd9\u8fd4\u56de\u6cbf\u8fb9\u754c\u6846\u5185\u627e\u5230\u7684\u547d\u4e2d\u5c04\u7ebf\u7684\u8ddd\u79bb\u3002\u5982\u679c\u51fb\u4e2d\u88ab\u62d2\u7edd"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,"``` ([","[accept_intersection]","] == false)\uff0c\u8be5\u8fd4\u56de\u503c\u88ab\u5ffd\u7565\u3002\u5982\u679c primitive_type \u662f bounding_box\uff0c\u5219\u53ef\u7528\u3002````"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u4e09\u89d2\u5f62\u4ea4\u96c6\u51fd\u6570\uff0c[","[accept_intersection]","] \u662f\u552f\u4e00\u9700\u8981\u7684\u8fd4\u56de\u503c\u3002\u5982\u679c\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u4e0d\u5e26\u5c5e\u6027\u7684 bool\uff0c\u5219\u5047\u5b9a\u4e3a [","[accept_intersection]","]\u3002"),(0,i.kt)("p",null,"[","[distance]","] \u7684\u503c\u9700\u8981\u5927\u4e8e\u6216\u7b49\u4e8e [","[min_distance]","] \u7684\u503c\uff0c\u5e76\u4e14\u9700\u8981\u5c0f\u4e8e\u6216\u7b49\u4e8e [","[max_distance]","] \u7684\u503c\uff0c\u5e76\u4e14\u5728\u81ea\u5b9a\u4e49\u56fe\u5143\u7684\u8fb9\u754c\u6846\u5185\uff08\u5305\u62ec\u5728\u5185\uff09\uff0c\u6216\u8005\u7ed3\u679c\u672a\u5b9a\u4e49\u3002\u5982\u679c [","[distance]","] \u7684\u503c\u4e0e [","[max_distance]","] \u7684\u503c\u76f8\u540c\uff0c\u5219\u63a5\u53d7\u6b64\u547d\u4e2d\u4f18\u5148\u4e8e\u76f8\u540c\u8ddd\u79bb\u7684\u524d\u4e00\u4e2a\u547d\u4e2d\u3002"),(0,i.kt)("p",null,"\u65e0\u8bba\u4ea4\u96c6\u51fd\u6570\u5982\u4f55\u8fd4\u56de\uff0c\u5bf9\u5149\u7ebf\u6709\u6548\u8d1f\u8f7d\u6240\u505a\u7684\u4efb\u4f55\u66f4\u6539\u90fd\u4f1a\u751f\u6548\uff1a\u88ab\u62d2\u7edd\u7684\u57fa\u5143\u53ef\u80fd\u4f1a\u5bf9\u5185\u5b58\u4ea7\u751f\u526f\u4f5c\u7528\uff0c\u8fd9\u4e9b\u526f\u4f5c\u7528\u53ef\u4ee5\u7531\u672a\u6765\u7684\u4ea4\u96c6\u7740\u8272\u5668\u7ebf\u7a0b\u89c2\u5bdf\u5230\u3002"),(0,i.kt)("p",null,"\u5373\u4f7f\u5bf9\u4e8e\u88ab\u62d2\u7edd\u7684\u539f\u8bed\uff0c\u4e5f\u4f1a\u5199\u5165\u8bbe\u5907\u5185\u5b58\u3002\u8fd9\u4e9b\u5199\u5165\u901a\u8fc7\u901a\u5e38\u7684\u5185\u5b58\u4e00\u81f4\u6027\u548c\u4e00\u81f4\u6027\u89c4\u5219\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u53ef\u89c1\uff08\u76ee\u524d\uff0c\u53ea\u6709\u539f\u5b50\u662f\u4e00\u81f4\u7684\uff0c\u5e76\u4e14\u4ec5\u652f\u6301\u5bbd\u677e\u7684\u4e00\u81f4\u6027\uff09\u3002\u5373\u4f7f\u5149\u7ebf\u4e0d\u4e0e\u56fe\u5143\u7684\u8fb9\u754c\u6846\u76f8\u4ea4\uff0c\u4e5f \u200b\u200b \u53ef\u4ee5\u8c03\u7528\u76f8\u4ea4\u51fd\u6570\u3002\u4f8b\u5982\uff0c\u5b9e\u73b0\u53ef\u4ee5\u5c06\u591a\u4e2a\u57fa\u5143\u5206\u7ec4\u5230\u4e00\u4e2a\u52a0\u901f\u7ed3\u6784\u53f6\u8282\u70b9\u4e2d\u3002"),(0,i.kt)("p",null,"\u4e0b\u9762\u662f\u8fb9\u754c\u6846\u7684\u4ea4\u96c6\u51fd\u6570\u7684\u793a\u4f8b\u3002"),(0,i.kt)("p",null,"\u7ed3\u6784\u4f53 IntersectionResult {"),(0,i.kt)("p",null,"\u5e03\u5c14\u7ee7\u7eed\u641c\u7d22[","[\u7ee7\u7eed\u641c\u7d22]","];"),(0,i.kt)("p",null,"\u5e03\u5c14\u63a5\u53d7[","[accept_intersection]","];"),(0,i.kt)("p",null,"\u6d6e\u52a8\u8ddd\u79bb[","[\u8ddd\u79bb]","]\uff1b"),(0,i.kt)("p",null,"};"),(0,i.kt)("p",null,"[","[\u4ea4\u53c9\u70b9\uff08\u8fb9\u754c\u6846\uff09]","]"),(0,i.kt)("p",null,"IntersectionResult sphereIntersectionFunction("),(0,i.kt)("p",null,"float3 \u539f\u70b9[","[\u539f\u70b9]","],"),(0,i.kt)("p",null,"float3 \u65b9\u5411[","[\u65b9\u5411]","],"),(0,i.kt)("p",null,"uint primitiveIndex [","[primitive_id]","],"),(0,i.kt)("p",null,"ray_data float2& \u8d44\u6e90 [","[\u6709\u6548\u8d1f\u8f7d]","],"),(0,i.kt)("p",null,"\u6d6e\u52a8\u6700\u5c0f\u8ddd\u79bb[","[\u6700\u5c0f\u8ddd\u79bb]","]\uff0c"),(0,i.kt)("p",null,"\u6d6e\u52a8\u6700\u5927\u8ddd\u79bb [","[\u6700\u5927\u8ddd\u79bb]","])"),(0,i.kt)("p",null,"{...}"),(0,i.kt)("h2",{id:"5239-\u5bf9\u8c61\u51fd\u6570\u8f93\u5165\u5c5e\u6027"},"5.2.3.9 \u5bf9\u8c61\u51fd\u6570\u8f93\u5165\u5c5e\u6027"),(0,i.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 3 \u8d77"),(0,i.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u4ece Metal 3.1 \u5f00\u59cb\uff0c\u5168\u5c40\u53d8\u91cf\u73b0\u5728\u53ef\u4ee5\u6307\u5b9a\u8fd9\u4e9b\u5c5e\u6027\uff0c\u9664\u975e\u5728\u52a8\u6001\u5e93\u6216\u5355\u72ec\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u51fd\u6570\u4e2d\u4f7f\u7528\u3002"),(0,i.kt)("p",null,"\u5bf9\u8c61\u51fd\u6570\u4f7f\u7528\u4e0e\u5185\u6838\u51fd\u6570\u76f8\u540c\u7684\u6267\u884c\u6a21\u578b\uff08\u53c2\u89c1\u7b2c 5.2.3.6 \u8282\uff09\uff0c\u5b83\u5728 N \u7ef4\u7ebf\u7a0b\u7f51\u683c\u4e0a\u6267\u884c\u3002\u5bf9\u8c61\u51fd\u6570\u53c2\u6570\u53ef\u4ee5\u662f\u91c7\u6837\u5668\u3001\u7eb9\u7406\u3001mesh_grid_properties \u7c7b\u578b\u7684\u53c2\u6570\u4ee5\u53ca\u8bbe\u5907\u3001\u5e38\u91cf\u548c\u7ebf\u7a0b\u7ec4\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u7f13\u51b2\u533a\u3002"),(0,i.kt)("p",null,"\u5bf9\u8c61\u51fd\u6570\u652f\u6301\u5185\u6838\u51fd\u6570\u7684\u5185\u7f6e\u5c5e\u6027\u7684\u5b50\u96c6\u4ee5\u53ca [","[amplification_count]","] \u548c [","[payload]","]\u3002[","[amplification_count]","] \u7684\u8bed\u4e49\u4e0e\u7b2c 5.2.3.1 \u8282\u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027\u4e2d\u7684\u76f8\u540c\u3002\u8868 5. 12 \u5217\u51fa\u4e86\u53ef\u4ee5\u4e3a\u5bf9\u8c61\u51fd\u6570\u7684\u53c2\u6570\u6307\u5b9a\u7684\u5185\u7f6e\u5c5e\u6027\u4ee5\u53ca\u53ef\u4ee5\u4f7f\u7528\u5b83\u4eec\u7684\u76f8\u5e94\u6570\u636e\u7c7b\u578b\u3002\u4ece Metal 3.1 \u5f00\u59cb\uff0c\u8868 5. 12 \u4e2d\u7684\u5185\u7f6e\u5c5e\u6027\u53ef\u4ee5\u5728\u7a0b\u5e8f\u8303\u56f4\u53d8\u91cf\u4e0a\u6307\u5b9a\uff0c\u4f46 amplification_count \u548c payload \u9664\u5916\u3002"),(0,i.kt)("h2",{id:"\u8868-511\u5bf9\u8c61\u51fd\u6570\u7684\u5c5e\u6027"},"\u8868 5.11\u3002\u5bf9\u8c61\u51fd\u6570\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u653e\u5927\u8ba1\u6570")),(0,i.kt)("p",null,"ushort \u6216 uint (^) \u4e3a\u6bcf\u4e2a\u9876\u70b9\u5b9e\u4f8b\u751f\u6210\u7684\u8f93\u51fa\u9876\u70b9\u6570\u3002dispatch_quadgroups_per_thr eadgroup ushort \u6216 uint \u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u7684\u56db\u7ec4\u6267\u884c\u5bbd\u5ea6\u3002dispatch_simdgroups_per_thr eadgroup ushort \u6216 uint \u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u7684 SIMD \u7ec4\u6267\u884c\u5bbd\u5ea6\u3002dispatch_threads_per_thread group ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3 \u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u7ec4\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002\u6709\u6548\u8d1f\u8f7d object_data \u5730\u5740\u7a7a\u95f4\u4e2d\u5bf9\u7528\u6237\u5b9a\u4e49 T \u7684\u6307\u9488\u6216\u5de6\u503c\u5f15\u7528 \u6709\u6548\u8d1f\u8f7d\u662f\u4ece\u5bf9\u8c61\u7740\u8272\u5668\u4f20\u9012\u5230\u7f51\u683c\u7740\u8272\u5668\u7684\u6570\u636e\u3002\u5bf9\u4e8e\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\uff0c\u6709\u6548\u8d1f\u8f7d\u6307\u9488\u6216\u5f15\u7528\u90fd\u662f\u76f8\u540c\u7684\u3002\u5047\u5b9a\u6709\u6548\u8d1f\u8f7d\u5b58\u50a8\u5668\u5728\u5bf9\u8c61\u51fd\u6570\u7684\u5165\u53e3\u5904\u672a\u521d\u59cb\u5316\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,"quadgroup_index_in_threadgr oup ushort \u6216 uint"),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u5185\u56db\u5143\u7ec4\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"quadgroups_per_threadgroup ushort \u6216 uint"),(0,i.kt)("p",null,"`` \u7ebf\u7a0b\u7ec4\u7684\u56db\u7ec4\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"simdgroup_index_in_threadgr oup ushort \u6216 uint"),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u5185 SIMD \u7ec4\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"simdgroups_per_threadgroup ushort \u6216 uint"),(0,i.kt)("p",null,"`` \u7ebf\u7a0b\u7ec4\u7684 SIMD \u7ec4\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"thread_index_in_quadgroup ushort \u6216 uint"),(0,i.kt)("p",null,"``` \u56db\u5143\u7ec4\u4e2d\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"thread_index_in_simdgroup ushort \u6216 uint"),(0,i.kt)("p",null,"``` SIMD \u7ec4\u5185\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"thread_index_in_threadgroup ushort \u6216 uint \u7ebf\u7a0b\u7ec4\u5185\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002"),(0,i.kt)("p",null,"\u7f51\u683c\u4e2d\u7684\u7ebf\u7a0b\u4f4d\u7f6e"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u5728 N \u7ef4\u7ebf\u7a0b\u7f51\u683c\u4e2d\u7684\u4f4d\u7f6e\u3002````"),(0,i.kt)("p",null,"\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u7ebf\u7a0b\u4f4d\u7f6e"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u7ebf\u7a0b\u5728\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u552f\u4e00\u4f4d\u7f6e")),(0,i.kt)("p",null,"\u7f51\u683c\u4e2d\u7684\u7ebf\u7a0b\u7ec4\u4f4d\u7f6e"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u5728\u7f51\u683c\u4e2d\u7684\u72ec\u7279\u4f4d\u7f6e\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6bcf\u4e2a\u7f51\u683c\u7684\u7ebf\u7a0b\u7ec4")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7f51\u683c\u4e2d\u7ebf\u7a0b\u7ec4\u7684\u6570\u91cf\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6bcf\u4e2a\u7f51\u683c\u7684\u7ebf\u7a0b\u6570")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"`` \u7f51\u683c\u5927\u5c0f\u3002````"),(0,i.kt)("p",null,"```threads_per_simdgroup ushort \u6216 uint SIMD \u7ec4\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6bcf\u4e2a\u7ebf\u7a0b\u7ec4\u7684\u7ebf\u7a0b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"\u5bf9\u8c61\u51fd\u6570\u5c5e\u6027\u4e0e\u5185\u6838\u51fd\u6570\u5c5e\u6027\u5177\u6709\u76f8\u540c\u7684\u9650\u5236\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u58f0\u660e [","[thread_position_in_grid]","]\u3001[","[threads_per_grid]","]\u3001[","[thread_position_in_threadgroup]","]\u3001[","[threads_per_threadgroup]","]\u3001[","[threadgroup_position_in_grid]","]\u3001[","[dispatch_threads_per_threadgroup]","] \u548c [","[threadgroups_per_grid]","] \u7684\u7c7b\u578b\u5fc5\u987b\u662f\u6807\u91cf\u7c7b\u578b\u6216\u5411\u91cf\u7c7b\u578b\u3002\u5982\u679c\u5b83\u662f\u5411\u91cf\u7c7b\u578b\uff0c\u5219\u7528\u4e8e\u58f0\u660e\u8fd9\u4e9b\u53c2\u6570\u7684\u5411\u91cf\u7c7b\u578b\u7684\u7ec4\u4ef6\u6570\u91cf\u9700\u8981\u5339\u914d\u3002- \u58f0\u660e [","[thread_position_in_grid]","] \u548c [","[threads_per_grid]","] \u7684\u6570\u636e\u7c7b\u578b\u9700\u8981\u5339\u914d\u3002- \u58f0\u660e [","[thread_position_in_threadgroup]","]\u3001[","[threads_per_threadgroup]","] \u548c [","[dispatch_threads_per_threadgroup]","] \u7684\u6570\u636e\u7c7b\u578b\u9700\u8981\u5339\u914d\u3002- \u5982\u679c [","[thread_position_in_threadgroup]","] \u4e3a uint\u3001uint2 \u6216 uint3 \u7c7b\u578b\uff0c\u5219 [","[thread_index_in_threadgroup]","] \u9700\u8981\u4e3a uint \u7c7b\u578b\u3002- \u7528\u4e8e\u58f0\u660e [","[thread_index_in_simdgroup]","]\u3001[","[threads_per_simdgroup]","]\u3001[","[simdgroup_index_in_threadgroup]","]\u3001[","[simdgroups_per_threadgroup]","]\u3001[","[dispatch_simdgroups_per_threadgroup]","]\u3001[","[quadgroup_index_in_threadgroup]","]\u3001[","[quadgroups_per_threadgroup]","] \u548c [","[\u7684\u7c7b\u578bdispatch_quadgroups_per_threadgroup]","]\u9700\u8981\u4e3a ushort \u6216 uint\u3002\u58f0\u660e\u8fd9\u4e9b\u5185\u7f6e\u53d8\u91cf\u7684\u7c7b\u578b\u9700\u8981\u5339\u914d\u3002")),(0,i.kt)("h2",{id:"52310-\u7f51\u683c\u51fd\u6570\u8f93\u5165\u5c5e\u6027"},"5.2.3.10 \u7f51\u683c\u51fd\u6570\u8f93\u5165\u5c5e\u6027"),(0,i.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u81ea Metal 3 \u8d77"),(0,i.kt)("p",null,"\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\uff1a\u4ece Metal 3.1 \u5f00\u59cb\uff0c\u5168\u5c40\u53d8\u91cf\u73b0\u5728\u53ef\u4ee5\u6307\u5b9a\u8fd9\u4e9b\u5c5e\u6027\uff0c\u9664\u975e\u5b83\u4eec\u5728\u52a8\u6001\u5e93\u6216\u5355\u72ec\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u51fd\u6570\u4e2d\u4f7f\u7528\u3002"),(0,i.kt)("p",null,"\u7f51\u683c\u51fd\u6570\u4f7f\u7528\u4e0e\u5185\u6838\u51fd\u6570\u76f8\u540c\u7684\u6267\u884c\u6a21\u578b\uff08\u8bf7\u53c2\u9605\u7b2c 5.2.3.6 \u8282\uff09\uff0c\u5b83\u5728 N \u7ef4\u7ebf\u7a0b\u7f51\u683c\u4e0a\u6267\u884c\u3002\u7f51\u683c\u51fd\u6570\u53c2\u6570\u53ef\u4ee5\u6765\u81ea\u91c7\u6837\u5668\u3001\u7eb9\u7406\u3001mesh \u7c7b\u578b\u7684\u53c2\u6570\u4ee5\u53ca\u8bbe\u5907\u548c\u5e38\u91cf\u7684\u7f13\u51b2\u533a\u3002\u5982\u679c\u7f51\u683c\u51fd\u6570\u5177\u6709 mesh \u53c2\u6570\uff0c\u5219\u5b83\u6307\u5411\u8868\u793a\u8981\u5bfc\u51fa\u7684\u7f51\u683c\u7684\u5185\u5b58\u7684\u4e0d\u900f\u660e\u53e5\u67c4\u3002\u7531 mesh \u53c2\u6570\u5f15\u7528\u7684\u5e95\u5c42\u5185\u5b58\u5728\u7ed9\u5b9a\u7ebf\u7a0b\u7ec4\u7684\u7ebf\u7a0b\u4e4b\u95f4\u5171\u4eab\u3002"),(0,i.kt)("p",null,"\u7f51\u683c\u51fd\u6570\u652f\u6301\u5185\u6838\u51fd\u6570\u5185\u7f6e\u5c5e\u6027\u7684\u5b50\u96c6\u4ee5\u53ca [","[amplification_count]","]\u3001[","[amplification_id]","] \u548c [","[payload]","] \u5c5e\u6027\u3002[","[amplification_count]","] \u548c [","[amplification_id]","] \u7684\u8bed\u4e49\u4e0e\u7b2c 5.2.3.1 \u8282\u9876\u70b9\u51fd\u6570\u8f93\u5165\u5c5e\u6027\u4e2d\u7684\u76f8\u540c\u3002\u8868 5. 13 \u5217\u51fa\u4e86\u53ef\u4ee5\u4e3a\u7f51\u683c\u51fd\u6570\u7684\u53c2\u6570\u6307\u5b9a\u7684\u5185\u7f6e\u5c5e\u6027\u4ee5\u53ca\u53ef\u4ee5\u4f7f\u7528\u5b83\u4eec\u7684\u76f8\u5e94\u6570\u636e\u7c7b\u578b\u3002\u4ece Metal 3.1 \u5f00\u59cb\uff0c\u8868 5. 13 \u4e2d\u7684\u5185\u7f6e\u5c5e\u6027\u53ef\u4ee5\u5728\u7a0b\u5e8f\u8303\u56f4\u53d8\u91cf\u4e0a\u6307\u5b9a\uff0c\u4f46 amplification_count\u3001amplification_id \u548c Payload \u9664\u5916\u3002"),(0,i.kt)("h2",{id:"\u8868-512\u7f51\u683c\u51fd\u6570\u7684\u5c5e\u6027"},"\u8868 5.12\u3002\u7f51\u683c\u51fd\u6570\u7684\u5c5e\u6027"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5c5e\u6027\u5bf9\u5e94^\u6570\u636e\u7c7b\u578b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u63cf\u8ff0")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u653e\u5927\u8ba1\u6570")),(0,i.kt)("p",null,"ushort \u6216 uint (^) \u4e3a\u6bcf\u4e2a\u56fe\u5143\u5b9e\u4f8b\u751f\u6210\u7684\u8f93\u51fa\u9876\u70b9\u6570\u3002amplification_id ushort \u6216 uint (^) \u89c6\u53e3\u548c\u6e32\u67d3\u76ee\u6807\u6570\u7ec4\u7d22\u5f15\u7684\u6570\u7ec4\u7d22\u5f15\u504f\u79fb\u6620\u5c04\uff0c\u5b83\u5141\u8bb8\u5c06\u653e\u5927\u7684\u9876\u70b9\u8def\u7531\u5230\u4e0d\u540c\u7684\u89c6\u53e3\u548c\u6e32\u67d3\u76ee\u6807\u3002dispatch_quadgroups_per_th readgroup ushort \u6216 uint \u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u7684\u56db\u7ec4\u6267\u884c\u5bbd\u5ea6\u3002dispatch_simdgroups_per_th readgroup ushort \u6216 uint \u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u7684 SIMD \u7ec4\u6267\u884c\u5bbd\u5ea6\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,"dispatch_threads_per_thread dgroup"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u8c03\u5ea6\u65f6\u6307\u5b9a\u7684\u7ebf\u7a0b\u7ec4\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"\u6709\u6548\u8f7d\u8377"),(0,i.kt)("p",null,"``` \u5bf9 object_data \u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u7528\u6237\u5b9a\u4e49 T \u7684\u6307\u9488\u6216\u5de6\u503c\u5f15\u7528\u3002\u9700\u8981 const \u9650\u5b9a\u3002````"),(0,i.kt)("p",null,"``` \u6709\u6548\u8d1f\u8f7d\u662f\u4ece\u5bf9\u8c61\u7740\u8272\u5668\u4f20\u9012\u5230\u7f51\u683c\u7740\u8272\u5668\u7684\u6570\u636e\u3002\u5bf9\u4e8e\u7f51\u683c\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u6765\u8bf4\uff0c\u6709\u6548\u8d1f\u8f7d\u6307\u9488\u6216\u5f15\u7528\u662f\u76f8\u540c\u7684\u3002\u6709\u6548\u8d1f\u8f7d\u5b58\u50a8\u5668\u5728\u7f51\u683c\u51fd\u6570\u4e2d\u662f\u53ea\u8bfb\u7684\u3002````"),(0,i.kt)("p",null,"quadgroup_index_in_threadg \u7ec4 ushort \u6216 uint"),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u5185\u56db\u5143\u7ec4\u7684\u6807\u91cf\u7d22\u5f15\u3002````"),(0,i.kt)("p",null,"\u6bcf\u4e2a\u7ebf\u7a0b\u7ec4\u7684\u56db\u7ec4\u6570"),(0,i.kt)("p",null,"(^) ushort \u6216 uint \u7ebf\u7a0b\u7ec4\u7684\u56db\u7ec4\u6267\u884c\u5bbd\u5ea6\u3002simdgroup_index_in_threadg roup ushort \u6216 uint \u7ebf\u7a0b\u7ec4\u5185 SIMD \u7ec4\u7684\u6807\u91cf\u7d22\u5f15\u3002simdgroups_per_threadgroup (^) ushort \u6216 uint \u7ebf\u7a0b\u7ec4\u7684 SIMD \u7ec4\u6267\u884c\u5bbd\u5ea6\u3002thread_index_in_quadgroup ushort \u6216 uint \u56db\u5143\u7ec4\u5185\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002thread_index_in_simdgroup ushort \u6216 uint SIMD \u7ec4\u5185\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002thread_index_in_threadgroup ushort \u6216 uint \u7ebf\u7a0b\u7ec4\u5185\u7ebf\u7a0b\u7684\u6807\u91cf\u7d22\u5f15\u3002thread_position_in_grid ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3 \u7ebf\u7a0b\u5728 N \u7ef4\u7ebf\u7a0b\u7f51\u683c\u4e2d\u7684\u4f4d\u7f6e\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"}," \u5c5e\u6027")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8bf4\u660e^")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"thread_position_in_threadg \u7ec4")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u7ebf\u7a0b\u5728\u7ebf\u7a0b\u7ec4\u4e2d\u7684\u552f\u4e00\u4f4d\u7f6e")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"threadgroup_position_in_gr id")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u5728\u7f51\u683c\u4e2d\u7684\u72ec\u7279\u4f4d\u7f6e\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6bcf\u4e2a\u7f51\u683c\u7684\u7ebf\u7a0b\u7ec4")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7f51\u683c\u4e2d\u7ebf\u7a0b\u7ec4\u7684\u6570\u91cf\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6bcf\u4e2a\u7f51\u683c\u7684\u7ebf\u7a0b\u6570")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"`` \u7f51\u683c\u5927\u5c0f\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"threads_per_simdgroup ushort^ \u6216 ^ uint^ ")),(0,i.kt)("p",null,"`` SIMD \u7ec4\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u6bcf\u4e2a\u7ebf\u7a0b\u7ec4\u7684\u7ebf\u7a0b")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ushort\u3001ushort2\u3001ushort3\u3001uint\u3001uint2 \u6216 uint3")),(0,i.kt)("p",null,"``` \u7ebf\u7a0b\u7ec4\u7684\u7ebf\u7a0b\u6267\u884c\u5bbd\u5ea6\u3002````"),(0,i.kt)("p",null,"\u7f51\u683c\u51fd\u6570\u5c5e\u6027\u4e0e\u6838\u51fd\u6570\u5c5e\u6027\u5177\u6709\u76f8\u540c\u7684\u9650\u5236\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u58f0\u660e [","[thread_position_in_grid]","]\u3001[","[threads_per_grid]","]\u3001[","[thread_position_in_threadgroup]","]\u3001[","[threads_per_threadgroup]","]\u3001[","[threadgroup_position_in_grid]","]\u3001[","[dispatch_threads_per_threadgroup]","] \u548c [","[threadgroups_per_grid]","] \u7684\u7c7b\u578b\u5fc5\u987b\u662f\u6807\u91cf\u7c7b\u578b\u6216\u5411\u91cf\u7c7b\u578b\u3002\u5982\u679c\u5b83\u662f\u5411\u91cf\u7c7b\u578b\uff0c\u5219\u7528\u4e8e\u58f0\u660e\u8fd9\u4e9b\u53c2\u6570\u7684\u5411\u91cf\u7c7b\u578b\u7684\u7ec4\u4ef6\u6570\u91cf\u9700\u8981\u5339\u914d\u3002- \u58f0\u660e [","[thread_position_in_grid]","] \u548c [","[threads_per_grid]","] \u7684\u6570\u636e\u7c7b\u578b\u9700\u8981\u5339\u914d\u3002- \u58f0\u660e [","[thread_position_in_threadgroup]","]\u3001[","[threads_per_threadgroup]","] \u548c [","[dispatch_threads_per_threadgroup]","] \u7684\u6570\u636e\u7c7b\u578b\u9700\u8981\u5339\u914d\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5982\u679c [","[thread_position_in_threadgroup]","] \u4e3a uint\u3001uint2 \u6216 uint3 \u7c7b\u578b\uff0c\u5219 [","[thread_index_in_threadgroup]","] \u9700\u8981\u4e3a uint \u7c7b\u578b\u3002- \u7528\u4e8e\u58f0\u660e [","[thread_index_in_simdgroup]","]\u3001[","[threads_per_simdgroup]","]\u3001[","[simdgroup_index_in_threadgroup]","]\u3001[","[simdgroups_per_threadgroup]","]\u3001[","[dispatch_simdgroups_per_threadgroup]","]\u3001[","[quadgroup_index_in_threadgroup]","]\u3001[","[quadgroups_per_threadgroup]","] \u548c [","[\u7684\u7c7b\u578bdispatch_quadgroups_per_threadgroup]","]\u9700\u8981\u4e3a ushort \u6216 uint\u3002\u58f0\u660e\u8fd9\u4e9b\u5185\u7f6e\u53d8\u91cf\u7684\u7c7b\u578b\u9700\u8981\u5339\u914d\u3002"))),(0,i.kt)("h2",{id:"524-\u8f93\u5165\u7ec4\u4ef6\u5c5e\u6027"},"5.2.4 \u8f93\u5165\u7ec4\u4ef6\u5c5e\u6027"),(0,i.kt)("p",null,"\u9876\u70b9\u51fd\u6570\u8f93\u51fa\u548c\u5149\u6805\u5316\u5668\u751f\u6210\u7684\u7247\u6bb5\u6210\u4e3a\u7247\u6bb5\u51fd\u6570\u7684\u6bcf\u4e2a\u7247\u6bb5\u8f93\u5165\u3002[","[stage_in]","] \u5c5e\u6027\u53ef\u4ee5\u7ec4\u5408\u6bcf\u4e2a\u7247\u6bb5\u7684\u8f93\u5165\u3002"),(0,i.kt)("p",null,"\u9876\u70b9\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u9876\u70b9\u548c\u5b9e\u4f8b ID \u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u9876\u70b9\u51fd\u6570\u7684\u7f13\u51b2\u533a\u8fdb\u884c\u7d22\u5f15\u6765\u8bfb\u53d6\u6bcf\u4e2a\u9876\u70b9\u7684\u8f93\u5165\u3002\u8981\u7ec4\u88c5\u6bcf\u4e2a\u9876\u70b9\u7684\u8f93\u5165\u5e76\u5c06\u5b83\u4eec\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u9876\u70b9\u51fd\u6570\uff0c\u8bf7\u4f7f\u7528 [","[stage_in]","] \u5c5e\u6027\u58f0\u660e\u8f93\u5165\u3002"),(0,i.kt)("p",null,"\u5185\u6838\u51fd\u6570\u901a\u8fc7\u4f7f\u7528\u7f51\u683c\u4e2d\u7684\u7ebf\u7a0b\u4f4d\u7f6e\u6216\u7ebf\u7a0b\u7ec4 ID \u4e2d\u7684\u7ebf\u7a0b\u4f4d\u7f6e\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u5185\u6838\u51fd\u6570\u7684\u7f13\u51b2\u533a\u6216\u7eb9\u7406\u8fdb\u884c\u7d22\u5f15\u6765\u8bfb\u53d6\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u8f93\u5165\u3002\u6b64\u5916\uff0c\u8981\u5c06\u6bcf\u4e2a\u7ebf\u7a0b\u8f93\u5165\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u5185\u6838\u51fd\u6570\uff0c\u8bf7\u4f7f\u7528 [","[stage_in]","] \u5c5e\u6027\u58f0\u660e\u8f93\u5165\u3002"),(0,i.kt)("p",null,"\u4f60\u53ea\u80fd\u4f7f\u7528 [","[stage_in]","] \u5c5e\u6027\u58f0\u660e\u9876\u70b9\u3001\u7247\u6bb5\u6216\u6838\u51fd\u6570\u7684\u4e00\u4e2a\u53c2\u6570\u3002\u5bf9\u4e8e\u4f7f\u7528 [","[stage_in]","] \u5c5e\u6027\u58f0\u660e\u7684\u7528\u6237\u5b9a\u4e49\u7ed3\u6784\uff0c\u8be5\u7ed3\u6784\u7684\u6210\u5458\u53ef\u4ee5\u662f\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u6807\u91cf\u6574\u6570\u6216\u6d6e\u70b9\u503c\u3002- \u6574\u6570\u6216\u6d6e\u70b9\u503c\u5411\u91cf\u3002- \u7247\u6bb5\u51fd\u6570\u8f93\u5165\u7684\u63d2\u503c \u503c\u3002")),(0,i.kt)("p",null,"\u4e0d\u80fd\u4f7f\u7528 stage_in \u5c5e\u6027\u6765\u58f0\u660e\u538b\u7f29\u5411\u91cf\u3001\u77e9\u9635\u3001\u7ed3\u6784\u3001\u4f4d\u57df\u3001\u7c7b\u578b\u5f15\u7528\u6216\u6307\u9488\u3001\u6807\u91cf\u3001\u5411\u91cf\u6216\u77e9\u9635\u6570\u7ec4\u7684\u7ed3\u6784\u6210\u5458\u3002"),(0,i.kt)("h2",{id:"5241-\u9876\u70b9\u51fd\u6570\u8f93\u51fa\u793a\u4f8b"},"5.2.4.1 \u9876\u70b9\u51fd\u6570\u8f93\u51fa\u793a\u4f8b"),(0,i.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u663e\u793a\u5982\u4f55\u4f7f\u7528 stage_in \u5c5e\u6027\u4f20\u9012\u6bcf\u4e2a\u9876\u70b9\u7684\u8f93\u5165\uff1a"),(0,i.kt)("p",null,"struct VertexOutput { float4 \u4f4d\u7f6e [","[\u4f4d\u7f6e]","];\u6d6e\u52a8 4 \u989c\u8272\uff1b float2 \u7eb9\u7406\u5750\u6807\uff1b };"),(0,i.kt)("p",null,"struct VertexInput { float4 \u4f4d\u7f6e [","[attribute(0)]","]; float3 \u6b63\u5e38 [","[\u5c5e\u6027(1)]","]; half4 \u989c\u8272 [","[\u5c5e\u6027(2)]","];"),(0,i.kt)("p",null,"half2 texcoord [","[\u5c5e\u6027(3)]","]; };"),(0,i.kt)("p",null,"constexpr \u5e38\u91cf uint MAX_LIGHTS = 4\uff1b"),(0,i.kt)("p",null,"struct LightDesc { uint num_lights; float4 light_position","[MAX_LIGHTS]","; float4 light_color","[MAX_LIGHTS]","; float4 light_attenuation_factors","[MAX_LIGHTS]","; };"),(0,i.kt)("p",null,"constexpr \u91c7\u6837\u5668 s = \u91c7\u6837\u5668(\u5750\u6807::\u5f52\u4e00\u5316, \u5730\u5740::clamp_to_zero, \u8fc7\u6ee4\u5668::\u7ebf\u6027);"),(0,i.kt)("p",null,"\u9876\u70b9 VertexOutput render_vertex(VertexInput v_in [","[stage_in]","], \u5e38\u91cf float4x4& mvp_matrix [","[buffer(1)]","], \u5e38\u91cf LightDesc& \u706f\u5149 [","[buffer(2)]","], uint v_id [","[vertex_id]","]) { VertexOutput v_out; } v_out.position = v_in.position ","*"," mvp_matrix; v_out.color = do_lighting(v_in.position, v_in.normal, \u706f);"),(0,i.kt)("p",null,"\u8fd4\u56de v_out\uff1b }"),(0,i.kt)("h2",{id:"5242-\u7247\u6bb5\u51fd\u6570\u8f93\u5165\u793a\u4f8b"},"5.2.4.2 \u7247\u6bb5\u51fd\u6570\u8f93\u5165\u793a\u4f8b"),(0,i.kt)("p",null,"5.2.3.3 \u8282\u4e2d\u7684\u793a\u4f8b\u4e4b\u524d\u4ecb\u7ecd\u4e86 process_vertex \u9876\u70b9\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u4e3a\u6bcf\u4e2a\u9876\u70b9\u8fd4\u56de\u4e00\u4e2a VertexOutput \u7ed3\u6784\u3002\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0cprocess_vertex \u7684\u8f93\u51fa\u7ecf\u8fc7\u7ba1\u9053\u5316\uff0c\u6210\u4e3a\u540d\u4e3a render_pixel \u7684\u7247\u6bb5\u51fd\u6570\u7684\u8f93\u5165\uff0c\u56e0\u6b64\u7247\u6bb5\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f7f\u7528 [","[stage_in]","] \u5c5e\u6027\u5e76\u4f7f\u7528\u4f20\u5165\u7684 VertexOutput \u7c7b\u578b\u3002\uff08\u5728 render_pixel \u4e2d\uff0cimgA \u548c imgB 2D \u7eb9\u7406\u8c03\u7528\u5185\u7f6e\u51fd\u6570 sample\uff0c\u8be5\u51fd\u6570\u5728 6.12.3 \u8282\u4e2d\u4ecb\u7ecd\uff09\u3002"),(0,i.kt)("p",null,"struct VertexOutput 2 { float4 \u4f4d\u7f6e [","[\u4f4d\u7f6e]","];\u6d6e\u52a8 4 \u989c\u8272\uff1b float2 \u7eb9\u7406\u5750\u6807\uff1b };"),(0,i.kt)("p",null,"struct VertexInputData { float4 \u4f4d\u7f6e; float3 \u6b63\u5e38\uff1b float2 \u7eb9\u7406\u5750\u6807\uff1b };"),(0,i.kt)("p",null,"constexpr \u5e38\u91cf uint MAX_LIGHTS = 4\uff1b"),(0,i.kt)("p",null,"struct LightDesc { uint num_lights; float4 light_position","[MAX_LIGHTS]","; float4 light_color","[MAX_LIGHTS]","; float4 light_attenuation_factors","[MAX_LIGHTS]","; };"),(0,i.kt)("p",null,"constexpr \u91c7\u6837\u5668 s = \u91c7\u6837\u5668(\u5750\u6807::\u5f52\u4e00\u5316, \u5730\u5740::clamp_to_edge, \u8fc7\u6ee4\u5668::\u7ebf\u6027);"),(0,i.kt)("p",null,"\u9876\u70b9 VertexOutput 2 render",(0,i.kt)("em",{parentName:"p"},"vertex(const device VertexInputData ","_","v_in [","[buffer(0)]","], \u5e38\u91cf float4x4& mvp_matrix [","[buffer(1)]","], \u5e38\u91cf LightDesc& \u706f\u5149 [","[buffer(2)]","], uint v_id [","[vertex_id]","]) { \u9876\u70b9\u8f93\u51fa v_out; v_out.position = v_in","[v_id]",".position ")," mvp_matrix; v_out.color = do_lighting(v_in","[v_id]",".position, v_in","[v_id]",".normal, \u706f); v_out.texcoord = v_in","[v_id]",".texcoord;\u8fd4\u56de v_out\uff1b }"),(0,i.kt)("p",null,"\u7247\u6bb5 float4 render_pixel(VertexOutput 2 input [","[stage_in]","],texture2d imgA [","[texture(0)]","],texture2d imgB [","[texture(1)]","]) { float4 tex_clr0 = imgA.sample(s , \u8f93\u5165.texcoord); float4 tex_clr1 = imgB.sample(s, input.texcoord);"),(0,i.kt)("p",null,"// \u8ba1\u7b97\u989c\u8272\u3002float4 clr =compute_color(tex_clr0, tex_clr1, ...);\u8fd4\u56de clr\uff1b }"),(0,i.kt)("h2",{id:"5243-\u5185\u6838\u51fd\u6570\u6bcf\u7ebf\u7a0b\u8f93\u5165\u793a\u4f8b"},"5.2.4.3 \u5185\u6838\u51fd\u6570\u6bcf\u7ebf\u7a0b\u8f93\u5165\u793a\u4f8b"),(0,i.kt)("p",null,"\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u5982\u4f55\u4f7f\u7528 stage_in \u5c5e\u6027\u4f20\u9012\u6bcf\u7ebf\u7a0b\u8f93\u5165\u3002\u5185\u6838\u51fd\u6570\u4e2d\u7684 stage_in \u5c5e\u6027\u5141\u8bb8\u4f60\u5c06\u7528\u4e8e\u58f0\u660e\u51fd\u6570\u4e2d\u6bcf\u7ebf\u7a0b\u8f93\u5165\u7684\u6570\u636e\u7c7b\u578b\u4e0e\u7528\u4e8e\u5b58\u50a8\u6bcf\u7ebf\u7a0b\u8f93\u5165\u7684\u5b9e\u9645\u6570\u636e\u7c7b\u578b\u89e3\u8026\u3002"),(0,i.kt)("p",null,"\u7ed3\u6784\u6bcf\u4e2a\u7ebf\u7a0b\u8f93\u5165{"),(0,i.kt)("p",null,"float4 a [","[\u5c5e\u6027(0)]","]; float3 b [","[\u5c5e\u6027(1)]","]; half4 c [","[\u5c5e\u6027(2)]","]; half2 d [","[\u5c5e\u6027(3)]","]; };"),(0,i.kt)("p",null,"\u5185\u6838\u65e0\u6548 my_kernel(PerThreadInput thread_input [","[stage_in]","],"),(0,i.kt)("p",null,"uint t_id [","[thread_position_in_grid]","]) {...}"))}c.isMDXComponent=!0}}]);